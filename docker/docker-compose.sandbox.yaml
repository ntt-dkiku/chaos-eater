version: '3.8'

services:
  chaos-eater:
    build:
      context: ../
      dockerfile: docker/Dockerfile_sandbox
    image: chaos-eater/kind-in-dind-sandbox:0.1
    container_name: chaos-eater-sandbox
    network_mode: bridge
    privileged: true
    volumes:
      - ..:/app
    ports:
      - "${CHAOSEATER_GUI_PORT}:${CHAOSEATER_GUI_PORT}"
      - "${CHAOSEATER_API_PORT}:${CHAOSEATER_API_PORT}"
      - "${CHAOSMESH_GUI_PORT}:${CHAOSMESH_GUI_PORT}"
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
      - GOOGLE_API_KEY=${GOOGLE_API_KEY}
      - OLLAMA_BASE=http://172.17.0.1:11434
    stdin_open: true
    tty: true