[
    {
        "name": "steady_state_draft",
        "token_usage": {
            "input_tokens": 11758,
            "output_tokens": 139,
            "total_tokens": 11897
        },
        "message_history": [
            [
                "System: You are a helpful AI assistant for Chaos Engineering.\nGiven K8s manifests for a system and user's instructions, you will define the system's steady states (i.e., normal behaviors) that are related to potential issues of the system.\nAlways keep the following rules:\n- Define steady states one by one, starting with the steady state related to the K8s resource that is easiest to encounter issues when certain failures occur.\n- Consider whether a new steady state needs to be added, and if so, add a steady state. If not, indicate the end of the steady-state addition with 'exits=True'.\n- Prioritize adding a steady state related to the issue that is easiest to occur to verify through Chaos Engineering whether it's truly a problem later.\n- An added steady state must be a measurable output, such as the number of pods, throughput, error rates, latency percentiles, etc.\n- An added steady state must be specific to a SINGLE K8s resource (i.e., manifest) having potential issues for resilency and redundancy.\n- An added steady state must be different from the already defined ones.\n- The output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"thought\": {\"title\": \"Thought\", \"description\": \"Describe your thought process of determing the steady state of a SINGLE K8s resource (i.e., manifest) that is easiest to encounter the issues. Describe also the details of the steady state itself.\", \"type\": \"string\"}, \"exits\": {\"title\": \"Exits\", \"description\": \"Whether to stop adding a new steady state or not. If you stop here, output 'true'. If you keep adding a new steady state, output 'false'.\", \"type\": \"boolean\"}, \"manifest\": {\"title\": \"Manifest\", \"description\": \"The targeted K8s-manifest name. Specify a SINGLE manifest.\", \"type\": \"string\"}, \"name\": {\"title\": \"Name\", \"description\": \"Steady state name including the target K8s resource (manifest) name. Please write it using a-z, A-Z, and 0-9.\", \"type\": \"string\"}}, \"required\": [\"thought\", \"exits\", \"manifest\", \"name\"]}\n```\nHuman: # Here is the overview of my system:\nThe system consists of the following K8s manifest(s):K8s manifest: sock-shop-2/manifests/00-sock-shop-ns.yaml\n```yaml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: sock-shop\n\n```\nSummary of sock-shop-2/manifests/00-sock-shop-ns.yaml:\n- This manifest defines a Kubernetes Namespace.\n- The Namespace is named 'sock-shop'.\n- Namespaces are used to organize and manage resources in a Kubernetes cluster.\n\nK8s manifest: sock-shop-2/manifests/01-carts-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts\n  template:\n    metadata:\n      labels:\n        name: carts\n    spec:\n      containers:\n      - name: carts\n        image: weaveworksdemos/carts:0.4.8\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/01-carts-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/carts:0.4.8'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 300m CPU and 500Mi memory, and a minimum of 100m CPU and 200Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities.\n- The root filesystem is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/02-carts-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: carts\n\n```\nSummary of sock-shop-2/manifests/02-carts-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The Service is named 'carts'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: carts'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: carts' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/03-carts-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts-db\n  template:\n    metadata:\n      labels:\n        name: carts-db\n    spec:\n      containers:\n      - name: carts-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/03-carts-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts-db' pod running.\n- The pods are selected based on the label 'name: carts-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add only CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/04-carts-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: carts-db\n\n```\nSummary of sock-shop-2/manifests/04-carts-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'carts-db'.\n- It is labeled with 'name: carts-db'.\n- The Service is created in the 'sock-shop' namespace.\n- It exposes port 27017 and directs traffic to the same port on the target pods.\n- The Service selects pods with the label 'name: carts-db' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/05-catalogue-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue\n  template:\n    metadata:\n      labels:\n        name: catalogue\n    spec:\n      containers:\n      - name: catalogue\n        image: weaveworksdemos/catalogue:0.3.5\n        command: [\"/app\"]\n        args:\n        - -port=80\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/05-catalogue-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/catalogue:0.3.5'.\n- The application runs with the command '/app' and listens on port 80.\n- Resource limits are set to 200m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container runs as a non-root user with user ID 10001 and has a read-only root filesystem.\n- Security settings drop all capabilities except 'NET_BIND_SERVICE'.\n- A liveness probe checks the '/health' endpoint on port 80, starting after 300 seconds and repeating every 3 seconds.\n- A readiness probe also checks the '/health' endpoint on port 80, starting after 180 seconds and repeating every 3 seconds.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/06-catalogue-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: catalogue\n\n```\nSummary of sock-shop-2/manifests/06-catalogue-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'catalogue'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: catalogue'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: catalogue'.\n\nK8s manifest: sock-shop-2/manifests/07-catalogue-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue-db\n  template:\n    metadata:\n      labels:\n        name: catalogue-db\n    spec:\n      containers:\n      - name: catalogue-db\n        image: weaveworksdemos/catalogue-db:0.3.0\n        env:\n          - name: MYSQL_ROOT_PASSWORD\n            value: fake_password\n          - name: MYSQL_DATABASE\n            value: socksdb\n        ports:\n        - name: mysql\n          containerPort: 3306\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/07-catalogue-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue-db' pod running.\n- The pods are selected based on the label 'name: catalogue-db'.\n- Each pod runs a single container using the image 'weaveworksdemos/catalogue-db:0.3.0'.\n- The container is configured with environment variables for 'MYSQL_ROOT_PASSWORD' and 'MYSQL_DATABASE'.\n- The container exposes port 3306, which is typically used for MySQL databases.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/08-catalogue-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 3306\n    targetPort: 3306\n  selector:\n    name: catalogue-db\n\n```\nSummary of sock-shop-2/manifests/08-catalogue-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'catalogue-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 3306.\n- It targets the same port (3306) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: catalogue-db'.\n- This setup is typically used to provide a stable endpoint for accessing a database running in the cluster.\n\nK8s manifest: sock-shop-2/manifests/09-front-end-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: front-end\n  namespace: sock-shop\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: front-end\n  template:\n    metadata:\n      labels:\n        name: front-end\n    spec:\n      containers:\n      - name: front-end\n        image: weaveworksdemos/front-end:0.3.12\n        resources:\n          limits:\n            cpu: 300m\n            memory: 1000Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 8079\n        env:\n        - name: SESSION_REDIS\n          value: \"true\"\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 30\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n```\nSummary of sock-shop-2/manifests/09-front-end-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'front-end' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 1 replica of the front-end application running.\n- The Deployment uses a selector to match pods with the label 'name: front-end'.\n- The pod template includes a single container named 'front-end'.\n- The container uses the image 'weaveworksdemos/front-end:0.3.12'.\n- Resource limits are set for the container: 300m CPU and 1000Mi memory.\n- Resource requests are set for the container: 100m CPU and 300Mi memory.\n- The container exposes port 8079.\n- An environment variable 'SESSION_REDIS' is set to 'true'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All Linux capabilities are dropped, and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/' path on port 8079, with an initial delay of 300 seconds and a period of 3 seconds.\n- A readiness probe is also configured to check the '/' path on port 8079, with an initial delay of 30 seconds and a period of 3 seconds.\n- The node selector ensures the pod runs on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/10-front-end-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: front-end\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: front-end\n  namespace: sock-shop\nspec:\n  type: NodePort\n  ports:\n  - port: 80\n    targetPort: 8079\n    nodePort: 30001\n  selector:\n    name: front-end\n\n```\nSummary of sock-shop-2/manifests/10-front-end-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'front-end'.\n- It is located in the 'sock-shop' namespace.\n- The Service type is 'NodePort', which exposes the service on each Node's IP at a static port.\n- It listens on port 80 and forwards traffic to target port 8079 on the pods.\n- The nodePort is set to 30001, which is the port on each node where the service can be accessed externally.\n- The Service is configured to be scraped by Prometheus for monitoring, as indicated by the annotation 'prometheus.io/scrape: true'.\n- It uses a selector to target pods with the label 'name: front-end'.\n\nK8s manifest: sock-shop-2/manifests/11-orders-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders\n  template:\n    metadata:\n      labels:\n        name: orders\n    spec:\n      containers:\n      - name: orders\n        image: weaveworksdemos/orders:0.4.7\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 500m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/11-orders-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/orders:0.4.7'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 500m CPU and 500Mi memory, and a minimum of 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities and a read-only root filesystem.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/12-orders-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: orders\n\n```\nSummary of sock-shop-2/manifests/12-orders-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: orders'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the target pods.\n- It uses a selector to match pods with the label 'name: orders'.\n\nK8s manifest: sock-shop-2/manifests/13-orders-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders-db\n  template:\n    metadata:\n      labels:\n        name: orders-db\n    spec:\n      containers:\n      - name: orders-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/13-orders-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders-db' pod running.\n- The pods are selected based on the label 'name: orders-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add specific ones like CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/14-orders-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: orders-db\n\n```\nSummary of sock-shop-2/manifests/14-orders-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods.\n- The Service selects pods with the label 'name: orders-db'.\n\nK8s manifest: sock-shop-2/manifests/15-payment-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: payment\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: payment\n  template:\n    metadata:\n      labels:\n        name: payment\n    spec:\n      containers:\n      - name: payment\n        image: weaveworksdemos/payment:0.4.3\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 99m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/15-payment-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'payment' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'payment' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/payment:0.4.3'.\n- Resource limits are set for the containers: 200m CPU and 200Mi memory.\n- Resource requests are set for the containers: 99m CPU and 100Mi memory.\n- The container exposes port 80.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All capabilities are dropped except 'NET_BIND_SERVICE', and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/health' endpoint on port 80, starting after 300 seconds and checking every 3 seconds.\n- A readiness probe is also configured to check the '/health' endpoint on port 80, starting after 180 seconds and checking every 3 seconds.\n- The Deployment is scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/16-payment-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: payment\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: payment\n\n```\nSummary of sock-shop-2/manifests/16-payment-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'payment'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: payment'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: payment'.\n\nK8s manifest: sock-shop-2/manifests/17-queue-master-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: queue-master\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: queue-master\n  template:\n    metadata:\n      labels:\n        name: queue-master\n    spec:\n      containers:\n      - name: queue-master\n        image: weaveworksdemos/queue-master:0.3.1\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/17-queue-master-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'queue-master' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'queue-master' pod running.\n- The pods are selected based on the label 'name: queue-master'.\n- Each pod runs a single container using the image 'weaveworksdemos/queue-master:0.3.1'.\n- The container is configured with specific Java options through environment variables.\n- Resource limits are set for the container, with a maximum of 300m CPU and 500Mi memory, and requests for 100m CPU and 300Mi memory.\n- The container exposes port 80.\n- The pods are scheduled on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/18-queue-master-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: queue-master\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: queue-master\n```\nSummary of sock-shop-2/manifests/18-queue-master-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'queue-master'.\n- It is annotated to enable Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: queue-master'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: queue-master' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/19-rabbitmq-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: rabbitmq\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: rabbitmq\n  template:\n    metadata:\n      labels:\n        name: rabbitmq\n      annotations:\n        prometheus.io/scrape: \"false\"\n    spec:\n      containers:\n      - name: rabbitmq\n        image: rabbitmq:3.6.8-management\n        ports:\n        - containerPort: 15672\n          name: management\n        - containerPort: 5672\n          name: rabbitmq\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n              - DAC_OVERRIDE\n          readOnlyRootFilesystem: true\n      - name: rabbitmq-exporter\n        image: kbudde/rabbitmq-exporter\n        ports:\n        - containerPort: 9090\n          name: exporter\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/19-rabbitmq-dep.yaml:\n- This manifest defines a Deployment for RabbitMQ in Kubernetes.\n- The Deployment is named 'rabbitmq' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas, meaning there will be 2 instances of RabbitMQ running.\n- The Deployment uses a label 'name: rabbitmq' to manage its pods.\n- The RabbitMQ container uses the image 'rabbitmq:3.6.8-management'.\n- It exposes two ports: 15672 for management and 5672 for RabbitMQ communication.\n- Security settings drop all capabilities but add CHOWN, SETGID, SETUID, and DAC_OVERRIDE, and the root filesystem is set to read-only.\n- An additional container, 'rabbitmq-exporter', is included for monitoring purposes, using the 'kbudde/rabbitmq-exporter' image and exposing port 9090.\n- The Deployment is configured to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/20-rabbitmq-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: rabbitmq\n  annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 5672\n    name: rabbitmq\n    targetPort: 5672\n  - port: 9090\n    name: exporter\n    targetPort: exporter\n    protocol: TCP\n  selector:\n    name: rabbitmq\n\n```\nSummary of sock-shop-2/manifests/20-rabbitmq-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'rabbitmq'.\n- It is annotated for Prometheus scraping on port 9090.\n- The Service is located in the 'sock-shop' namespace.\n- It exposes two ports: 5672 for RabbitMQ and 9090 for an exporter.\n- The Service uses TCP protocol for communication.\n- It selects pods with the label 'name: rabbitmq' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/21-session-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: session-db\n  template:\n    metadata:\n      labels:\n        name: session-db\n      annotations:\n        prometheus.io.scrape: \"false\"\n    spec:\n      containers:\n      - name: session-db\n        image: redis:alpine\n        ports:\n        - name: redis\n          containerPort: 6379\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/21-session-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'session-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'session-db' pod running.\n- The pods are selected based on the label 'name: session-db'.\n- Each pod runs a single container using the 'redis:alpine' image.\n- The container exposes port 6379, which is commonly used by Redis.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/22-session-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 6379\n    targetPort: 6379\n  selector:\n    name: session-db\n\n```\nSummary of sock-shop-2/manifests/22-session-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'session-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 6379.\n- It targets the same port (6379) on the selected pods.\n- The Service uses a selector to match pods with the label 'name: session-db'.\n\nK8s manifest: sock-shop-2/manifests/23-shipping-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: shipping\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: shipping\n  template:\n    metadata:\n      labels:\n        name: shipping\n    spec:\n      containers:\n      - name: shipping\n        image: weaveworksdemos/shipping:0.4.8\n        env:\n         - name: ZIPKIN\n           value: zipkin.jaeger.svc.cluster.local\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/23-shipping-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'shipping' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas of the 'shipping' application to be run.\n- The Deployment uses the Docker image 'weaveworksdemos/shipping:0.4.8'.\n- Environment variables are set for the application, including 'ZIPKIN' and 'JAVA_OPTS'.\n- Resource limits and requests are defined, with CPU limits at 300m and memory limits at 500Mi, and requests at 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with user ID 10001, and it drops all capabilities except 'NET_BIND_SERVICE'.\n- The root filesystem is set to be read-only.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/24-shipping-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: shipping\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: shipping\n\n\n```\nSummary of sock-shop-2/manifests/24-shipping-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'shipping'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: shipping'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: shipping' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/25-user-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user\n  template:\n    metadata:\n      labels:\n        name: user\n    spec:\n      containers:\n      - name: user\n        image: weaveworksdemos/user:0.4.7\n        resources:\n          limits:\n            cpu: 300m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        env:\n        - name: mongo\n          value: user-db:27017\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/25-user-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/user:0.4.7'.\n- Resource limits are set for the container: 300m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container listens on port 80.\n- An environment variable 'mongo' is set with the value 'user-db:27017'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- The container has a read-only root filesystem and drops all capabilities except 'NET_BIND_SERVICE'.\n- Liveness and readiness probes are configured to check the '/health' endpoint on port 80, with initial delays of 300 and 180 seconds, respectively.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/26-user-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: user\n\n\n```\nSummary of sock-shop-2/manifests/26-user-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: user'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It uses a selector to target pods with the label 'name: user'.\n\nK8s manifest: sock-shop-2/manifests/27-user-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user-db\n  template:\n    metadata:\n      labels:\n        name: user-db\n    spec:\n      containers:\n      - name: user-db\n        image: weaveworksdemos/user-db:0.3.0\n\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/27-user-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user-db' pod running.\n- The pods are labeled with 'name: user-db' for identification and selection.\n- Each pod runs a single container using the image 'weaveworksdemos/user-db:0.3.0'.\n- The container exposes port 27017, which is typically used by MongoDB.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/28-user-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: user-db\n\n\n```\nSummary of sock-shop-2/manifests/28-user-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: user-db'.\n\nThe resiliency issues/weaknesses in the system are as follows:\nIssue #0: Missing Port Configuration\n  - details: The service does not specify the port it should serve on, which can lead to connectivity issues.\n  - manifests having the issues: ['sock-shop-2/manifests/02-carts-svc.yaml', 'sock-shop-2/manifests/04-carts-db-svc.yaml', 'sock-shop-2/manifests/06-catalogue-svc.yaml', 'sock-shop-2/manifests/08-catalogue-db-svc.yaml', 'sock-shop-2/manifests/12-orders-svc.yaml', 'sock-shop-2/manifests/14-orders-db-svc.yaml', 'sock-shop-2/manifests/16-payment-svc.yaml', 'sock-shop-2/manifests/18-queue-master-svc.yaml', 'sock-shop-2/manifests/22-session-db-svc.yaml', 'sock-shop-2/manifests/24-shipping-svc.yaml', 'sock-shop-2/manifests/26-user-svc.yaml', 'sock-shop-2/manifests/28-user-db-svc.yaml']\n  - problematic config: The 'ports' field in the Service spec is missing the 'port' configuration.\n\nIssue #1: Single Replica Deployment\n  - details: Having a single replica for a deployment can lead to downtime if the pod fails.\n  - manifests having the issues: ['sock-shop-2/manifests/09-front-end-dep.yaml']\n  - problematic config: The 'replicas' field is set to 1.\n\nIssue #2: High Initial Delay for Liveness Probe\n  - details: A high initial delay for the liveness probe can delay the detection of a non-responsive application.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/09-front-end-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the liveness probe is set to 300.\n\nIssue #3: High Initial Delay for Readiness Probe\n  - details: A high initial delay for the readiness probe can delay the application from being marked as ready, affecting service availability.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the readiness probe is set to 180.\n\nThe expected type of application on the system (i.e., K8s manfests):\nSock Shop is an e-commerce application that simulates an online sock store. It offers users the ability to browse a catalogue of socks, add items to a cart, place orders, and manage user accounts. The application is composed of multiple microservices, each responsible for a specific function within the e-commerce workflow, such as handling orders, managing user sessions, and processing payments.; The manifests provided are part of a well-known microservices demo application called 'Sock Shop'. This application is designed to demonstrate the use of microservices architecture and Kubernetes orchestration. The file names, labels, and images used in the manifests (e.g., 'weaveworksdemos') are indicative of the Sock Shop application, which simulates an e-commerce website for selling socks. The application includes various services such as carts, catalogue, orders, payment, and user management, each with its own database and service components, reflecting a typical e-commerce platform's architecture.\n\n# Please follow the instructions below regarding Chaos Engineering:\n- The Chaos-Engineering experiment must be completed within 1 minute.\n\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\n  1. http://front-end.sock-shop.svc.cluster.local/\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\n  4. http://front-end.sock-shop.svc.cluster.local/category/\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html\n\n# Steady states already defined are the following:\nNo steady states are defined for now.\n\nAfter considering whether a new steady state needs to be added, define a steady state that are different from the already defined steady states, if necessary.\nAI: ```json\n{\"thought\":"
            ],
            "{\"thought\":\"The first issue to address is the 'Missing Port Configuration' in the Service manifests. This issue is likely to cause connectivity problems, making it a critical aspect to verify. Among the manifests with this issue, 'sock-shop-2/manifests/02-carts-svc.yaml' is selected as it is the first in the list. The steady state will ensure that the Service is functioning correctly by checking the number of endpoints available for the 'carts' service, which should match the number of replicas in the corresponding Deployment.\",\"exits\":false,\"manifest\":\"sock-shop-2/manifests/02-carts-svc.yaml\",\"name\":\"CartsServiceEndpointsAvailable\"}\n"
        ]
    },
    {
        "name": "tool_command_writing",
        "token_usage": {
            "input_tokens": 22072,
            "output_tokens": 459,
            "total_tokens": 22531
        },
        "message_history": [
            [
                "System: You are a helpful AI assistant for Chaos Engineering.\nGiven Kubernetes (K8s) manifests for a network system and its state type, you will inspect the current value of the state type.\nAlways keep the following rules:\n- You can use either K8s API (Python) or k6 (Javascript) to inspect the state.\n- Use the K8s API for checking the current state of K8s resources\n- Use k6 for checking communication statuses/metrics, such as request sending, response time, latency, etc.\n- If you use K8s API, consider appropriate test duration. If you use k6, consider not only appropriate test duration but also an appropriate number of virtual users in the load test.\n- Pay attention to namespace specification. If the namespace is specified in the manifest, it is deployed with the namespace. If not, it is deployed with the 'default' namespace.\n- When sending requests to a K8s resources, use their internal DNS names in the format: ```service-name.namespace.svc.cluster.local:port```. For the port setting, use the service port, not the targetPort or nodePort. Ensure that the port matches the service port defined in the manifest.\n- If other request formats are provided by the user, follow the user's format.\n- The output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"thought\": {\"title\": \"Thought\", \"description\": \"Describe your thoughts for the tool usage. e.g., the reason why you choose the tool and how to use.\", \"type\": \"string\"}, \"tool_type\": {\"title\": \"Tool Type\", \"description\": \"Tool to inspect the steady state. Select from ['k8s', 'k6'].\", \"enum\": [\"k8s\", \"k6\"], \"type\": \"string\"}, \"tool\": {\"title\": \"Tool\", \"description\": \"If tool_tyepe='k8s', write here K8sAPI. If tool_tyepe='k6', write here K6JS.\", \"anyOf\": [{\"$ref\": \"#/definitions/K8sAPI\"}, {\"$ref\": \"#/definitions/K6JS\"}]}}, \"required\": [\"thought\", \"tool_type\", \"tool\"], \"definitions\": {\"K8sAPI\": {\"title\": \"K8sAPI\", \"type\": \"object\", \"properties\": {\"duration\": {\"title\": \"Duration\", \"description\": \"Duration of the status check every second in a for loop. Set appropriate duration to check the current state of the system. The maximum duration is 5s.\", \"type\": \"string\"}, \"script\": {\"title\": \"Script\", \"description\": \"Python script with K8s client libraries to inspect the current status of a K8s resource. Write only the content of the code, and for dictionary values, enclose them within a pair of single double quotes (\\\"). Implement a for loop that checks the status every second for the duration, and print a summary of the results at the end.\\n- To support docker env, please configure the client as follows: ```\\n# Load Kubernetes configuration based on the environment\\n    if os.getenv('KUBERNETES_SERVICE_HOST'):\\n        config.load_incluster_config()\\n    else:\\n        config.load_kube_config()\\n```\\n- Please add a Add a entry point at the bottom to allow the test to be run from the command line.\\n- Please add argparse '--duration' (type=int) so that users can specify the loop duration.\", \"type\": \"string\"}}, \"required\": [\"duration\", \"script\"]}, \"K6JS\": {\"title\": \"K6JS\", \"type\": \"object\", \"properties\": {\"vus\": {\"title\": \"Vus\", \"description\": \"The number of virtual users. You can run a load test with the number of virutal users.\", \"type\": \"integer\"}, \"duration\": {\"title\": \"Duration\", \"description\": \"Duration of the load test. Set appropriate duration to check the current state of the system. The maximum duration is 5s.\", \"type\": \"string\"}, \"script\": {\"title\": \"Script\", \"description\": \"k6 javascript to inspect the current state. Write only the content of the code, and for dictionary values, enclose them within a pair of single double quotes (\\\"). In options in the javascript, set the same 'vus' and 'duration' options as the above. The interval of status check must be 1s second(s). Set a threshold that triggers an error when a request failure is clearly occurring.\", \"type\": \"string\"}}, \"required\": [\"vus\", \"duration\", \"script\"]}}}\n```\nHuman: # Here is the overview of my system:\n<bound method ProcessedData.to_k8s_overview_str of ProcessedData(work_dir='sandbox/cycle_20241127_030827/inputs', input=ChaosEaterInput(skaffold_yaml=File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/skaffold.yaml', content='apiVersion: skaffold/v3\\nkind: Config\\nmetadata:\\n  name: sock-shop-app\\nmanifests:\\n  rawYaml:\\n    - manifests/00-sock-shop-ns.yaml\\n    - manifests/01-carts-dep.yaml\\n    - manifests/02-carts-svc.yaml\\n    - manifests/03-carts-db-dep.yaml\\n    - manifests/04-carts-db-svc.yaml\\n    - manifests/05-catalogue-dep.yaml\\n    - manifests/06-catalogue-svc.yaml\\n    - manifests/07-catalogue-db-dep.yaml\\n    - manifests/08-catalogue-db-svc.yaml\\n    - manifests/09-front-end-dep.yaml\\n    - manifests/10-front-end-svc.yaml\\n    - manifests/11-orders-dep.yaml\\n    - manifests/12-orders-svc.yaml\\n    - manifests/13-orders-db-dep.yaml\\n    - manifests/14-orders-db-svc.yaml\\n    - manifests/15-payment-dep.yaml\\n    - manifests/16-payment-svc.yaml\\n    - manifests/17-queue-master-dep.yaml\\n    - manifests/18-queue-master-svc.yaml\\n    - manifests/19-rabbitmq-dep.yaml\\n    - manifests/20-rabbitmq-svc.yaml\\n    - manifests/21-session-db-dep.yaml\\n    - manifests/22-session-db-svc.yaml\\n    - manifests/23-shipping-dep.yaml\\n    - manifests/24-shipping-svc.yaml\\n    - manifests/25-user-dep.yaml\\n    - manifests/26-user-svc.yaml\\n    - manifests/27-user-db-dep.yaml\\n    - manifests/28-user-db-svc.yaml', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/skaffold.yaml'), files=[File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/21-session-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: session-db\\n  labels:\\n    name: session-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: session-db\\n  template:\\n    metadata:\\n      labels:\\n        name: session-db\\n      annotations:\\n        prometheus.io.scrape: \"false\"\\n    spec:\\n      containers:\\n      - name: session-db\\n        image: redis:alpine\\n        ports:\\n        - name: redis\\n          containerPort: 6379\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/21-session-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/23-shipping-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: shipping\\n  labels:\\n    name: shipping\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: shipping\\n  template:\\n    metadata:\\n      labels:\\n        name: shipping\\n    spec:\\n      containers:\\n      - name: shipping\\n        image: weaveworksdemos/shipping:0.4.8\\n        env:\\n         - name: ZIPKIN\\n           value: zipkin.jaeger.svc.cluster.local\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/23-shipping-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/18-queue-master-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: queue-master\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: queue-master\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: queue-master\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/18-queue-master-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/04-carts-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: carts-db\\n  labels:\\n    name: carts-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 27017\\n    targetPort: 27017\\n  selector:\\n    name: carts-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/04-carts-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/05-catalogue-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: catalogue\\n  labels:\\n    name: catalogue\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: catalogue\\n  template:\\n    metadata:\\n      labels:\\n        name: catalogue\\n    spec:\\n      containers:\\n      - name: catalogue\\n        image: weaveworksdemos/catalogue:0.3.5\\n        command: [\"/app\"]\\n        args:\\n        - -port=80\\n        resources:\\n          limits:\\n            cpu: 200m\\n            memory: 200Mi\\n          requests:\\n            cpu: 100m\\n            memory: 100Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 180\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/05-catalogue-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/25-user-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: user\\n  labels:\\n    name: user\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: user\\n  template:\\n    metadata:\\n      labels:\\n        name: user\\n    spec:\\n      containers:\\n      - name: user\\n        image: weaveworksdemos/user:0.4.7\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 200Mi\\n          requests:\\n            cpu: 100m\\n            memory: 100Mi\\n        ports:\\n        - containerPort: 80\\n        env:\\n        - name: mongo\\n          value: user-db:27017\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 180\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/25-user-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/12-orders-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: orders\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: orders\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: orders\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/12-orders-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/09-front-end-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: front-end\\n  namespace: sock-shop\\nspec:\\n  replicas: 1\\n  selector:\\n    matchLabels:\\n      name: front-end\\n  template:\\n    metadata:\\n      labels:\\n        name: front-end\\n    spec:\\n      containers:\\n      - name: front-end\\n        image: weaveworksdemos/front-end:0.3.12\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 1000Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 8079\\n        env:\\n        - name: SESSION_REDIS\\n          value: \"true\"\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /\\n            port: 8079\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /\\n            port: 8079\\n          initialDelaySeconds: 30\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/09-front-end-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/19-rabbitmq-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: rabbitmq\\n  labels:\\n    name: rabbitmq\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: rabbitmq\\n  template:\\n    metadata:\\n      labels:\\n        name: rabbitmq\\n      annotations:\\n        prometheus.io/scrape: \"false\"\\n    spec:\\n      containers:\\n      - name: rabbitmq\\n        image: rabbitmq:3.6.8-management\\n        ports:\\n        - containerPort: 15672\\n          name: management\\n        - containerPort: 5672\\n          name: rabbitmq\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n              - DAC_OVERRIDE\\n          readOnlyRootFilesystem: true\\n      - name: rabbitmq-exporter\\n        image: kbudde/rabbitmq-exporter\\n        ports:\\n        - containerPort: 9090\\n          name: exporter\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/19-rabbitmq-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/13-orders-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: orders-db\\n  labels:\\n    name: orders-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: orders-db\\n  template:\\n    metadata:\\n      labels:\\n        name: orders-db\\n    spec:\\n      containers:\\n      - name: orders-db\\n        image: mongo\\n        ports:\\n        - name: mongo\\n          containerPort: 27017\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/13-orders-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/06-catalogue-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: catalogue\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: catalogue\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: catalogue\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/06-catalogue-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/07-catalogue-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: catalogue-db\\n  labels:\\n    name: catalogue-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: catalogue-db\\n  template:\\n    metadata:\\n      labels:\\n        name: catalogue-db\\n    spec:\\n      containers:\\n      - name: catalogue-db\\n        image: weaveworksdemos/catalogue-db:0.3.0\\n        env:\\n          - name: MYSQL_ROOT_PASSWORD\\n            value: fake_password\\n          - name: MYSQL_DATABASE\\n            value: socksdb\\n        ports:\\n        - name: mysql\\n          containerPort: 3306\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/07-catalogue-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/24-shipping-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: shipping\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: shipping\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: shipping\\n\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/24-shipping-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/02-carts-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: carts\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: carts\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: carts\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/02-carts-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/22-session-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: session-db\\n  labels:\\n    name: session-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 6379\\n    targetPort: 6379\\n  selector:\\n    name: session-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/22-session-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/01-carts-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: carts\\n  labels:\\n    name: carts\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: carts\\n  template:\\n    metadata:\\n      labels:\\n        name: carts\\n    spec:\\n      containers:\\n      - name: carts\\n        image: weaveworksdemos/carts:0.4.8\\n        env:\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 200Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/01-carts-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/28-user-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: user-db\\n  labels:\\n    name: user-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 27017\\n    targetPort: 27017\\n  selector:\\n    name: user-db\\n\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/28-user-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/15-payment-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: payment\\n  labels:\\n    name: payment\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: payment\\n  template:\\n    metadata:\\n      labels:\\n        name: payment\\n    spec:\\n      containers:\\n      - name: payment\\n        image: weaveworksdemos/payment:0.4.3\\n        resources:\\n          limits:\\n            cpu: 200m\\n            memory: 200Mi\\n          requests:\\n            cpu: 99m\\n            memory: 100Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 180\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/15-payment-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/10-front-end-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: front-end\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: front-end\\n  namespace: sock-shop\\nspec:\\n  type: NodePort\\n  ports:\\n  - port: 80\\n    targetPort: 8079\\n    nodePort: 30001\\n  selector:\\n    name: front-end\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/10-front-end-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/03-carts-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: carts-db\\n  labels:\\n    name: carts-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: carts-db\\n  template:\\n    metadata:\\n      labels:\\n        name: carts-db\\n    spec:\\n      containers:\\n      - name: carts-db\\n        image: mongo\\n        ports:\\n        - name: mongo\\n          containerPort: 27017\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/03-carts-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/17-queue-master-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: queue-master\\n  labels:\\n    name: queue-master\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: queue-master\\n  template:\\n    metadata:\\n      labels:\\n        name: queue-master\\n    spec:\\n      containers:\\n      - name: queue-master\\n        image: weaveworksdemos/queue-master:0.3.1\\n        env:\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 80\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/17-queue-master-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/27-user-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: user-db\\n  labels:\\n    name: user-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: user-db\\n  template:\\n    metadata:\\n      labels:\\n        name: user-db\\n    spec:\\n      containers:\\n      - name: user-db\\n        image: weaveworksdemos/user-db:0.3.0\\n\\n        ports:\\n        - name: mongo\\n          containerPort: 27017\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/27-user-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/26-user-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: user\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: user\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: user\\n\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/26-user-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/16-payment-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: payment\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: payment\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: payment\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/16-payment-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/20-rabbitmq-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: rabbitmq\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n        prometheus.io/port: '9090'\\n  labels:\\n    name: rabbitmq\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 5672\\n    name: rabbitmq\\n    targetPort: 5672\\n  - port: 9090\\n    name: exporter\\n    targetPort: exporter\\n    protocol: TCP\\n  selector:\\n    name: rabbitmq\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/20-rabbitmq-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/00-sock-shop-ns.yaml', content='apiVersion: v1\\nkind: Namespace\\nmetadata:\\n  name: sock-shop\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/00-sock-shop-ns.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/11-orders-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: orders\\n  labels:\\n    name: orders\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: orders\\n  template:\\n    metadata:\\n      labels:\\n        name: orders\\n    spec:\\n      containers:\\n      - name: orders\\n        image: weaveworksdemos/orders:0.4.7\\n        env:\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 500m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/11-orders-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/08-catalogue-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: catalogue-db\\n  labels:\\n    name: catalogue-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 3306\\n    targetPort: 3306\\n  selector:\\n    name: catalogue-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/08-catalogue-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/14-orders-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: orders-db\\n  labels:\\n    name: orders-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 27017\\n    targetPort: 27017\\n  selector:\\n    name: orders-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/14-orders-db-svc.yaml')], ce_instructions='- The Chaos-Engineering experiment must be completed within 1 minute.\\n\\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\\n  1. http://front-end.sock-shop.svc.cluster.local/\\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\\n  4. http://front-end.sock-shop.svc.cluster.local/category/\\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html'), k8s_yamls=[File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/00-sock-shop-ns.yaml', content='apiVersion: v1\\nkind: Namespace\\nmetadata:\\n  name: sock-shop\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/00-sock-shop-ns.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/01-carts-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: carts\\n  labels:\\n    name: carts\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: carts\\n  template:\\n    metadata:\\n      labels:\\n        name: carts\\n    spec:\\n      containers:\\n      - name: carts\\n        image: weaveworksdemos/carts:0.4.8\\n        env:\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 200Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/01-carts-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/02-carts-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: carts\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: carts\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: carts\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/02-carts-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/03-carts-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: carts-db\\n  labels:\\n    name: carts-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: carts-db\\n  template:\\n    metadata:\\n      labels:\\n        name: carts-db\\n    spec:\\n      containers:\\n      - name: carts-db\\n        image: mongo\\n        ports:\\n        - name: mongo\\n          containerPort: 27017\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/03-carts-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/04-carts-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: carts-db\\n  labels:\\n    name: carts-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 27017\\n    targetPort: 27017\\n  selector:\\n    name: carts-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/04-carts-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/05-catalogue-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: catalogue\\n  labels:\\n    name: catalogue\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: catalogue\\n  template:\\n    metadata:\\n      labels:\\n        name: catalogue\\n    spec:\\n      containers:\\n      - name: catalogue\\n        image: weaveworksdemos/catalogue:0.3.5\\n        command: [\"/app\"]\\n        args:\\n        - -port=80\\n        resources:\\n          limits:\\n            cpu: 200m\\n            memory: 200Mi\\n          requests:\\n            cpu: 100m\\n            memory: 100Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 180\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/05-catalogue-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/06-catalogue-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: catalogue\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: catalogue\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: catalogue\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/06-catalogue-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/07-catalogue-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: catalogue-db\\n  labels:\\n    name: catalogue-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: catalogue-db\\n  template:\\n    metadata:\\n      labels:\\n        name: catalogue-db\\n    spec:\\n      containers:\\n      - name: catalogue-db\\n        image: weaveworksdemos/catalogue-db:0.3.0\\n        env:\\n          - name: MYSQL_ROOT_PASSWORD\\n            value: fake_password\\n          - name: MYSQL_DATABASE\\n            value: socksdb\\n        ports:\\n        - name: mysql\\n          containerPort: 3306\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/07-catalogue-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/08-catalogue-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: catalogue-db\\n  labels:\\n    name: catalogue-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 3306\\n    targetPort: 3306\\n  selector:\\n    name: catalogue-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/08-catalogue-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/09-front-end-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: front-end\\n  namespace: sock-shop\\nspec:\\n  replicas: 1\\n  selector:\\n    matchLabels:\\n      name: front-end\\n  template:\\n    metadata:\\n      labels:\\n        name: front-end\\n    spec:\\n      containers:\\n      - name: front-end\\n        image: weaveworksdemos/front-end:0.3.12\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 1000Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 8079\\n        env:\\n        - name: SESSION_REDIS\\n          value: \"true\"\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /\\n            port: 8079\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /\\n            port: 8079\\n          initialDelaySeconds: 30\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/09-front-end-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/10-front-end-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: front-end\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: front-end\\n  namespace: sock-shop\\nspec:\\n  type: NodePort\\n  ports:\\n  - port: 80\\n    targetPort: 8079\\n    nodePort: 30001\\n  selector:\\n    name: front-end\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/10-front-end-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/11-orders-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: orders\\n  labels:\\n    name: orders\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: orders\\n  template:\\n    metadata:\\n      labels:\\n        name: orders\\n    spec:\\n      containers:\\n      - name: orders\\n        image: weaveworksdemos/orders:0.4.7\\n        env:\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 500m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/11-orders-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/12-orders-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: orders\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: orders\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: orders\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/12-orders-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/13-orders-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: orders-db\\n  labels:\\n    name: orders-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: orders-db\\n  template:\\n    metadata:\\n      labels:\\n        name: orders-db\\n    spec:\\n      containers:\\n      - name: orders-db\\n        image: mongo\\n        ports:\\n        - name: mongo\\n          containerPort: 27017\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/13-orders-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/14-orders-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: orders-db\\n  labels:\\n    name: orders-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 27017\\n    targetPort: 27017\\n  selector:\\n    name: orders-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/14-orders-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/15-payment-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: payment\\n  labels:\\n    name: payment\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: payment\\n  template:\\n    metadata:\\n      labels:\\n        name: payment\\n    spec:\\n      containers:\\n      - name: payment\\n        image: weaveworksdemos/payment:0.4.3\\n        resources:\\n          limits:\\n            cpu: 200m\\n            memory: 200Mi\\n          requests:\\n            cpu: 99m\\n            memory: 100Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 180\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/15-payment-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/16-payment-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: payment\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: payment\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: payment\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/16-payment-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/17-queue-master-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: queue-master\\n  labels:\\n    name: queue-master\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: queue-master\\n  template:\\n    metadata:\\n      labels:\\n        name: queue-master\\n    spec:\\n      containers:\\n      - name: queue-master\\n        image: weaveworksdemos/queue-master:0.3.1\\n        env:\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 80\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/17-queue-master-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/18-queue-master-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: queue-master\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: queue-master\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: queue-master\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/18-queue-master-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/19-rabbitmq-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: rabbitmq\\n  labels:\\n    name: rabbitmq\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: rabbitmq\\n  template:\\n    metadata:\\n      labels:\\n        name: rabbitmq\\n      annotations:\\n        prometheus.io/scrape: \"false\"\\n    spec:\\n      containers:\\n      - name: rabbitmq\\n        image: rabbitmq:3.6.8-management\\n        ports:\\n        - containerPort: 15672\\n          name: management\\n        - containerPort: 5672\\n          name: rabbitmq\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n              - DAC_OVERRIDE\\n          readOnlyRootFilesystem: true\\n      - name: rabbitmq-exporter\\n        image: kbudde/rabbitmq-exporter\\n        ports:\\n        - containerPort: 9090\\n          name: exporter\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/19-rabbitmq-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/20-rabbitmq-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: rabbitmq\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n        prometheus.io/port: '9090'\\n  labels:\\n    name: rabbitmq\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 5672\\n    name: rabbitmq\\n    targetPort: 5672\\n  - port: 9090\\n    name: exporter\\n    targetPort: exporter\\n    protocol: TCP\\n  selector:\\n    name: rabbitmq\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/20-rabbitmq-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/21-session-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: session-db\\n  labels:\\n    name: session-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: session-db\\n  template:\\n    metadata:\\n      labels:\\n        name: session-db\\n      annotations:\\n        prometheus.io.scrape: \"false\"\\n    spec:\\n      containers:\\n      - name: session-db\\n        image: redis:alpine\\n        ports:\\n        - name: redis\\n          containerPort: 6379\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/21-session-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/22-session-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: session-db\\n  labels:\\n    name: session-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 6379\\n    targetPort: 6379\\n  selector:\\n    name: session-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/22-session-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/23-shipping-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: shipping\\n  labels:\\n    name: shipping\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: shipping\\n  template:\\n    metadata:\\n      labels:\\n        name: shipping\\n    spec:\\n      containers:\\n      - name: shipping\\n        image: weaveworksdemos/shipping:0.4.8\\n        env:\\n         - name: ZIPKIN\\n           value: zipkin.jaeger.svc.cluster.local\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/23-shipping-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/24-shipping-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: shipping\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: shipping\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: shipping\\n\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/24-shipping-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/25-user-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: user\\n  labels:\\n    name: user\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: user\\n  template:\\n    metadata:\\n      labels:\\n        name: user\\n    spec:\\n      containers:\\n      - name: user\\n        image: weaveworksdemos/user:0.4.7\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 200Mi\\n          requests:\\n            cpu: 100m\\n            memory: 100Mi\\n        ports:\\n        - containerPort: 80\\n        env:\\n        - name: mongo\\n          value: user-db:27017\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 180\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/25-user-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/26-user-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: user\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: user\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: user\\n\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/26-user-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/27-user-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: user-db\\n  labels:\\n    name: user-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: user-db\\n  template:\\n    metadata:\\n      labels:\\n        name: user-db\\n    spec:\\n      containers:\\n      - name: user-db\\n        image: weaveworksdemos/user-db:0.3.0\\n\\n        ports:\\n        - name: mongo\\n          containerPort: 27017\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/27-user-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/28-user-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: user-db\\n  labels:\\n    name: user-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 27017\\n    targetPort: 27017\\n  selector:\\n    name: user-db\\n\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/28-user-db-svc.yaml')], k8s_summaries=[\"- This manifest defines a Kubernetes Namespace.\\n- The Namespace is named 'sock-shop'.\\n- Namespaces are used to organize and manage resources in a Kubernetes cluster.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'carts' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'carts' application running.\\n- The Deployment uses the Docker image 'weaveworksdemos/carts:0.4.8'.\\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\\n- Resource limits and requests are defined, with a maximum of 300m CPU and 500Mi memory, and a minimum of 100m CPU and 200Mi memory.\\n- The application listens on port 80 within the container.\\n- Security context is configured to run the container as a non-root user with specific capabilities.\\n- The root filesystem is set to be read-only for security purposes.\\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\\n- The Deployment is scheduled to run on nodes with the Linux operating system.\", \"- This is a Kubernetes Service manifest.\\n- The Service is named 'carts'.\\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The Service is labeled with 'name: carts'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\\n- It selects pods with the label 'name: carts' to route traffic to.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'carts-db' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'carts-db' pod running.\\n- The pods are selected based on the label 'name: carts-db'.\\n- Each pod runs a single container using the 'mongo' image.\\n- The container exposes port 27017, which is the default port for MongoDB.\\n- Security settings are applied to drop all capabilities and add only CHOWN, SETGID, and SETUID.\\n- The root filesystem of the container is set to read-only for security purposes.\\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'carts-db'.\\n- It is labeled with 'name: carts-db'.\\n- The Service is created in the 'sock-shop' namespace.\\n- It exposes port 27017 and directs traffic to the same port on the target pods.\\n- The Service selects pods with the label 'name: carts-db' to route traffic to.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'catalogue' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'catalogue' application running.\\n- The Deployment uses the Docker image 'weaveworksdemos/catalogue:0.3.5'.\\n- The application runs with the command '/app' and listens on port 80.\\n- Resource limits are set to 200m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\\n- The container runs as a non-root user with user ID 10001 and has a read-only root filesystem.\\n- Security settings drop all capabilities except 'NET_BIND_SERVICE'.\\n- A liveness probe checks the '/health' endpoint on port 80, starting after 300 seconds and repeating every 3 seconds.\\n- A readiness probe also checks the '/health' endpoint on port 80, starting after 180 seconds and repeating every 3 seconds.\\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\", \"- This is a Kubernetes Service manifest.\\n- The service is named 'catalogue'.\\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The service is labeled with 'name: catalogue'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\\n- It selects pods with the label 'name: catalogue'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'catalogue-db' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'catalogue-db' pod running.\\n- The pods are selected based on the label 'name: catalogue-db'.\\n- Each pod runs a single container using the image 'weaveworksdemos/catalogue-db:0.3.0'.\\n- The container is configured with environment variables for 'MYSQL_ROOT_PASSWORD' and 'MYSQL_DATABASE'.\\n- The container exposes port 3306, which is typically used for MySQL databases.\\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'catalogue-db'.\\n- It is located in the 'sock-shop' namespace.\\n- The Service is configured to expose port 3306.\\n- It targets the same port (3306) on the pods it selects.\\n- The Service uses a selector to match pods with the label 'name: catalogue-db'.\\n- This setup is typically used to provide a stable endpoint for accessing a database running in the cluster.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'front-end' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 1 replica of the front-end application running.\\n- The Deployment uses a selector to match pods with the label 'name: front-end'.\\n- The pod template includes a single container named 'front-end'.\\n- The container uses the image 'weaveworksdemos/front-end:0.3.12'.\\n- Resource limits are set for the container: 300m CPU and 1000Mi memory.\\n- Resource requests are set for the container: 100m CPU and 300Mi memory.\\n- The container exposes port 8079.\\n- An environment variable 'SESSION_REDIS' is set to 'true'.\\n- Security context is configured to run the container as a non-root user with user ID 10001.\\n- All Linux capabilities are dropped, and the root filesystem is set to read-only.\\n- A liveness probe is configured to check the '/' path on port 8079, with an initial delay of 300 seconds and a period of 3 seconds.\\n- A readiness probe is also configured to check the '/' path on port 8079, with an initial delay of 30 seconds and a period of 3 seconds.\\n- The node selector ensures the pod runs on nodes with the operating system labeled as Linux.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'front-end'.\\n- It is located in the 'sock-shop' namespace.\\n- The Service type is 'NodePort', which exposes the service on each Node's IP at a static port.\\n- It listens on port 80 and forwards traffic to target port 8079 on the pods.\\n- The nodePort is set to 30001, which is the port on each node where the service can be accessed externally.\\n- The Service is configured to be scraped by Prometheus for monitoring, as indicated by the annotation 'prometheus.io/scrape: true'.\\n- It uses a selector to target pods with the label 'name: front-end'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'orders' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'orders' application running.\\n- The Deployment uses the Docker image 'weaveworksdemos/orders:0.4.7'.\\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\\n- Resource limits and requests are defined, with a maximum of 500m CPU and 500Mi memory, and a minimum of 100m CPU and 300Mi memory.\\n- The application listens on port 80 within the container.\\n- Security context is configured to run the container as a non-root user with specific capabilities and a read-only root filesystem.\\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\\n- The Deployment is scheduled to run on nodes with the Linux operating system.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'orders'.\\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The Service is labeled with 'name: orders'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The Service exposes port 80 and directs traffic to the same port on the target pods.\\n- It uses a selector to match pods with the label 'name: orders'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'orders-db' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'orders-db' pod running.\\n- The pods are selected based on the label 'name: orders-db'.\\n- Each pod runs a single container using the 'mongo' image.\\n- The container exposes port 27017, which is the default port for MongoDB.\\n- Security settings are applied to drop all capabilities and add specific ones like CHOWN, SETGID, and SETUID.\\n- The root filesystem of the container is set to be read-only for security purposes.\\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'orders-db'.\\n- It is located in the 'sock-shop' namespace.\\n- The Service is configured to expose port 27017.\\n- It targets the same port (27017) on the pods.\\n- The Service selects pods with the label 'name: orders-db'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'payment' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'payment' application running.\\n- The Deployment uses the Docker image 'weaveworksdemos/payment:0.4.3'.\\n- Resource limits are set for the containers: 200m CPU and 200Mi memory.\\n- Resource requests are set for the containers: 99m CPU and 100Mi memory.\\n- The container exposes port 80.\\n- Security context is configured to run the container as a non-root user with user ID 10001.\\n- All capabilities are dropped except 'NET_BIND_SERVICE', and the root filesystem is set to read-only.\\n- A liveness probe is configured to check the '/health' endpoint on port 80, starting after 300 seconds and checking every 3 seconds.\\n- A readiness probe is also configured to check the '/health' endpoint on port 80, starting after 180 seconds and checking every 3 seconds.\\n- The Deployment is scheduled to run on nodes with the operating system labeled as Linux.\", \"- This is a Kubernetes Service manifest.\\n- The service is named 'payment'.\\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The service is labeled with 'name: payment'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\\n- It selects pods with the label 'name: payment'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'queue-master' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'queue-master' pod running.\\n- The pods are selected based on the label 'name: queue-master'.\\n- Each pod runs a single container using the image 'weaveworksdemos/queue-master:0.3.1'.\\n- The container is configured with specific Java options through environment variables.\\n- Resource limits are set for the container, with a maximum of 300m CPU and 500Mi memory, and requests for 100m CPU and 300Mi memory.\\n- The container exposes port 80.\\n- The pods are scheduled on nodes with the operating system labeled as 'linux'.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'queue-master'.\\n- It is annotated to enable Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The Service is labeled with 'name: queue-master'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\\n- It selects pods with the label 'name: queue-master' to route traffic to.\", \"- This manifest defines a Deployment for RabbitMQ in Kubernetes.\\n- The Deployment is named 'rabbitmq' and is located in the 'sock-shop' namespace.\\n- It specifies 2 replicas, meaning there will be 2 instances of RabbitMQ running.\\n- The Deployment uses a label 'name: rabbitmq' to manage its pods.\\n- The RabbitMQ container uses the image 'rabbitmq:3.6.8-management'.\\n- It exposes two ports: 15672 for management and 5672 for RabbitMQ communication.\\n- Security settings drop all capabilities but add CHOWN, SETGID, SETUID, and DAC_OVERRIDE, and the root filesystem is set to read-only.\\n- An additional container, 'rabbitmq-exporter', is included for monitoring purposes, using the 'kbudde/rabbitmq-exporter' image and exposing port 9090.\\n- The Deployment is configured to run on nodes with the Linux operating system.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'rabbitmq'.\\n- It is annotated for Prometheus scraping on port 9090.\\n- The Service is located in the 'sock-shop' namespace.\\n- It exposes two ports: 5672 for RabbitMQ and 9090 for an exporter.\\n- The Service uses TCP protocol for communication.\\n- It selects pods with the label 'name: rabbitmq' to route traffic to.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'session-db' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'session-db' pod running.\\n- The pods are selected based on the label 'name: session-db'.\\n- Each pod runs a single container using the 'redis:alpine' image.\\n- The container exposes port 6379, which is commonly used by Redis.\\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\\n- The root filesystem of the container is set to be read-only for security purposes.\\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'session-db'.\\n- It is located in the 'sock-shop' namespace.\\n- The Service is configured to expose port 6379.\\n- It targets the same port (6379) on the selected pods.\\n- The Service uses a selector to match pods with the label 'name: session-db'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'shipping' and is located in the 'sock-shop' namespace.\\n- It specifies 2 replicas of the 'shipping' application to be run.\\n- The Deployment uses the Docker image 'weaveworksdemos/shipping:0.4.8'.\\n- Environment variables are set for the application, including 'ZIPKIN' and 'JAVA_OPTS'.\\n- Resource limits and requests are defined, with CPU limits at 300m and memory limits at 500Mi, and requests at 100m CPU and 300Mi memory.\\n- The application listens on port 80 within the container.\\n- Security context is configured to run the container as a non-root user with user ID 10001, and it drops all capabilities except 'NET_BIND_SERVICE'.\\n- The root filesystem is set to be read-only.\\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\", \"- This is a Kubernetes Service manifest.\\n- The service is named 'shipping'.\\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The service is labeled with 'name: shipping'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\\n- It selects pods with the label 'name: shipping' to route traffic to.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'user' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'user' application running.\\n- The Deployment uses the Docker image 'weaveworksdemos/user:0.4.7'.\\n- Resource limits are set for the container: 300m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\\n- The container listens on port 80.\\n- An environment variable 'mongo' is set with the value 'user-db:27017'.\\n- Security context is configured to run the container as a non-root user with user ID 10001.\\n- The container has a read-only root filesystem and drops all capabilities except 'NET_BIND_SERVICE'.\\n- Liveness and readiness probes are configured to check the '/health' endpoint on port 80, with initial delays of 300 and 180 seconds, respectively.\\n- The Deployment is scheduled to run on nodes with the Linux operating system.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'user'.\\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The Service is labeled with 'name: user'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\\n- It uses a selector to target pods with the label 'name: user'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'user-db' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'user-db' pod running.\\n- The pods are labeled with 'name: user-db' for identification and selection.\\n- Each pod runs a single container using the image 'weaveworksdemos/user-db:0.3.0'.\\n- The container exposes port 27017, which is typically used by MongoDB.\\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\\n- The root filesystem of the container is set to be read-only for security purposes.\\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'user-db'.\\n- It is located in the 'sock-shop' namespace.\\n- The Service is configured to expose port 27017.\\n- It targets the same port (27017) on the pods it selects.\\n- The Service uses a selector to match pods with the label 'name: user-db'.\"], k8s_weakness_summary=\"Issue #0: Missing Port Configuration\\n  - details: The service does not specify the port it should serve on, which can lead to connectivity issues.\\n  - manifests having the issues: ['sock-shop-2/manifests/02-carts-svc.yaml', 'sock-shop-2/manifests/04-carts-db-svc.yaml', 'sock-shop-2/manifests/06-catalogue-svc.yaml', 'sock-shop-2/manifests/08-catalogue-db-svc.yaml', 'sock-shop-2/manifests/12-orders-svc.yaml', 'sock-shop-2/manifests/14-orders-db-svc.yaml', 'sock-shop-2/manifests/16-payment-svc.yaml', 'sock-shop-2/manifests/18-queue-master-svc.yaml', 'sock-shop-2/manifests/22-session-db-svc.yaml', 'sock-shop-2/manifests/24-shipping-svc.yaml', 'sock-shop-2/manifests/26-user-svc.yaml', 'sock-shop-2/manifests/28-user-db-svc.yaml']\\n  - problematic config: The 'ports' field in the Service spec is missing the 'port' configuration.\\n\\nIssue #1: Single Replica Deployment\\n  - details: Having a single replica for a deployment can lead to downtime if the pod fails.\\n  - manifests having the issues: ['sock-shop-2/manifests/09-front-end-dep.yaml']\\n  - problematic config: The 'replicas' field is set to 1.\\n\\nIssue #2: High Initial Delay for Liveness Probe\\n  - details: A high initial delay for the liveness probe can delay the detection of a non-responsive application.\\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/09-front-end-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\\n  - problematic config: The 'initialDelaySeconds' for the liveness probe is set to 300.\\n\\nIssue #3: High Initial Delay for Readiness Probe\\n  - details: A high initial delay for the readiness probe can delay the application from being marked as ready, affecting service availability.\\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\\n  - problematic config: The 'initialDelaySeconds' for the readiness probe is set to 180.\\n\\n\", k8s_app=K8sAppAssumption(thought=\"The manifests provided are part of a well-known microservices demo application called 'Sock Shop'. This application is designed to demonstrate the use of microservices architecture and Kubernetes orchestration. The file names, labels, and images used in the manifests (e.g., 'weaveworksdemos') are indicative of the Sock Shop application, which simulates an e-commerce website for selling socks. The application includes various services such as carts, catalogue, orders, payment, and user management, each with its own database and service components, reflecting a typical e-commerce platform's architecture.\", k8s_application='Sock Shop is an e-commerce application that simulates an online sock store. It offers users the ability to browse a catalogue of socks, add items to a cart, place orders, and manage user accounts. The application is composed of multiple microservices, each responsible for a specific function within the e-commerce workflow, such as handling orders, managing user sessions, and processing payments.'), ce_instructions='- The Chaos-Engineering experiment must be completed within 1 minute.\\n\\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\\n  1. http://front-end.sock-shop.svc.cluster.local/\\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\\n  4. http://front-end.sock-shop.svc.cluster.local/category/\\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html')>\n\n# You will inspect the following state of my system:\nCartsServiceEndpointsAvailable: The first issue to address is the 'Missing Port Configuration' in the Service manifests. This issue is likely to cause connectivity problems, making it a critical aspect to verify. Among the manifests with this issue, 'sock-shop-2/manifests/02-carts-svc.yaml' is selected as it is the first in the list. The steady state will ensure that the Service is functioning correctly by checking the number of endpoints available for the 'carts' service, which should match the number of replicas in the corresponding Deployment.\n\n# Please follow the instructions below regarding Chaos Engineering:\n- The Chaos-Engineering experiment must be completed within 1 minute.\n\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\n  1. http://front-end.sock-shop.svc.cluster.local/\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\n  4. http://front-end.sock-shop.svc.cluster.local/category/\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html\n\nPlease define the way to inspect \"CartsServiceEndpointsAvailable\" in the system defined by the above k8s manifest(s).\nAI: ```json\n{\"thought\":"
            ],
            "{\"thought\":\"To inspect the 'CartsServiceEndpointsAvailable' state, I need to verify the number of endpoints available for the 'carts' service in the 'sock-shop' namespace. This requires checking the endpoints associated with the 'carts' service and ensuring they match the number of replicas specified in the 'carts' deployment. The Kubernetes API is suitable for this task as it allows direct inspection of the service endpoints and deployment replicas.\",\"tool_type\":\"k8s\",\"tool\":{\"duration\":\"5s\",\"script\":\"import os\\nimport time\\nimport argparse\\nfrom kubernetes import client, config\\n\\n# Load Kubernetes configuration based on the environment\\nif os.getenv('KUBERNETES_SERVICE_HOST'):\\n    config.load_incluster_config()\\nelse:\\n    config.load_kube_config()\\n\\nv1 = client.CoreV1Api()\\napps_v1 = client.AppsV1Api()\\n\\nnamespace = 'sock-shop'\\nservice_name = 'carts'\\ndeployment_name = 'carts'\\n\\n# Function to get the number of endpoints\\ndef get_endpoints_count():\\n    endpoints = v1.read_namespaced_endpoints(service_name, namespace)\\n    return len(endpoints.subsets[0].addresses) if endpoints.subsets else 0\\n\\n# Function to get the number of replicas\\ndef get_replicas_count():\\n    deployment = apps_v1.read_namespaced_deployment(deployment_name, namespace)\\n    return deployment.status.replicas\\n\\n# Main function to check the state\\nif __name__ == '__main__':\\n    parser = argparse.ArgumentParser(description='Check Carts Service Endpoints Availability')\\n    parser.add_argument('--duration', type=int, default=5, help='Duration to check the state in seconds')\\n    args = parser.parse_args()\\n\\n    duration = args.duration\\n    for _ in range(duration):\\n        endpoints_count = get_endpoints_count()\\n        replicas_count = get_replicas_count()\\n        print(f'Endpoints available: {endpoints_count}, Expected replicas: {replicas_count}')\\n        time.sleep(1)\\n\\n    print('Check completed.')\"}}"
        ]
    },
    {
        "name": "threshold_definition",
        "token_usage": {
            "input_tokens": 12076,
            "output_tokens": 217,
            "total_tokens": 12293
        },
        "message_history": [
            [
                "System: You are a helpful AI assistant for Chaos Engineering. \nGiven k8s manifests for a network system, its steady state, and the current value of the steady state, you will define the threshold for the steady state.\nAlways keep the following rules:\n- The threshold must include reasonable tolerance that makes the threshold being more easiliy satisfied to account for some fluctuations.\n- The current value of the steady state must satisfy the threshold (including tolerance) as the currrent value is the normal state and the threshold represents whether the system remains normal.\n- If redundancy already exists in the resource, define at least the minimum required value as the threshold.\n- Explicitly specify all values related to the threshold, such as the number of resources that must be satisfied, the percentage of time it must be satisfied within the monitoring period, etc.\n- The output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"thought\": {\"title\": \"Thought\", \"description\": \"Write your thought process to determine the threshold of the steady state.\", \"type\": \"string\"}, \"threshold\": {\"title\": \"Threshold\", \"description\": \"the threshold of the steady state, which should be satisfied satisfied in the current state.\", \"type\": \"string\"}}, \"required\": [\"thought\", \"threshold\"]}\n```\nHuman: # Here is the overview of my system:\nThe system consists of the following K8s manifest(s):K8s manifest: sock-shop-2/manifests/00-sock-shop-ns.yaml\n```yaml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: sock-shop\n\n```\nSummary of sock-shop-2/manifests/00-sock-shop-ns.yaml:\n- This manifest defines a Kubernetes Namespace.\n- The Namespace is named 'sock-shop'.\n- Namespaces are used to organize and manage resources in a Kubernetes cluster.\n\nK8s manifest: sock-shop-2/manifests/01-carts-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts\n  template:\n    metadata:\n      labels:\n        name: carts\n    spec:\n      containers:\n      - name: carts\n        image: weaveworksdemos/carts:0.4.8\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/01-carts-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/carts:0.4.8'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 300m CPU and 500Mi memory, and a minimum of 100m CPU and 200Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities.\n- The root filesystem is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/02-carts-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: carts\n\n```\nSummary of sock-shop-2/manifests/02-carts-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The Service is named 'carts'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: carts'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: carts' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/03-carts-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts-db\n  template:\n    metadata:\n      labels:\n        name: carts-db\n    spec:\n      containers:\n      - name: carts-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/03-carts-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts-db' pod running.\n- The pods are selected based on the label 'name: carts-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add only CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/04-carts-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: carts-db\n\n```\nSummary of sock-shop-2/manifests/04-carts-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'carts-db'.\n- It is labeled with 'name: carts-db'.\n- The Service is created in the 'sock-shop' namespace.\n- It exposes port 27017 and directs traffic to the same port on the target pods.\n- The Service selects pods with the label 'name: carts-db' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/05-catalogue-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue\n  template:\n    metadata:\n      labels:\n        name: catalogue\n    spec:\n      containers:\n      - name: catalogue\n        image: weaveworksdemos/catalogue:0.3.5\n        command: [\"/app\"]\n        args:\n        - -port=80\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/05-catalogue-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/catalogue:0.3.5'.\n- The application runs with the command '/app' and listens on port 80.\n- Resource limits are set to 200m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container runs as a non-root user with user ID 10001 and has a read-only root filesystem.\n- Security settings drop all capabilities except 'NET_BIND_SERVICE'.\n- A liveness probe checks the '/health' endpoint on port 80, starting after 300 seconds and repeating every 3 seconds.\n- A readiness probe also checks the '/health' endpoint on port 80, starting after 180 seconds and repeating every 3 seconds.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/06-catalogue-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: catalogue\n\n```\nSummary of sock-shop-2/manifests/06-catalogue-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'catalogue'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: catalogue'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: catalogue'.\n\nK8s manifest: sock-shop-2/manifests/07-catalogue-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue-db\n  template:\n    metadata:\n      labels:\n        name: catalogue-db\n    spec:\n      containers:\n      - name: catalogue-db\n        image: weaveworksdemos/catalogue-db:0.3.0\n        env:\n          - name: MYSQL_ROOT_PASSWORD\n            value: fake_password\n          - name: MYSQL_DATABASE\n            value: socksdb\n        ports:\n        - name: mysql\n          containerPort: 3306\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/07-catalogue-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue-db' pod running.\n- The pods are selected based on the label 'name: catalogue-db'.\n- Each pod runs a single container using the image 'weaveworksdemos/catalogue-db:0.3.0'.\n- The container is configured with environment variables for 'MYSQL_ROOT_PASSWORD' and 'MYSQL_DATABASE'.\n- The container exposes port 3306, which is typically used for MySQL databases.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/08-catalogue-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 3306\n    targetPort: 3306\n  selector:\n    name: catalogue-db\n\n```\nSummary of sock-shop-2/manifests/08-catalogue-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'catalogue-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 3306.\n- It targets the same port (3306) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: catalogue-db'.\n- This setup is typically used to provide a stable endpoint for accessing a database running in the cluster.\n\nK8s manifest: sock-shop-2/manifests/09-front-end-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: front-end\n  namespace: sock-shop\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: front-end\n  template:\n    metadata:\n      labels:\n        name: front-end\n    spec:\n      containers:\n      - name: front-end\n        image: weaveworksdemos/front-end:0.3.12\n        resources:\n          limits:\n            cpu: 300m\n            memory: 1000Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 8079\n        env:\n        - name: SESSION_REDIS\n          value: \"true\"\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 30\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n```\nSummary of sock-shop-2/manifests/09-front-end-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'front-end' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 1 replica of the front-end application running.\n- The Deployment uses a selector to match pods with the label 'name: front-end'.\n- The pod template includes a single container named 'front-end'.\n- The container uses the image 'weaveworksdemos/front-end:0.3.12'.\n- Resource limits are set for the container: 300m CPU and 1000Mi memory.\n- Resource requests are set for the container: 100m CPU and 300Mi memory.\n- The container exposes port 8079.\n- An environment variable 'SESSION_REDIS' is set to 'true'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All Linux capabilities are dropped, and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/' path on port 8079, with an initial delay of 300 seconds and a period of 3 seconds.\n- A readiness probe is also configured to check the '/' path on port 8079, with an initial delay of 30 seconds and a period of 3 seconds.\n- The node selector ensures the pod runs on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/10-front-end-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: front-end\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: front-end\n  namespace: sock-shop\nspec:\n  type: NodePort\n  ports:\n  - port: 80\n    targetPort: 8079\n    nodePort: 30001\n  selector:\n    name: front-end\n\n```\nSummary of sock-shop-2/manifests/10-front-end-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'front-end'.\n- It is located in the 'sock-shop' namespace.\n- The Service type is 'NodePort', which exposes the service on each Node's IP at a static port.\n- It listens on port 80 and forwards traffic to target port 8079 on the pods.\n- The nodePort is set to 30001, which is the port on each node where the service can be accessed externally.\n- The Service is configured to be scraped by Prometheus for monitoring, as indicated by the annotation 'prometheus.io/scrape: true'.\n- It uses a selector to target pods with the label 'name: front-end'.\n\nK8s manifest: sock-shop-2/manifests/11-orders-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders\n  template:\n    metadata:\n      labels:\n        name: orders\n    spec:\n      containers:\n      - name: orders\n        image: weaveworksdemos/orders:0.4.7\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 500m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/11-orders-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/orders:0.4.7'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 500m CPU and 500Mi memory, and a minimum of 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities and a read-only root filesystem.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/12-orders-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: orders\n\n```\nSummary of sock-shop-2/manifests/12-orders-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: orders'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the target pods.\n- It uses a selector to match pods with the label 'name: orders'.\n\nK8s manifest: sock-shop-2/manifests/13-orders-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders-db\n  template:\n    metadata:\n      labels:\n        name: orders-db\n    spec:\n      containers:\n      - name: orders-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/13-orders-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders-db' pod running.\n- The pods are selected based on the label 'name: orders-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add specific ones like CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/14-orders-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: orders-db\n\n```\nSummary of sock-shop-2/manifests/14-orders-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods.\n- The Service selects pods with the label 'name: orders-db'.\n\nK8s manifest: sock-shop-2/manifests/15-payment-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: payment\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: payment\n  template:\n    metadata:\n      labels:\n        name: payment\n    spec:\n      containers:\n      - name: payment\n        image: weaveworksdemos/payment:0.4.3\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 99m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/15-payment-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'payment' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'payment' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/payment:0.4.3'.\n- Resource limits are set for the containers: 200m CPU and 200Mi memory.\n- Resource requests are set for the containers: 99m CPU and 100Mi memory.\n- The container exposes port 80.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All capabilities are dropped except 'NET_BIND_SERVICE', and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/health' endpoint on port 80, starting after 300 seconds and checking every 3 seconds.\n- A readiness probe is also configured to check the '/health' endpoint on port 80, starting after 180 seconds and checking every 3 seconds.\n- The Deployment is scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/16-payment-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: payment\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: payment\n\n```\nSummary of sock-shop-2/manifests/16-payment-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'payment'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: payment'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: payment'.\n\nK8s manifest: sock-shop-2/manifests/17-queue-master-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: queue-master\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: queue-master\n  template:\n    metadata:\n      labels:\n        name: queue-master\n    spec:\n      containers:\n      - name: queue-master\n        image: weaveworksdemos/queue-master:0.3.1\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/17-queue-master-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'queue-master' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'queue-master' pod running.\n- The pods are selected based on the label 'name: queue-master'.\n- Each pod runs a single container using the image 'weaveworksdemos/queue-master:0.3.1'.\n- The container is configured with specific Java options through environment variables.\n- Resource limits are set for the container, with a maximum of 300m CPU and 500Mi memory, and requests for 100m CPU and 300Mi memory.\n- The container exposes port 80.\n- The pods are scheduled on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/18-queue-master-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: queue-master\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: queue-master\n```\nSummary of sock-shop-2/manifests/18-queue-master-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'queue-master'.\n- It is annotated to enable Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: queue-master'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: queue-master' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/19-rabbitmq-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: rabbitmq\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: rabbitmq\n  template:\n    metadata:\n      labels:\n        name: rabbitmq\n      annotations:\n        prometheus.io/scrape: \"false\"\n    spec:\n      containers:\n      - name: rabbitmq\n        image: rabbitmq:3.6.8-management\n        ports:\n        - containerPort: 15672\n          name: management\n        - containerPort: 5672\n          name: rabbitmq\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n              - DAC_OVERRIDE\n          readOnlyRootFilesystem: true\n      - name: rabbitmq-exporter\n        image: kbudde/rabbitmq-exporter\n        ports:\n        - containerPort: 9090\n          name: exporter\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/19-rabbitmq-dep.yaml:\n- This manifest defines a Deployment for RabbitMQ in Kubernetes.\n- The Deployment is named 'rabbitmq' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas, meaning there will be 2 instances of RabbitMQ running.\n- The Deployment uses a label 'name: rabbitmq' to manage its pods.\n- The RabbitMQ container uses the image 'rabbitmq:3.6.8-management'.\n- It exposes two ports: 15672 for management and 5672 for RabbitMQ communication.\n- Security settings drop all capabilities but add CHOWN, SETGID, SETUID, and DAC_OVERRIDE, and the root filesystem is set to read-only.\n- An additional container, 'rabbitmq-exporter', is included for monitoring purposes, using the 'kbudde/rabbitmq-exporter' image and exposing port 9090.\n- The Deployment is configured to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/20-rabbitmq-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: rabbitmq\n  annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 5672\n    name: rabbitmq\n    targetPort: 5672\n  - port: 9090\n    name: exporter\n    targetPort: exporter\n    protocol: TCP\n  selector:\n    name: rabbitmq\n\n```\nSummary of sock-shop-2/manifests/20-rabbitmq-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'rabbitmq'.\n- It is annotated for Prometheus scraping on port 9090.\n- The Service is located in the 'sock-shop' namespace.\n- It exposes two ports: 5672 for RabbitMQ and 9090 for an exporter.\n- The Service uses TCP protocol for communication.\n- It selects pods with the label 'name: rabbitmq' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/21-session-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: session-db\n  template:\n    metadata:\n      labels:\n        name: session-db\n      annotations:\n        prometheus.io.scrape: \"false\"\n    spec:\n      containers:\n      - name: session-db\n        image: redis:alpine\n        ports:\n        - name: redis\n          containerPort: 6379\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/21-session-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'session-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'session-db' pod running.\n- The pods are selected based on the label 'name: session-db'.\n- Each pod runs a single container using the 'redis:alpine' image.\n- The container exposes port 6379, which is commonly used by Redis.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/22-session-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 6379\n    targetPort: 6379\n  selector:\n    name: session-db\n\n```\nSummary of sock-shop-2/manifests/22-session-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'session-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 6379.\n- It targets the same port (6379) on the selected pods.\n- The Service uses a selector to match pods with the label 'name: session-db'.\n\nK8s manifest: sock-shop-2/manifests/23-shipping-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: shipping\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: shipping\n  template:\n    metadata:\n      labels:\n        name: shipping\n    spec:\n      containers:\n      - name: shipping\n        image: weaveworksdemos/shipping:0.4.8\n        env:\n         - name: ZIPKIN\n           value: zipkin.jaeger.svc.cluster.local\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/23-shipping-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'shipping' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas of the 'shipping' application to be run.\n- The Deployment uses the Docker image 'weaveworksdemos/shipping:0.4.8'.\n- Environment variables are set for the application, including 'ZIPKIN' and 'JAVA_OPTS'.\n- Resource limits and requests are defined, with CPU limits at 300m and memory limits at 500Mi, and requests at 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with user ID 10001, and it drops all capabilities except 'NET_BIND_SERVICE'.\n- The root filesystem is set to be read-only.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/24-shipping-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: shipping\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: shipping\n\n\n```\nSummary of sock-shop-2/manifests/24-shipping-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'shipping'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: shipping'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: shipping' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/25-user-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user\n  template:\n    metadata:\n      labels:\n        name: user\n    spec:\n      containers:\n      - name: user\n        image: weaveworksdemos/user:0.4.7\n        resources:\n          limits:\n            cpu: 300m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        env:\n        - name: mongo\n          value: user-db:27017\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/25-user-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/user:0.4.7'.\n- Resource limits are set for the container: 300m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container listens on port 80.\n- An environment variable 'mongo' is set with the value 'user-db:27017'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- The container has a read-only root filesystem and drops all capabilities except 'NET_BIND_SERVICE'.\n- Liveness and readiness probes are configured to check the '/health' endpoint on port 80, with initial delays of 300 and 180 seconds, respectively.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/26-user-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: user\n\n\n```\nSummary of sock-shop-2/manifests/26-user-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: user'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It uses a selector to target pods with the label 'name: user'.\n\nK8s manifest: sock-shop-2/manifests/27-user-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user-db\n  template:\n    metadata:\n      labels:\n        name: user-db\n    spec:\n      containers:\n      - name: user-db\n        image: weaveworksdemos/user-db:0.3.0\n\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/27-user-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user-db' pod running.\n- The pods are labeled with 'name: user-db' for identification and selection.\n- Each pod runs a single container using the image 'weaveworksdemos/user-db:0.3.0'.\n- The container exposes port 27017, which is typically used by MongoDB.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/28-user-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: user-db\n\n\n```\nSummary of sock-shop-2/manifests/28-user-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: user-db'.\n\nThe resiliency issues/weaknesses in the system are as follows:\nIssue #0: Missing Port Configuration\n  - details: The service does not specify the port it should serve on, which can lead to connectivity issues.\n  - manifests having the issues: ['sock-shop-2/manifests/02-carts-svc.yaml', 'sock-shop-2/manifests/04-carts-db-svc.yaml', 'sock-shop-2/manifests/06-catalogue-svc.yaml', 'sock-shop-2/manifests/08-catalogue-db-svc.yaml', 'sock-shop-2/manifests/12-orders-svc.yaml', 'sock-shop-2/manifests/14-orders-db-svc.yaml', 'sock-shop-2/manifests/16-payment-svc.yaml', 'sock-shop-2/manifests/18-queue-master-svc.yaml', 'sock-shop-2/manifests/22-session-db-svc.yaml', 'sock-shop-2/manifests/24-shipping-svc.yaml', 'sock-shop-2/manifests/26-user-svc.yaml', 'sock-shop-2/manifests/28-user-db-svc.yaml']\n  - problematic config: The 'ports' field in the Service spec is missing the 'port' configuration.\n\nIssue #1: Single Replica Deployment\n  - details: Having a single replica for a deployment can lead to downtime if the pod fails.\n  - manifests having the issues: ['sock-shop-2/manifests/09-front-end-dep.yaml']\n  - problematic config: The 'replicas' field is set to 1.\n\nIssue #2: High Initial Delay for Liveness Probe\n  - details: A high initial delay for the liveness probe can delay the detection of a non-responsive application.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/09-front-end-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the liveness probe is set to 300.\n\nIssue #3: High Initial Delay for Readiness Probe\n  - details: A high initial delay for the readiness probe can delay the application from being marked as ready, affecting service availability.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the readiness probe is set to 180.\n\nThe expected type of application on the system (i.e., K8s manfests):\nSock Shop is an e-commerce application that simulates an online sock store. It offers users the ability to browse a catalogue of socks, add items to a cart, place orders, and manage user accounts. The application is composed of multiple microservices, each responsible for a specific function within the e-commerce workflow, such as handling orders, managing user sessions, and processing payments.; The manifests provided are part of a well-known microservices demo application called 'Sock Shop'. This application is designed to demonstrate the use of microservices architecture and Kubernetes orchestration. The file names, labels, and images used in the manifests (e.g., 'weaveworksdemos') are indicative of the Sock Shop application, which simulates an e-commerce website for selling socks. The application includes various services such as carts, catalogue, orders, payment, and user management, each with its own database and service components, reflecting a typical e-commerce platform's architecture.\n\n# You will determine a reasonable threshold for the following steady state of my system:\nCartsServiceEndpointsAvailable: The first issue to address is the 'Missing Port Configuration' in the Service manifests. This issue is likely to cause connectivity problems, making it a critical aspect to verify. Among the manifests with this issue, 'sock-shop-2/manifests/02-carts-svc.yaml' is selected as it is the first in the list. The steady state will ensure that the Service is functioning correctly by checking the number of endpoints available for the 'carts' service, which should match the number of replicas in the corresponding Deployment.\n\n# The Python code of k8s client libraries to inspect the current state of the steady state and its result are the following:\n## Script:\n```python\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\n\n# Load Kubernetes configuration based on the environment\nif os.getenv('KUBERNETES_SERVICE_HOST'):\n    config.load_incluster_config()\nelse:\n    config.load_kube_config()\n\nv1 = client.CoreV1Api()\napps_v1 = client.AppsV1Api()\n\nnamespace = 'sock-shop'\nservice_name = 'carts'\ndeployment_name = 'carts'\n\n# Function to get the number of endpoints\ndef get_endpoints_count():\n    endpoints = v1.read_namespaced_endpoints(service_name, namespace)\n    return len(endpoints.subsets[0].addresses) if endpoints.subsets else 0\n\n# Function to get the number of replicas\ndef get_replicas_count():\n    deployment = apps_v1.read_namespaced_deployment(deployment_name, namespace)\n    return deployment.status.replicas\n\n# Main function to check the state\nif __name__ == '__main__':\n    parser = argparse.ArgumentParser(description='Check Carts Service Endpoints Availability')\n    parser.add_argument('--duration', type=int, default=5, help='Duration to check the state in seconds')\n    args = parser.parse_args()\n\n    duration = args.duration\n    for _ in range(duration):\n        endpoints_count = get_endpoints_count()\n        replicas_count = get_replicas_count()\n        print(f'Endpoints available: {endpoints_count}, Expected replicas: {replicas_count}')\n        time.sleep(1)\n\n    print('Check completed.')\n```  \n## Result (current state):\nEndpoints available: 2, Expected replicas: 2\nEndpoints available: 2, Expected replicas: 2\nEndpoints available: 2, Expected replicas: 2\nEndpoints available: 2, Expected replicas: 2\nEndpoints available: 2, Expected replicas: 2\nCheck completed.\n\n\n# Please follow the instructions below regarding Chaos Engineering:\n- The Chaos-Engineering experiment must be completed within 1 minute.\n\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\n  1. http://front-end.sock-shop.svc.cluster.local/\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\n  4. http://front-end.sock-shop.svc.cluster.local/category/\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html\n\nNow, please define a reasonable threshold for the steady state according to the above information.\nAI: ```json\n{\"thought\":"
            ],
            "{\"thought\":\"The steady state to be verified is the availability of endpoints for the 'carts' service, which should match the number of replicas specified in the corresponding Deployment. The Deployment for 'carts' specifies 2 replicas, and the current state shows that there are 2 endpoints available consistently over a period of 5 seconds. This indicates that the system is currently in a healthy state. To account for potential fluctuations and ensure the system remains resilient, a reasonable threshold should allow for a small tolerance. Given the redundancy with 2 replicas, the threshold can be set to require at least 1 endpoint to be available at all times, but ideally, both should be available. Additionally, the threshold should specify that this condition must be met for at least 95% of the time during the 1-minute chaos experiment, allowing for brief disruptions without failing the steady state check.\",\"threshold\":\"At least 1 endpoint must be available for the 'carts' service 95% of the time during a 1-minute period, with a target of 2 endpoints available.\"}"
        ]
    },
    {
        "name": "unittest_writing",
        "token_usage": {
            "input_tokens": 3941,
            "output_tokens": 1240,
            "total_tokens": 5181
        },
        "message_history": [
            [
                "System: You are a helpful AI assistant for writing unit tests in Python.\nGiven the steady state, python script to inspect it, and its threshold, please write a Python unit test (including for-loop for certain duration) to verify if the steady state satisfies the threshold by adding assertion.\nAlways keep the following rules:\n- Include as many comments as possible in your code so that humans can easily understand what you did later.\n- Use the Kubernetes Python API.\n- If there is an explicitly defined values to be satisfied, hardcode that value and use it for threshold assertion.\n- Add argparse '--duration' (type=int) so that users can specify the loop duration as the previous python script.\n- NEVER use \"unittest\" module to use argparse.\n- Create a unit test by inheriting from the 'K8sAPIBase' class below (available via ```from unittest_base import K8sAPIBase```):\n```python\nimport os\nfrom kubernetes import client, config\n\nclass K8sAPIBase:\n    def __init__(self):\n        # Load Kubernetes configuration based on the environment\n        if os.getenv('KUBERNETES_SERVICE_HOST'):\n            config.load_incluster_config()\n        else:\n            config.load_kube_config()\n\n        # Create a Kubernetes API client\n        self.v1 = client.CoreV1Api()\n```\n- Add a entry point at the bottom to allow the test to be run from the command line, as follows:\n```\nif __name__ == '__main__':\n    main()\n```\n- The output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"thought\": {\"title\": \"Thought\", \"description\": \"Describe how you add the threshold assersion to the inspection Python script.\", \"type\": \"string\"}, \"code\": {\"title\": \"Code\", \"description\": \"Python unit test code. Implement a for loop that checks the status every second for the duration, and implement summary output at the end for both success and failure cases (i.e., print and assertion).\\n- Please add an entry point at the bottom to allow the test to be run from the command line.\\n- Please add argparse '--duration' (type=int) so that users can specify the loop duration. Write only the content of the code, and for dictionary values, enclose them within a pair of single double quotes (\\\").\", \"type\": \"string\"}}, \"required\": [\"thought\", \"code\"]}\n```\nHuman: The steady state:\nCartsServiceEndpointsAvailable: The first issue to address is the 'Missing Port Configuration' in the Service manifests. This issue is likely to cause connectivity problems, making it a critical aspect to verify. Among the manifests with this issue, 'sock-shop-2/manifests/02-carts-svc.yaml' is selected as it is the first in the list. The steady state will ensure that the Service is functioning correctly by checking the number of endpoints available for the 'carts' service, which should match the number of replicas in the corresponding Deployment.\n\nThe steady state was inspected with the following python code of k8s client libraries:\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\n\n# Load Kubernetes configuration based on the environment\nif os.getenv('KUBERNETES_SERVICE_HOST'):\n    config.load_incluster_config()\nelse:\n    config.load_kube_config()\n\nv1 = client.CoreV1Api()\napps_v1 = client.AppsV1Api()\n\nnamespace = 'sock-shop'\nservice_name = 'carts'\ndeployment_name = 'carts'\n\n# Function to get the number of endpoints\ndef get_endpoints_count():\n    endpoints = v1.read_namespaced_endpoints(service_name, namespace)\n    return len(endpoints.subsets[0].addresses) if endpoints.subsets else 0\n\n# Function to get the number of replicas\ndef get_replicas_count():\n    deployment = apps_v1.read_namespaced_deployment(deployment_name, namespace)\n    return deployment.status.replicas\n\n# Main function to check the state\nif __name__ == '__main__':\n    parser = argparse.ArgumentParser(description='Check Carts Service Endpoints Availability')\n    parser.add_argument('--duration', type=int, default=5, help='Duration to check the state in seconds')\n    args = parser.parse_args()\n\n    duration = args.duration\n    for _ in range(duration):\n        endpoints_count = get_endpoints_count()\n        replicas_count = get_replicas_count()\n        print(f'Endpoints available: {endpoints_count}, Expected replicas: {replicas_count}')\n        time.sleep(1)\n\n    print('Check completed.')\n\nThe threshold of the steady state: At least 1 endpoint must be available for the 'carts' service 95% of the time during a 1-minute period, with a target of 2 endpoints available.; The steady state to be verified is the availability of endpoints for the 'carts' service, which should match the number of replicas specified in the corresponding Deployment. The Deployment for 'carts' specifies 2 replicas, and the current state shows that there are 2 endpoints available consistently over a period of 5 seconds. This indicates that the system is currently in a healthy state. To account for potential fluctuations and ensure the system remains resilient, a reasonable threshold should allow for a small tolerance. Given the redundancy with 2 replicas, the threshold can be set to require at least 1 endpoint to be available at all times, but ideally, both should be available. Additionally, the threshold should specify that this condition must be met for at least 95% of the time during the 1-minute chaos experiment, allowing for brief disruptions without failing the steady state check.\n\nGiven the above steady state, command, and threshold, please write a Python unit test to check if the steady state satisfies the threshold.\nThe threshold in the unit test must exactly match the threshold defined above. Implement it to support variable durations. Use a representative value (e.g., percentage, ratio, etc.) for the threshold. NEVER use any fixed absolute values for the threshold.\nAI: ```json\n{\"thought\":"
            ],
            "{\"thought\": \"To verify the steady state of the 'carts' service, I will implement a unit test that checks the availability of endpoints against the number of replicas in the deployment. The test will run for a specified duration, checking every second, and will ensure that at least 1 endpoint is available 95% of the time. This will be done by counting the number of successful checks and comparing it to the total number of checks at the end of the duration. The threshold is set to require at least 1 endpoint to be available 95% of the time, with a target of 2 endpoints available.\", \"code\": \"import os\\nimport time\\nimport argparse\\nfrom kubernetes import client, config\\nfrom unittest_base import K8sAPIBase\\n\\nclass TestCartsServiceEndpoints(K8sAPIBase):\\n    def __init__(self):\\n        super().__init__()\\n        self.namespace = 'sock-shop'\\n        self.service_name = 'carts'\\n        self.deployment_name = 'carts'\\n\\n    def get_endpoints_count(self):\\n        endpoints = self.v1.read_namespaced_endpoints(self.service_name, self.namespace)\\n        return len(endpoints.subsets[0].addresses) if endpoints.subsets else 0\\n\\n    def get_replicas_count(self):\\n        deployment = self.v1.read_namespaced_deployment(self.deployment_name, self.namespace)\\n        return deployment.status.replicas\\n\\n    def test_endpoints_availability(self, duration):\\n        success_count = 0\\n        total_checks = duration\\n\\n        for _ in range(duration):\\n            endpoints_count = self.get_endpoints_count()\\n            replicas_count = self.get_replicas_count()\\n            print(f'Endpoints available: {endpoints_count}, Expected replicas: {replicas_count}')\\n\\n            # Check if at least 1 endpoint is available\\n            if endpoints_count >= 1:\\n                success_count += 1\\n\\n            time.sleep(1)\\n\\n        # Calculate the success rate\\n        success_rate = (success_count / total_checks) * 100\\n        print(f'Success rate: {success_rate}%')\\n\\n        # Assert that the success rate is at least 95%\\n        assert success_rate >= 95, f'Success rate {success_rate}% is below the threshold of 95%'\\n\\n\\ndef main():\\n    parser = argparse.ArgumentParser(description='Test Carts Service Endpoints Availability')\\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the state in seconds')\\n    args = parser.parse_args()\\n\\n    test = TestCartsServiceEndpoints()\\n    test.test_endpoints_availability(args.duration)\\n\\n\\nif __name__ == '__main__':\\n    main()\\n\"}",
            [
                "System: You are a helpful AI assistant for writing unit tests in Python.\nGiven the steady state, python script to inspect it, and its threshold, please write a Python unit test (including for-loop for certain duration) to verify if the steady state satisfies the threshold by adding assertion.\nAlways keep the following rules:\n- Include as many comments as possible in your code so that humans can easily understand what you did later.\n- Use the Kubernetes Python API.\n- If there is an explicitly defined values to be satisfied, hardcode that value and use it for threshold assertion.\n- Add argparse '--duration' (type=int) so that users can specify the loop duration as the previous python script.\n- NEVER use \"unittest\" module to use argparse.\n- Create a unit test by inheriting from the 'K8sAPIBase' class below (available via ```from unittest_base import K8sAPIBase```):\n```python\nimport os\nfrom kubernetes import client, config\n\nclass K8sAPIBase:\n    def __init__(self):\n        # Load Kubernetes configuration based on the environment\n        if os.getenv('KUBERNETES_SERVICE_HOST'):\n            config.load_incluster_config()\n        else:\n            config.load_kube_config()\n\n        # Create a Kubernetes API client\n        self.v1 = client.CoreV1Api()\n```\n- Add a entry point at the bottom to allow the test to be run from the command line, as follows:\n```\nif __name__ == '__main__':\n    main()\n```\n- The output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"thought\": {\"title\": \"Thought\", \"description\": \"Describe how you add the threshold assersion to the inspection Python script.\", \"type\": \"string\"}, \"code\": {\"title\": \"Code\", \"description\": \"Python unit test code. Implement a for loop that checks the status every second for the duration, and implement summary output at the end for both success and failure cases (i.e., print and assertion).\\n- Please add an entry point at the bottom to allow the test to be run from the command line.\\n- Please add argparse '--duration' (type=int) so that users can specify the loop duration. Write only the content of the code, and for dictionary values, enclose them within a pair of single double quotes (\\\").\", \"type\": \"string\"}}, \"required\": [\"thought\", \"code\"]}\n```\nHuman: The steady state:\nCartsServiceEndpointsAvailable: The first issue to address is the 'Missing Port Configuration' in the Service manifests. This issue is likely to cause connectivity problems, making it a critical aspect to verify. Among the manifests with this issue, 'sock-shop-2/manifests/02-carts-svc.yaml' is selected as it is the first in the list. The steady state will ensure that the Service is functioning correctly by checking the number of endpoints available for the 'carts' service, which should match the number of replicas in the corresponding Deployment.\n\nThe steady state was inspected with the following python code of k8s client libraries:\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\n\n# Load Kubernetes configuration based on the environment\nif os.getenv('KUBERNETES_SERVICE_HOST'):\n    config.load_incluster_config()\nelse:\n    config.load_kube_config()\n\nv1 = client.CoreV1Api()\napps_v1 = client.AppsV1Api()\n\nnamespace = 'sock-shop'\nservice_name = 'carts'\ndeployment_name = 'carts'\n\n# Function to get the number of endpoints\ndef get_endpoints_count():\n    endpoints = v1.read_namespaced_endpoints(service_name, namespace)\n    return len(endpoints.subsets[0].addresses) if endpoints.subsets else 0\n\n# Function to get the number of replicas\ndef get_replicas_count():\n    deployment = apps_v1.read_namespaced_deployment(deployment_name, namespace)\n    return deployment.status.replicas\n\n# Main function to check the state\nif __name__ == '__main__':\n    parser = argparse.ArgumentParser(description='Check Carts Service Endpoints Availability')\n    parser.add_argument('--duration', type=int, default=5, help='Duration to check the state in seconds')\n    args = parser.parse_args()\n\n    duration = args.duration\n    for _ in range(duration):\n        endpoints_count = get_endpoints_count()\n        replicas_count = get_replicas_count()\n        print(f'Endpoints available: {endpoints_count}, Expected replicas: {replicas_count}')\n        time.sleep(1)\n\n    print('Check completed.')\n\nThe threshold of the steady state: At least 1 endpoint must be available for the 'carts' service 95% of the time during a 1-minute period, with a target of 2 endpoints available.; The steady state to be verified is the availability of endpoints for the 'carts' service, which should match the number of replicas specified in the corresponding Deployment. The Deployment for 'carts' specifies 2 replicas, and the current state shows that there are 2 endpoints available consistently over a period of 5 seconds. This indicates that the system is currently in a healthy state. To account for potential fluctuations and ensure the system remains resilient, a reasonable threshold should allow for a small tolerance. Given the redundancy with 2 replicas, the threshold can be set to require at least 1 endpoint to be available at all times, but ideally, both should be available. Additionally, the threshold should specify that this condition must be met for at least 95% of the time during the 1-minute chaos experiment, allowing for brief disruptions without failing the steady state check.\n\nGiven the above steady state, command, and threshold, please write a Python unit test to check if the steady state satisfies the threshold.\nThe threshold in the unit test must exactly match the threshold defined above. Implement it to support variable durations. Use a representative value (e.g., percentage, ratio, etc.) for the threshold. NEVER use any fixed absolute values for the threshold.\nAI: {\"thought\": \"To verify the steady state of the 'carts' service, I will implement a unit test that checks the availability of endpoints against the number of replicas in the deployment. The test will run for a specified duration, checking every second, and will ensure that at least 1 endpoint is available 95% of the time. This will be done by counting the number of successful checks and comparing it to the total number of checks at the end of the duration. The threshold is set to require at least 1 endpoint to be available 95% of the time, with a target of 2 endpoints available.\", \"code\": \"import os\\nimport time\\nimport argparse\\nfrom kubernetes import client, config\\nfrom unittest_base import K8sAPIBase\\n\\nclass TestCartsServiceEndpoints(K8sAPIBase):\\n    def __init__(self):\\n        super().__init__()\\n        self.namespace = 'sock-shop'\\n        self.service_name = 'carts'\\n        self.deployment_name = 'carts'\\n\\n    def get_endpoints_count(self):\\n        endpoints = self.v1.read_namespaced_endpoints(self.service_name, self.namespace)\\n        return len(endpoints.subsets[0].addresses) if endpoints.subsets else 0\\n\\n    def get_replicas_count(self):\\n        deployment = self.v1.read_namespaced_deployment(self.deployment_name, self.namespace)\\n        return deployment.status.replicas\\n\\n    def test_endpoints_availability(self, duration):\\n        success_count = 0\\n        total_checks = duration\\n\\n        for _ in range(duration):\\n            endpoints_count = self.get_endpoints_count()\\n            replicas_count = self.get_replicas_count()\\n            print(f'Endpoints available: {endpoints_count}, Expected replicas: {replicas_count}')\\n\\n            # Check if at least 1 endpoint is available\\n            if endpoints_count >= 1:\\n                success_count += 1\\n\\n            time.sleep(1)\\n\\n        # Calculate the success rate\\n        success_rate = (success_count / total_checks) * 100\\n        print(f'Success rate: {success_rate}%')\\n\\n        # Assert that the success rate is at least 95%\\n        assert success_rate >= 95, f'Success rate {success_rate}% is below the threshold of 95%'\\n\\n\\ndef main():\\n    parser = argparse.ArgumentParser(description='Test Carts Service Endpoints Availability')\\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the state in seconds')\\n    args = parser.parse_args()\\n\\n    test = TestCartsServiceEndpoints()\\n    test.test_endpoints_availability(args.duration)\\n\\n\\nif __name__ == '__main__':\\n    main()\\n\"}\nHuman: Your current unittest cause errors when coducted.\nThe error message is as follows:\nTraceback (most recent call last):\n  File \"/chaos-eater/sandbox/cycle_20241127_030827/hypothesis/unittest_CartsServiceEndpointsAvailable_mod0.py\", line 55, in <module>\n    main()\n  File \"/chaos-eater/sandbox/cycle_20241127_030827/hypothesis/unittest_CartsServiceEndpointsAvailable_mod0.py\", line 51, in main\n    test.test_endpoints_availability(args.duration)\n  File \"/chaos-eater/sandbox/cycle_20241127_030827/hypothesis/unittest_CartsServiceEndpointsAvailable_mod0.py\", line 28, in test_endpoints_availability\n    replicas_count = self.get_replicas_count()\n  File \"/chaos-eater/sandbox/cycle_20241127_030827/hypothesis/unittest_CartsServiceEndpointsAvailable_mod0.py\", line 19, in get_replicas_count\n    deployment = self.v1.read_namespaced_deployment(self.deployment_name, self.namespace)\nAttributeError: 'CoreV1Api' object has no attribute 'read_namespaced_deployment'. Did you mean: 'read_namespaced_event'?\n\n\nPlease analyze the reason why the errors occur, then fix the errors.\nAlways keep the following rules:\n- Ensure that the implementation supports variable durations again.\n- NEVER repeat the same fixes that have been made in the past.\n- Fix only the parts related to the errors without changing the original content.\n- The output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"thought\": {\"title\": \"Thought\", \"description\": \"Describe how you add the threshold assersion to the inspection Python script.\", \"type\": \"string\"}, \"code\": {\"title\": \"Code\", \"description\": \"Python unit test code. Implement a for loop that checks the status every second for the duration, and implement summary output at the end for both success and failure cases (i.e., print and assertion).\\n- Please add an entry point at the bottom to allow the test to be run from the command line.\\n- Please add argparse '--duration' (type=int) so that users can specify the loop duration. Write only the content of the code, and for dictionary values, enclose them within a pair of single double quotes (\\\").\", \"type\": \"string\"}}, \"required\": [\"thought\", \"code\"]}\n```\nAI: ```json\n{\"thought\":"
            ],
            "{\"thought\": \"The error occurs because the `CoreV1Api` object does not have a method `read_namespaced_deployment`. This method belongs to the `AppsV1Api` class. To fix this, I will ensure that the `AppsV1Api` is used to read the deployment information. This will involve initializing the `AppsV1Api` in the `K8sAPIBase` class and using it in the `get_replicas_count` method. The rest of the logic remains unchanged, and the test will still check the availability of endpoints against the number of replicas for the specified duration.\", \"code\": \"import os\\nimport time\\nimport argparse\\nfrom kubernetes import client, config\\nfrom unittest_base import K8sAPIBase\\n\\nclass TestCartsServiceEndpoints(K8sAPIBase):\\n    def __init__(self):\\n        super().__init__()\\n        self.apps_v1 = client.AppsV1Api()  # Initialize AppsV1Api\\n        self.namespace = 'sock-shop'\\n        self.service_name = 'carts'\\n        self.deployment_name = 'carts'\\n\\n    def get_endpoints_count(self):\\n        endpoints = self.v1.read_namespaced_endpoints(self.service_name, self.namespace)\\n        return len(endpoints.subsets[0].addresses) if endpoints.subsets else 0\\n\\n    def get_replicas_count(self):\\n        deployment = self.apps_v1.read_namespaced_deployment(self.deployment_name, self.namespace)  # Use AppsV1Api\\n        return deployment.status.replicas\\n\\n    def test_endpoints_availability(self, duration):\\n        success_count = 0\\n        total_checks = duration\\n\\n        for _ in range(duration):\\n            endpoints_count = self.get_endpoints_count()\\n            replicas_count = self.get_replicas_count()\\n            print(f'Endpoints available: {endpoints_count}, Expected replicas: {replicas_count}')\\n\\n            # Check if at least 1 endpoint is available\\n            if endpoints_count >= 1:\\n                success_count += 1\\n\\n            time.sleep(1)\\n\\n        # Calculate the success rate\\n        success_rate = (success_count / total_checks) * 100\\n        print(f'Success rate: {success_rate}%')\\n\\n        # Assert that the success rate is at least 95%\\n        assert success_rate >= 95, f'Success rate {success_rate}% is below the threshold of 95%'\\n\\n\\ndef main():\\n    parser = argparse.ArgumentParser(description='Test Carts Service Endpoints Availability')\\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the state in seconds')\\n    args = parser.parse_args()\\n\\n    test = TestCartsServiceEndpoints()\\n    test.test_endpoints_availability(args.duration)\\n\\n\\nif __name__ == '__main__':\\n    main()\\n\"}"
        ]
    },
    {
        "name": "steady_state_draft",
        "token_usage": {
            "input_tokens": 12570,
            "output_tokens": 164,
            "total_tokens": 12734
        },
        "message_history": [
            [
                "System: You are a helpful AI assistant for Chaos Engineering.\nGiven K8s manifests for a system and user's instructions, you will define the system's steady states (i.e., normal behaviors) that are related to potential issues of the system.\nAlways keep the following rules:\n- Define steady states one by one, starting with the steady state related to the K8s resource that is easiest to encounter issues when certain failures occur.\n- Consider whether a new steady state needs to be added, and if so, add a steady state. If not, indicate the end of the steady-state addition with 'exits=True'.\n- Prioritize adding a steady state related to the issue that is easiest to occur to verify through Chaos Engineering whether it's truly a problem later.\n- An added steady state must be a measurable output, such as the number of pods, throughput, error rates, latency percentiles, etc.\n- An added steady state must be specific to a SINGLE K8s resource (i.e., manifest) having potential issues for resilency and redundancy.\n- An added steady state must be different from the already defined ones.\n- The output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"thought\": {\"title\": \"Thought\", \"description\": \"Describe your thought process of determing the steady state of a SINGLE K8s resource (i.e., manifest) that is easiest to encounter the issues. Describe also the details of the steady state itself.\", \"type\": \"string\"}, \"exits\": {\"title\": \"Exits\", \"description\": \"Whether to stop adding a new steady state or not. If you stop here, output 'true'. If you keep adding a new steady state, output 'false'.\", \"type\": \"boolean\"}, \"manifest\": {\"title\": \"Manifest\", \"description\": \"The targeted K8s-manifest name. Specify a SINGLE manifest.\", \"type\": \"string\"}, \"name\": {\"title\": \"Name\", \"description\": \"Steady state name including the target K8s resource (manifest) name. Please write it using a-z, A-Z, and 0-9.\", \"type\": \"string\"}}, \"required\": [\"thought\", \"exits\", \"manifest\", \"name\"]}\n```\nHuman: # Here is the overview of my system:\nThe system consists of the following K8s manifest(s):K8s manifest: sock-shop-2/manifests/00-sock-shop-ns.yaml\n```yaml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: sock-shop\n\n```\nSummary of sock-shop-2/manifests/00-sock-shop-ns.yaml:\n- This manifest defines a Kubernetes Namespace.\n- The Namespace is named 'sock-shop'.\n- Namespaces are used to organize and manage resources in a Kubernetes cluster.\n\nK8s manifest: sock-shop-2/manifests/01-carts-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts\n  template:\n    metadata:\n      labels:\n        name: carts\n    spec:\n      containers:\n      - name: carts\n        image: weaveworksdemos/carts:0.4.8\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/01-carts-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/carts:0.4.8'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 300m CPU and 500Mi memory, and a minimum of 100m CPU and 200Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities.\n- The root filesystem is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/02-carts-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: carts\n\n```\nSummary of sock-shop-2/manifests/02-carts-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The Service is named 'carts'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: carts'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: carts' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/03-carts-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts-db\n  template:\n    metadata:\n      labels:\n        name: carts-db\n    spec:\n      containers:\n      - name: carts-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/03-carts-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts-db' pod running.\n- The pods are selected based on the label 'name: carts-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add only CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/04-carts-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: carts-db\n\n```\nSummary of sock-shop-2/manifests/04-carts-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'carts-db'.\n- It is labeled with 'name: carts-db'.\n- The Service is created in the 'sock-shop' namespace.\n- It exposes port 27017 and directs traffic to the same port on the target pods.\n- The Service selects pods with the label 'name: carts-db' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/05-catalogue-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue\n  template:\n    metadata:\n      labels:\n        name: catalogue\n    spec:\n      containers:\n      - name: catalogue\n        image: weaveworksdemos/catalogue:0.3.5\n        command: [\"/app\"]\n        args:\n        - -port=80\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/05-catalogue-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/catalogue:0.3.5'.\n- The application runs with the command '/app' and listens on port 80.\n- Resource limits are set to 200m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container runs as a non-root user with user ID 10001 and has a read-only root filesystem.\n- Security settings drop all capabilities except 'NET_BIND_SERVICE'.\n- A liveness probe checks the '/health' endpoint on port 80, starting after 300 seconds and repeating every 3 seconds.\n- A readiness probe also checks the '/health' endpoint on port 80, starting after 180 seconds and repeating every 3 seconds.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/06-catalogue-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: catalogue\n\n```\nSummary of sock-shop-2/manifests/06-catalogue-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'catalogue'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: catalogue'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: catalogue'.\n\nK8s manifest: sock-shop-2/manifests/07-catalogue-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue-db\n  template:\n    metadata:\n      labels:\n        name: catalogue-db\n    spec:\n      containers:\n      - name: catalogue-db\n        image: weaveworksdemos/catalogue-db:0.3.0\n        env:\n          - name: MYSQL_ROOT_PASSWORD\n            value: fake_password\n          - name: MYSQL_DATABASE\n            value: socksdb\n        ports:\n        - name: mysql\n          containerPort: 3306\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/07-catalogue-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue-db' pod running.\n- The pods are selected based on the label 'name: catalogue-db'.\n- Each pod runs a single container using the image 'weaveworksdemos/catalogue-db:0.3.0'.\n- The container is configured with environment variables for 'MYSQL_ROOT_PASSWORD' and 'MYSQL_DATABASE'.\n- The container exposes port 3306, which is typically used for MySQL databases.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/08-catalogue-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 3306\n    targetPort: 3306\n  selector:\n    name: catalogue-db\n\n```\nSummary of sock-shop-2/manifests/08-catalogue-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'catalogue-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 3306.\n- It targets the same port (3306) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: catalogue-db'.\n- This setup is typically used to provide a stable endpoint for accessing a database running in the cluster.\n\nK8s manifest: sock-shop-2/manifests/09-front-end-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: front-end\n  namespace: sock-shop\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: front-end\n  template:\n    metadata:\n      labels:\n        name: front-end\n    spec:\n      containers:\n      - name: front-end\n        image: weaveworksdemos/front-end:0.3.12\n        resources:\n          limits:\n            cpu: 300m\n            memory: 1000Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 8079\n        env:\n        - name: SESSION_REDIS\n          value: \"true\"\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 30\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n```\nSummary of sock-shop-2/manifests/09-front-end-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'front-end' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 1 replica of the front-end application running.\n- The Deployment uses a selector to match pods with the label 'name: front-end'.\n- The pod template includes a single container named 'front-end'.\n- The container uses the image 'weaveworksdemos/front-end:0.3.12'.\n- Resource limits are set for the container: 300m CPU and 1000Mi memory.\n- Resource requests are set for the container: 100m CPU and 300Mi memory.\n- The container exposes port 8079.\n- An environment variable 'SESSION_REDIS' is set to 'true'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All Linux capabilities are dropped, and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/' path on port 8079, with an initial delay of 300 seconds and a period of 3 seconds.\n- A readiness probe is also configured to check the '/' path on port 8079, with an initial delay of 30 seconds and a period of 3 seconds.\n- The node selector ensures the pod runs on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/10-front-end-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: front-end\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: front-end\n  namespace: sock-shop\nspec:\n  type: NodePort\n  ports:\n  - port: 80\n    targetPort: 8079\n    nodePort: 30001\n  selector:\n    name: front-end\n\n```\nSummary of sock-shop-2/manifests/10-front-end-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'front-end'.\n- It is located in the 'sock-shop' namespace.\n- The Service type is 'NodePort', which exposes the service on each Node's IP at a static port.\n- It listens on port 80 and forwards traffic to target port 8079 on the pods.\n- The nodePort is set to 30001, which is the port on each node where the service can be accessed externally.\n- The Service is configured to be scraped by Prometheus for monitoring, as indicated by the annotation 'prometheus.io/scrape: true'.\n- It uses a selector to target pods with the label 'name: front-end'.\n\nK8s manifest: sock-shop-2/manifests/11-orders-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders\n  template:\n    metadata:\n      labels:\n        name: orders\n    spec:\n      containers:\n      - name: orders\n        image: weaveworksdemos/orders:0.4.7\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 500m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/11-orders-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/orders:0.4.7'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 500m CPU and 500Mi memory, and a minimum of 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities and a read-only root filesystem.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/12-orders-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: orders\n\n```\nSummary of sock-shop-2/manifests/12-orders-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: orders'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the target pods.\n- It uses a selector to match pods with the label 'name: orders'.\n\nK8s manifest: sock-shop-2/manifests/13-orders-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders-db\n  template:\n    metadata:\n      labels:\n        name: orders-db\n    spec:\n      containers:\n      - name: orders-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/13-orders-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders-db' pod running.\n- The pods are selected based on the label 'name: orders-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add specific ones like CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/14-orders-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: orders-db\n\n```\nSummary of sock-shop-2/manifests/14-orders-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods.\n- The Service selects pods with the label 'name: orders-db'.\n\nK8s manifest: sock-shop-2/manifests/15-payment-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: payment\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: payment\n  template:\n    metadata:\n      labels:\n        name: payment\n    spec:\n      containers:\n      - name: payment\n        image: weaveworksdemos/payment:0.4.3\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 99m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/15-payment-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'payment' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'payment' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/payment:0.4.3'.\n- Resource limits are set for the containers: 200m CPU and 200Mi memory.\n- Resource requests are set for the containers: 99m CPU and 100Mi memory.\n- The container exposes port 80.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All capabilities are dropped except 'NET_BIND_SERVICE', and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/health' endpoint on port 80, starting after 300 seconds and checking every 3 seconds.\n- A readiness probe is also configured to check the '/health' endpoint on port 80, starting after 180 seconds and checking every 3 seconds.\n- The Deployment is scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/16-payment-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: payment\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: payment\n\n```\nSummary of sock-shop-2/manifests/16-payment-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'payment'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: payment'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: payment'.\n\nK8s manifest: sock-shop-2/manifests/17-queue-master-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: queue-master\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: queue-master\n  template:\n    metadata:\n      labels:\n        name: queue-master\n    spec:\n      containers:\n      - name: queue-master\n        image: weaveworksdemos/queue-master:0.3.1\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/17-queue-master-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'queue-master' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'queue-master' pod running.\n- The pods are selected based on the label 'name: queue-master'.\n- Each pod runs a single container using the image 'weaveworksdemos/queue-master:0.3.1'.\n- The container is configured with specific Java options through environment variables.\n- Resource limits are set for the container, with a maximum of 300m CPU and 500Mi memory, and requests for 100m CPU and 300Mi memory.\n- The container exposes port 80.\n- The pods are scheduled on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/18-queue-master-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: queue-master\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: queue-master\n```\nSummary of sock-shop-2/manifests/18-queue-master-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'queue-master'.\n- It is annotated to enable Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: queue-master'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: queue-master' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/19-rabbitmq-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: rabbitmq\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: rabbitmq\n  template:\n    metadata:\n      labels:\n        name: rabbitmq\n      annotations:\n        prometheus.io/scrape: \"false\"\n    spec:\n      containers:\n      - name: rabbitmq\n        image: rabbitmq:3.6.8-management\n        ports:\n        - containerPort: 15672\n          name: management\n        - containerPort: 5672\n          name: rabbitmq\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n              - DAC_OVERRIDE\n          readOnlyRootFilesystem: true\n      - name: rabbitmq-exporter\n        image: kbudde/rabbitmq-exporter\n        ports:\n        - containerPort: 9090\n          name: exporter\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/19-rabbitmq-dep.yaml:\n- This manifest defines a Deployment for RabbitMQ in Kubernetes.\n- The Deployment is named 'rabbitmq' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas, meaning there will be 2 instances of RabbitMQ running.\n- The Deployment uses a label 'name: rabbitmq' to manage its pods.\n- The RabbitMQ container uses the image 'rabbitmq:3.6.8-management'.\n- It exposes two ports: 15672 for management and 5672 for RabbitMQ communication.\n- Security settings drop all capabilities but add CHOWN, SETGID, SETUID, and DAC_OVERRIDE, and the root filesystem is set to read-only.\n- An additional container, 'rabbitmq-exporter', is included for monitoring purposes, using the 'kbudde/rabbitmq-exporter' image and exposing port 9090.\n- The Deployment is configured to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/20-rabbitmq-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: rabbitmq\n  annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 5672\n    name: rabbitmq\n    targetPort: 5672\n  - port: 9090\n    name: exporter\n    targetPort: exporter\n    protocol: TCP\n  selector:\n    name: rabbitmq\n\n```\nSummary of sock-shop-2/manifests/20-rabbitmq-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'rabbitmq'.\n- It is annotated for Prometheus scraping on port 9090.\n- The Service is located in the 'sock-shop' namespace.\n- It exposes two ports: 5672 for RabbitMQ and 9090 for an exporter.\n- The Service uses TCP protocol for communication.\n- It selects pods with the label 'name: rabbitmq' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/21-session-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: session-db\n  template:\n    metadata:\n      labels:\n        name: session-db\n      annotations:\n        prometheus.io.scrape: \"false\"\n    spec:\n      containers:\n      - name: session-db\n        image: redis:alpine\n        ports:\n        - name: redis\n          containerPort: 6379\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/21-session-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'session-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'session-db' pod running.\n- The pods are selected based on the label 'name: session-db'.\n- Each pod runs a single container using the 'redis:alpine' image.\n- The container exposes port 6379, which is commonly used by Redis.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/22-session-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 6379\n    targetPort: 6379\n  selector:\n    name: session-db\n\n```\nSummary of sock-shop-2/manifests/22-session-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'session-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 6379.\n- It targets the same port (6379) on the selected pods.\n- The Service uses a selector to match pods with the label 'name: session-db'.\n\nK8s manifest: sock-shop-2/manifests/23-shipping-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: shipping\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: shipping\n  template:\n    metadata:\n      labels:\n        name: shipping\n    spec:\n      containers:\n      - name: shipping\n        image: weaveworksdemos/shipping:0.4.8\n        env:\n         - name: ZIPKIN\n           value: zipkin.jaeger.svc.cluster.local\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/23-shipping-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'shipping' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas of the 'shipping' application to be run.\n- The Deployment uses the Docker image 'weaveworksdemos/shipping:0.4.8'.\n- Environment variables are set for the application, including 'ZIPKIN' and 'JAVA_OPTS'.\n- Resource limits and requests are defined, with CPU limits at 300m and memory limits at 500Mi, and requests at 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with user ID 10001, and it drops all capabilities except 'NET_BIND_SERVICE'.\n- The root filesystem is set to be read-only.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/24-shipping-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: shipping\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: shipping\n\n\n```\nSummary of sock-shop-2/manifests/24-shipping-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'shipping'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: shipping'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: shipping' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/25-user-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user\n  template:\n    metadata:\n      labels:\n        name: user\n    spec:\n      containers:\n      - name: user\n        image: weaveworksdemos/user:0.4.7\n        resources:\n          limits:\n            cpu: 300m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        env:\n        - name: mongo\n          value: user-db:27017\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/25-user-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/user:0.4.7'.\n- Resource limits are set for the container: 300m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container listens on port 80.\n- An environment variable 'mongo' is set with the value 'user-db:27017'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- The container has a read-only root filesystem and drops all capabilities except 'NET_BIND_SERVICE'.\n- Liveness and readiness probes are configured to check the '/health' endpoint on port 80, with initial delays of 300 and 180 seconds, respectively.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/26-user-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: user\n\n\n```\nSummary of sock-shop-2/manifests/26-user-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: user'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It uses a selector to target pods with the label 'name: user'.\n\nK8s manifest: sock-shop-2/manifests/27-user-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user-db\n  template:\n    metadata:\n      labels:\n        name: user-db\n    spec:\n      containers:\n      - name: user-db\n        image: weaveworksdemos/user-db:0.3.0\n\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/27-user-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user-db' pod running.\n- The pods are labeled with 'name: user-db' for identification and selection.\n- Each pod runs a single container using the image 'weaveworksdemos/user-db:0.3.0'.\n- The container exposes port 27017, which is typically used by MongoDB.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/28-user-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: user-db\n\n\n```\nSummary of sock-shop-2/manifests/28-user-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: user-db'.\n\nThe resiliency issues/weaknesses in the system are as follows:\nIssue #0: Missing Port Configuration\n  - details: The service does not specify the port it should serve on, which can lead to connectivity issues.\n  - manifests having the issues: ['sock-shop-2/manifests/02-carts-svc.yaml', 'sock-shop-2/manifests/04-carts-db-svc.yaml', 'sock-shop-2/manifests/06-catalogue-svc.yaml', 'sock-shop-2/manifests/08-catalogue-db-svc.yaml', 'sock-shop-2/manifests/12-orders-svc.yaml', 'sock-shop-2/manifests/14-orders-db-svc.yaml', 'sock-shop-2/manifests/16-payment-svc.yaml', 'sock-shop-2/manifests/18-queue-master-svc.yaml', 'sock-shop-2/manifests/22-session-db-svc.yaml', 'sock-shop-2/manifests/24-shipping-svc.yaml', 'sock-shop-2/manifests/26-user-svc.yaml', 'sock-shop-2/manifests/28-user-db-svc.yaml']\n  - problematic config: The 'ports' field in the Service spec is missing the 'port' configuration.\n\nIssue #1: Single Replica Deployment\n  - details: Having a single replica for a deployment can lead to downtime if the pod fails.\n  - manifests having the issues: ['sock-shop-2/manifests/09-front-end-dep.yaml']\n  - problematic config: The 'replicas' field is set to 1.\n\nIssue #2: High Initial Delay for Liveness Probe\n  - details: A high initial delay for the liveness probe can delay the detection of a non-responsive application.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/09-front-end-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the liveness probe is set to 300.\n\nIssue #3: High Initial Delay for Readiness Probe\n  - details: A high initial delay for the readiness probe can delay the application from being marked as ready, affecting service availability.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the readiness probe is set to 180.\n\nThe expected type of application on the system (i.e., K8s manfests):\nSock Shop is an e-commerce application that simulates an online sock store. It offers users the ability to browse a catalogue of socks, add items to a cart, place orders, and manage user accounts. The application is composed of multiple microservices, each responsible for a specific function within the e-commerce workflow, such as handling orders, managing user sessions, and processing payments.; The manifests provided are part of a well-known microservices demo application called 'Sock Shop'. This application is designed to demonstrate the use of microservices architecture and Kubernetes orchestration. The file names, labels, and images used in the manifests (e.g., 'weaveworksdemos') are indicative of the Sock Shop application, which simulates an e-commerce website for selling socks. The application includes various services such as carts, catalogue, orders, payment, and user management, each with its own database and service components, reflecting a typical e-commerce platform's architecture.\n\n# Please follow the instructions below regarding Chaos Engineering:\n- The Chaos-Engineering experiment must be completed within 1 minute.\n\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\n  1. http://front-end.sock-shop.svc.cluster.local/\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\n  4. http://front-end.sock-shop.svc.cluster.local/category/\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html\n\n# Steady states already defined are the following:\n1 steady states are defined.\n1st steady states:\n- Name: CartsServiceEndpointsAvailable\n- Description: The first issue to address is the 'Missing Port Configuration' in the Service manifests. This issue is likely to cause connectivity problems, making it a critical aspect to verify. Among the manifests with this issue, 'sock-shop-2/manifests/02-carts-svc.yaml' is selected as it is the first in the list. The steady state will ensure that the Service is functioning correctly by checking the number of endpoints available for the 'carts' service, which should match the number of replicas in the corresponding Deployment.\n- Threshold for the steady state: At least 1 endpoint must be available for the 'carts' service 95% of the time during a 1-minute period, with a target of 2 endpoints available.; The steady state to be verified is the availability of endpoints for the 'carts' service, which should match the number of replicas specified in the corresponding Deployment. The Deployment for 'carts' specifies 2 replicas, and the current state shows that there are 2 endpoints available consistently over a period of 5 seconds. This indicates that the system is currently in a healthy state. To account for potential fluctuations and ensure the system remains resilient, a reasonable threshold should allow for a small tolerance. Given the redundancy with 2 replicas, the threshold can be set to require at least 1 endpoint to be available at all times, but ideally, both should be available. Additionally, the threshold should specify that this condition must be met for at least 95% of the time during the 1-minute chaos experiment, allowing for brief disruptions without failing the steady state check.\n- Whether the steady state meets the threshold is determined by the following Python script with K8s API:\n```\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\nfrom unittest_base import K8sAPIBase\n\nclass TestCartsServiceEndpoints(K8sAPIBase):\n    def __init__(self):\n        super().__init__()\n        self.apps_v1 = client.AppsV1Api()  # Initialize AppsV1Api\n        self.namespace = 'sock-shop'\n        self.service_name = 'carts'\n        self.deployment_name = 'carts'\n\n    def get_endpoints_count(self):\n        endpoints = self.v1.read_namespaced_endpoints(self.service_name, self.namespace)\n        return len(endpoints.subsets[0].addresses) if endpoints.subsets else 0\n\n    def get_replicas_count(self):\n        deployment = self.apps_v1.read_namespaced_deployment(self.deployment_name, self.namespace)  # Use AppsV1Api\n        return deployment.status.replicas\n\n    def test_endpoints_availability(self, duration):\n        success_count = 0\n        total_checks = duration\n\n        for _ in range(duration):\n            endpoints_count = self.get_endpoints_count()\n            replicas_count = self.get_replicas_count()\n            print(f'Endpoints available: {endpoints_count}, Expected replicas: {replicas_count}')\n\n            # Check if at least 1 endpoint is available\n            if endpoints_count >= 1:\n                success_count += 1\n\n            time.sleep(1)\n\n        # Calculate the success rate\n        success_rate = (success_count / total_checks) * 100\n        print(f'Success rate: {success_rate}%')\n\n        # Assert that the success rate is at least 95%\n        assert success_rate >= 95, f'Success rate {success_rate}% is below the threshold of 95%'\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Test Carts Service Endpoints Availability')\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the state in seconds')\n    args = parser.parse_args()\n\n    test = TestCartsServiceEndpoints()\n    test.test_endpoints_availability(args.duration)\n\n\nif __name__ == '__main__':\n    main()\n\n```\n\nAfter considering whether a new steady state needs to be added, define a steady state that are different from the already defined steady states, if necessary.\nAI: ```json\n{\"thought\":"
            ],
            "{\"thought\":\"The next issue to address is the 'Single Replica Deployment' in the 'sock-shop-2/manifests/09-front-end-dep.yaml'. This issue is critical because having only one replica can lead to downtime if the pod fails. To ensure the system's resilience, we need to verify that the single replica of the 'front-end' deployment is always available. The steady state will check the availability of the 'front-end' pod by ensuring that the liveness probe is successful 95% of the time during a 1-minute period. This will help us confirm that the single replica is stable and responsive, even though it lacks redundancy.\",\"exits\":false,\"manifest\":\"sock-shop-2/manifests/09-front-end-dep.yaml\",\"name\":\"FrontEndLivenessProbeSuccess\"}\n"
        ]
    },
    {
        "name": "tool_command_writing",
        "token_usage": {
            "input_tokens": 22098,
            "output_tokens": 542,
            "total_tokens": 22640
        },
        "message_history": [
            [
                "System: You are a helpful AI assistant for Chaos Engineering.\nGiven Kubernetes (K8s) manifests for a network system and its state type, you will inspect the current value of the state type.\nAlways keep the following rules:\n- You can use either K8s API (Python) or k6 (Javascript) to inspect the state.\n- Use the K8s API for checking the current state of K8s resources\n- Use k6 for checking communication statuses/metrics, such as request sending, response time, latency, etc.\n- If you use K8s API, consider appropriate test duration. If you use k6, consider not only appropriate test duration but also an appropriate number of virtual users in the load test.\n- Pay attention to namespace specification. If the namespace is specified in the manifest, it is deployed with the namespace. If not, it is deployed with the 'default' namespace.\n- When sending requests to a K8s resources, use their internal DNS names in the format: ```service-name.namespace.svc.cluster.local:port```. For the port setting, use the service port, not the targetPort or nodePort. Ensure that the port matches the service port defined in the manifest.\n- If other request formats are provided by the user, follow the user's format.\n- The output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"thought\": {\"title\": \"Thought\", \"description\": \"Describe your thoughts for the tool usage. e.g., the reason why you choose the tool and how to use.\", \"type\": \"string\"}, \"tool_type\": {\"title\": \"Tool Type\", \"description\": \"Tool to inspect the steady state. Select from ['k8s', 'k6'].\", \"enum\": [\"k8s\", \"k6\"], \"type\": \"string\"}, \"tool\": {\"title\": \"Tool\", \"description\": \"If tool_tyepe='k8s', write here K8sAPI. If tool_tyepe='k6', write here K6JS.\", \"anyOf\": [{\"$ref\": \"#/definitions/K8sAPI\"}, {\"$ref\": \"#/definitions/K6JS\"}]}}, \"required\": [\"thought\", \"tool_type\", \"tool\"], \"definitions\": {\"K8sAPI\": {\"title\": \"K8sAPI\", \"type\": \"object\", \"properties\": {\"duration\": {\"title\": \"Duration\", \"description\": \"Duration of the status check every second in a for loop. Set appropriate duration to check the current state of the system. The maximum duration is 5s.\", \"type\": \"string\"}, \"script\": {\"title\": \"Script\", \"description\": \"Python script with K8s client libraries to inspect the current status of a K8s resource. Write only the content of the code, and for dictionary values, enclose them within a pair of single double quotes (\\\"). Implement a for loop that checks the status every second for the duration, and print a summary of the results at the end.\\n- To support docker env, please configure the client as follows: ```\\n# Load Kubernetes configuration based on the environment\\n    if os.getenv('KUBERNETES_SERVICE_HOST'):\\n        config.load_incluster_config()\\n    else:\\n        config.load_kube_config()\\n```\\n- Please add a Add a entry point at the bottom to allow the test to be run from the command line.\\n- Please add argparse '--duration' (type=int) so that users can specify the loop duration.\", \"type\": \"string\"}}, \"required\": [\"duration\", \"script\"]}, \"K6JS\": {\"title\": \"K6JS\", \"type\": \"object\", \"properties\": {\"vus\": {\"title\": \"Vus\", \"description\": \"The number of virtual users. You can run a load test with the number of virutal users.\", \"type\": \"integer\"}, \"duration\": {\"title\": \"Duration\", \"description\": \"Duration of the load test. Set appropriate duration to check the current state of the system. The maximum duration is 5s.\", \"type\": \"string\"}, \"script\": {\"title\": \"Script\", \"description\": \"k6 javascript to inspect the current state. Write only the content of the code, and for dictionary values, enclose them within a pair of single double quotes (\\\"). In options in the javascript, set the same 'vus' and 'duration' options as the above. The interval of status check must be 1s second(s). Set a threshold that triggers an error when a request failure is clearly occurring.\", \"type\": \"string\"}}, \"required\": [\"vus\", \"duration\", \"script\"]}}}\n```\nHuman: # Here is the overview of my system:\n<bound method ProcessedData.to_k8s_overview_str of ProcessedData(work_dir='sandbox/cycle_20241127_030827/inputs', input=ChaosEaterInput(skaffold_yaml=File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/skaffold.yaml', content='apiVersion: skaffold/v3\\nkind: Config\\nmetadata:\\n  name: sock-shop-app\\nmanifests:\\n  rawYaml:\\n    - manifests/00-sock-shop-ns.yaml\\n    - manifests/01-carts-dep.yaml\\n    - manifests/02-carts-svc.yaml\\n    - manifests/03-carts-db-dep.yaml\\n    - manifests/04-carts-db-svc.yaml\\n    - manifests/05-catalogue-dep.yaml\\n    - manifests/06-catalogue-svc.yaml\\n    - manifests/07-catalogue-db-dep.yaml\\n    - manifests/08-catalogue-db-svc.yaml\\n    - manifests/09-front-end-dep.yaml\\n    - manifests/10-front-end-svc.yaml\\n    - manifests/11-orders-dep.yaml\\n    - manifests/12-orders-svc.yaml\\n    - manifests/13-orders-db-dep.yaml\\n    - manifests/14-orders-db-svc.yaml\\n    - manifests/15-payment-dep.yaml\\n    - manifests/16-payment-svc.yaml\\n    - manifests/17-queue-master-dep.yaml\\n    - manifests/18-queue-master-svc.yaml\\n    - manifests/19-rabbitmq-dep.yaml\\n    - manifests/20-rabbitmq-svc.yaml\\n    - manifests/21-session-db-dep.yaml\\n    - manifests/22-session-db-svc.yaml\\n    - manifests/23-shipping-dep.yaml\\n    - manifests/24-shipping-svc.yaml\\n    - manifests/25-user-dep.yaml\\n    - manifests/26-user-svc.yaml\\n    - manifests/27-user-db-dep.yaml\\n    - manifests/28-user-db-svc.yaml', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/skaffold.yaml'), files=[File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/21-session-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: session-db\\n  labels:\\n    name: session-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: session-db\\n  template:\\n    metadata:\\n      labels:\\n        name: session-db\\n      annotations:\\n        prometheus.io.scrape: \"false\"\\n    spec:\\n      containers:\\n      - name: session-db\\n        image: redis:alpine\\n        ports:\\n        - name: redis\\n          containerPort: 6379\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/21-session-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/23-shipping-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: shipping\\n  labels:\\n    name: shipping\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: shipping\\n  template:\\n    metadata:\\n      labels:\\n        name: shipping\\n    spec:\\n      containers:\\n      - name: shipping\\n        image: weaveworksdemos/shipping:0.4.8\\n        env:\\n         - name: ZIPKIN\\n           value: zipkin.jaeger.svc.cluster.local\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/23-shipping-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/18-queue-master-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: queue-master\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: queue-master\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: queue-master\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/18-queue-master-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/04-carts-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: carts-db\\n  labels:\\n    name: carts-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 27017\\n    targetPort: 27017\\n  selector:\\n    name: carts-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/04-carts-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/05-catalogue-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: catalogue\\n  labels:\\n    name: catalogue\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: catalogue\\n  template:\\n    metadata:\\n      labels:\\n        name: catalogue\\n    spec:\\n      containers:\\n      - name: catalogue\\n        image: weaveworksdemos/catalogue:0.3.5\\n        command: [\"/app\"]\\n        args:\\n        - -port=80\\n        resources:\\n          limits:\\n            cpu: 200m\\n            memory: 200Mi\\n          requests:\\n            cpu: 100m\\n            memory: 100Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 180\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/05-catalogue-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/25-user-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: user\\n  labels:\\n    name: user\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: user\\n  template:\\n    metadata:\\n      labels:\\n        name: user\\n    spec:\\n      containers:\\n      - name: user\\n        image: weaveworksdemos/user:0.4.7\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 200Mi\\n          requests:\\n            cpu: 100m\\n            memory: 100Mi\\n        ports:\\n        - containerPort: 80\\n        env:\\n        - name: mongo\\n          value: user-db:27017\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 180\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/25-user-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/12-orders-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: orders\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: orders\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: orders\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/12-orders-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/09-front-end-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: front-end\\n  namespace: sock-shop\\nspec:\\n  replicas: 1\\n  selector:\\n    matchLabels:\\n      name: front-end\\n  template:\\n    metadata:\\n      labels:\\n        name: front-end\\n    spec:\\n      containers:\\n      - name: front-end\\n        image: weaveworksdemos/front-end:0.3.12\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 1000Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 8079\\n        env:\\n        - name: SESSION_REDIS\\n          value: \"true\"\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /\\n            port: 8079\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /\\n            port: 8079\\n          initialDelaySeconds: 30\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/09-front-end-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/19-rabbitmq-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: rabbitmq\\n  labels:\\n    name: rabbitmq\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: rabbitmq\\n  template:\\n    metadata:\\n      labels:\\n        name: rabbitmq\\n      annotations:\\n        prometheus.io/scrape: \"false\"\\n    spec:\\n      containers:\\n      - name: rabbitmq\\n        image: rabbitmq:3.6.8-management\\n        ports:\\n        - containerPort: 15672\\n          name: management\\n        - containerPort: 5672\\n          name: rabbitmq\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n              - DAC_OVERRIDE\\n          readOnlyRootFilesystem: true\\n      - name: rabbitmq-exporter\\n        image: kbudde/rabbitmq-exporter\\n        ports:\\n        - containerPort: 9090\\n          name: exporter\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/19-rabbitmq-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/13-orders-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: orders-db\\n  labels:\\n    name: orders-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: orders-db\\n  template:\\n    metadata:\\n      labels:\\n        name: orders-db\\n    spec:\\n      containers:\\n      - name: orders-db\\n        image: mongo\\n        ports:\\n        - name: mongo\\n          containerPort: 27017\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/13-orders-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/06-catalogue-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: catalogue\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: catalogue\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: catalogue\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/06-catalogue-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/07-catalogue-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: catalogue-db\\n  labels:\\n    name: catalogue-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: catalogue-db\\n  template:\\n    metadata:\\n      labels:\\n        name: catalogue-db\\n    spec:\\n      containers:\\n      - name: catalogue-db\\n        image: weaveworksdemos/catalogue-db:0.3.0\\n        env:\\n          - name: MYSQL_ROOT_PASSWORD\\n            value: fake_password\\n          - name: MYSQL_DATABASE\\n            value: socksdb\\n        ports:\\n        - name: mysql\\n          containerPort: 3306\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/07-catalogue-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/24-shipping-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: shipping\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: shipping\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: shipping\\n\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/24-shipping-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/02-carts-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: carts\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: carts\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: carts\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/02-carts-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/22-session-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: session-db\\n  labels:\\n    name: session-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 6379\\n    targetPort: 6379\\n  selector:\\n    name: session-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/22-session-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/01-carts-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: carts\\n  labels:\\n    name: carts\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: carts\\n  template:\\n    metadata:\\n      labels:\\n        name: carts\\n    spec:\\n      containers:\\n      - name: carts\\n        image: weaveworksdemos/carts:0.4.8\\n        env:\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 200Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/01-carts-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/28-user-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: user-db\\n  labels:\\n    name: user-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 27017\\n    targetPort: 27017\\n  selector:\\n    name: user-db\\n\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/28-user-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/15-payment-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: payment\\n  labels:\\n    name: payment\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: payment\\n  template:\\n    metadata:\\n      labels:\\n        name: payment\\n    spec:\\n      containers:\\n      - name: payment\\n        image: weaveworksdemos/payment:0.4.3\\n        resources:\\n          limits:\\n            cpu: 200m\\n            memory: 200Mi\\n          requests:\\n            cpu: 99m\\n            memory: 100Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 180\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/15-payment-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/10-front-end-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: front-end\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: front-end\\n  namespace: sock-shop\\nspec:\\n  type: NodePort\\n  ports:\\n  - port: 80\\n    targetPort: 8079\\n    nodePort: 30001\\n  selector:\\n    name: front-end\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/10-front-end-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/03-carts-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: carts-db\\n  labels:\\n    name: carts-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: carts-db\\n  template:\\n    metadata:\\n      labels:\\n        name: carts-db\\n    spec:\\n      containers:\\n      - name: carts-db\\n        image: mongo\\n        ports:\\n        - name: mongo\\n          containerPort: 27017\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/03-carts-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/17-queue-master-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: queue-master\\n  labels:\\n    name: queue-master\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: queue-master\\n  template:\\n    metadata:\\n      labels:\\n        name: queue-master\\n    spec:\\n      containers:\\n      - name: queue-master\\n        image: weaveworksdemos/queue-master:0.3.1\\n        env:\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 80\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/17-queue-master-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/27-user-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: user-db\\n  labels:\\n    name: user-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: user-db\\n  template:\\n    metadata:\\n      labels:\\n        name: user-db\\n    spec:\\n      containers:\\n      - name: user-db\\n        image: weaveworksdemos/user-db:0.3.0\\n\\n        ports:\\n        - name: mongo\\n          containerPort: 27017\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/27-user-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/26-user-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: user\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: user\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: user\\n\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/26-user-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/16-payment-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: payment\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: payment\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: payment\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/16-payment-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/20-rabbitmq-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: rabbitmq\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n        prometheus.io/port: '9090'\\n  labels:\\n    name: rabbitmq\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 5672\\n    name: rabbitmq\\n    targetPort: 5672\\n  - port: 9090\\n    name: exporter\\n    targetPort: exporter\\n    protocol: TCP\\n  selector:\\n    name: rabbitmq\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/20-rabbitmq-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/00-sock-shop-ns.yaml', content='apiVersion: v1\\nkind: Namespace\\nmetadata:\\n  name: sock-shop\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/00-sock-shop-ns.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/11-orders-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: orders\\n  labels:\\n    name: orders\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: orders\\n  template:\\n    metadata:\\n      labels:\\n        name: orders\\n    spec:\\n      containers:\\n      - name: orders\\n        image: weaveworksdemos/orders:0.4.7\\n        env:\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 500m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/11-orders-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/08-catalogue-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: catalogue-db\\n  labels:\\n    name: catalogue-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 3306\\n    targetPort: 3306\\n  selector:\\n    name: catalogue-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/08-catalogue-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/14-orders-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: orders-db\\n  labels:\\n    name: orders-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 27017\\n    targetPort: 27017\\n  selector:\\n    name: orders-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/14-orders-db-svc.yaml')], ce_instructions='- The Chaos-Engineering experiment must be completed within 1 minute.\\n\\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\\n  1. http://front-end.sock-shop.svc.cluster.local/\\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\\n  4. http://front-end.sock-shop.svc.cluster.local/category/\\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html'), k8s_yamls=[File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/00-sock-shop-ns.yaml', content='apiVersion: v1\\nkind: Namespace\\nmetadata:\\n  name: sock-shop\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/00-sock-shop-ns.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/01-carts-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: carts\\n  labels:\\n    name: carts\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: carts\\n  template:\\n    metadata:\\n      labels:\\n        name: carts\\n    spec:\\n      containers:\\n      - name: carts\\n        image: weaveworksdemos/carts:0.4.8\\n        env:\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 200Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/01-carts-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/02-carts-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: carts\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: carts\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: carts\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/02-carts-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/03-carts-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: carts-db\\n  labels:\\n    name: carts-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: carts-db\\n  template:\\n    metadata:\\n      labels:\\n        name: carts-db\\n    spec:\\n      containers:\\n      - name: carts-db\\n        image: mongo\\n        ports:\\n        - name: mongo\\n          containerPort: 27017\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/03-carts-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/04-carts-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: carts-db\\n  labels:\\n    name: carts-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 27017\\n    targetPort: 27017\\n  selector:\\n    name: carts-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/04-carts-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/05-catalogue-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: catalogue\\n  labels:\\n    name: catalogue\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: catalogue\\n  template:\\n    metadata:\\n      labels:\\n        name: catalogue\\n    spec:\\n      containers:\\n      - name: catalogue\\n        image: weaveworksdemos/catalogue:0.3.5\\n        command: [\"/app\"]\\n        args:\\n        - -port=80\\n        resources:\\n          limits:\\n            cpu: 200m\\n            memory: 200Mi\\n          requests:\\n            cpu: 100m\\n            memory: 100Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 180\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/05-catalogue-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/06-catalogue-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: catalogue\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: catalogue\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: catalogue\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/06-catalogue-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/07-catalogue-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: catalogue-db\\n  labels:\\n    name: catalogue-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: catalogue-db\\n  template:\\n    metadata:\\n      labels:\\n        name: catalogue-db\\n    spec:\\n      containers:\\n      - name: catalogue-db\\n        image: weaveworksdemos/catalogue-db:0.3.0\\n        env:\\n          - name: MYSQL_ROOT_PASSWORD\\n            value: fake_password\\n          - name: MYSQL_DATABASE\\n            value: socksdb\\n        ports:\\n        - name: mysql\\n          containerPort: 3306\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/07-catalogue-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/08-catalogue-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: catalogue-db\\n  labels:\\n    name: catalogue-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 3306\\n    targetPort: 3306\\n  selector:\\n    name: catalogue-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/08-catalogue-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/09-front-end-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: front-end\\n  namespace: sock-shop\\nspec:\\n  replicas: 1\\n  selector:\\n    matchLabels:\\n      name: front-end\\n  template:\\n    metadata:\\n      labels:\\n        name: front-end\\n    spec:\\n      containers:\\n      - name: front-end\\n        image: weaveworksdemos/front-end:0.3.12\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 1000Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 8079\\n        env:\\n        - name: SESSION_REDIS\\n          value: \"true\"\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /\\n            port: 8079\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /\\n            port: 8079\\n          initialDelaySeconds: 30\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/09-front-end-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/10-front-end-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: front-end\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: front-end\\n  namespace: sock-shop\\nspec:\\n  type: NodePort\\n  ports:\\n  - port: 80\\n    targetPort: 8079\\n    nodePort: 30001\\n  selector:\\n    name: front-end\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/10-front-end-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/11-orders-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: orders\\n  labels:\\n    name: orders\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: orders\\n  template:\\n    metadata:\\n      labels:\\n        name: orders\\n    spec:\\n      containers:\\n      - name: orders\\n        image: weaveworksdemos/orders:0.4.7\\n        env:\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 500m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/11-orders-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/12-orders-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: orders\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: orders\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: orders\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/12-orders-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/13-orders-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: orders-db\\n  labels:\\n    name: orders-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: orders-db\\n  template:\\n    metadata:\\n      labels:\\n        name: orders-db\\n    spec:\\n      containers:\\n      - name: orders-db\\n        image: mongo\\n        ports:\\n        - name: mongo\\n          containerPort: 27017\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/13-orders-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/14-orders-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: orders-db\\n  labels:\\n    name: orders-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 27017\\n    targetPort: 27017\\n  selector:\\n    name: orders-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/14-orders-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/15-payment-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: payment\\n  labels:\\n    name: payment\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: payment\\n  template:\\n    metadata:\\n      labels:\\n        name: payment\\n    spec:\\n      containers:\\n      - name: payment\\n        image: weaveworksdemos/payment:0.4.3\\n        resources:\\n          limits:\\n            cpu: 200m\\n            memory: 200Mi\\n          requests:\\n            cpu: 99m\\n            memory: 100Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 180\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/15-payment-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/16-payment-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: payment\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: payment\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: payment\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/16-payment-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/17-queue-master-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: queue-master\\n  labels:\\n    name: queue-master\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: queue-master\\n  template:\\n    metadata:\\n      labels:\\n        name: queue-master\\n    spec:\\n      containers:\\n      - name: queue-master\\n        image: weaveworksdemos/queue-master:0.3.1\\n        env:\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 80\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/17-queue-master-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/18-queue-master-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: queue-master\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: queue-master\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: queue-master\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/18-queue-master-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/19-rabbitmq-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: rabbitmq\\n  labels:\\n    name: rabbitmq\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: rabbitmq\\n  template:\\n    metadata:\\n      labels:\\n        name: rabbitmq\\n      annotations:\\n        prometheus.io/scrape: \"false\"\\n    spec:\\n      containers:\\n      - name: rabbitmq\\n        image: rabbitmq:3.6.8-management\\n        ports:\\n        - containerPort: 15672\\n          name: management\\n        - containerPort: 5672\\n          name: rabbitmq\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n              - DAC_OVERRIDE\\n          readOnlyRootFilesystem: true\\n      - name: rabbitmq-exporter\\n        image: kbudde/rabbitmq-exporter\\n        ports:\\n        - containerPort: 9090\\n          name: exporter\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/19-rabbitmq-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/20-rabbitmq-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: rabbitmq\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n        prometheus.io/port: '9090'\\n  labels:\\n    name: rabbitmq\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 5672\\n    name: rabbitmq\\n    targetPort: 5672\\n  - port: 9090\\n    name: exporter\\n    targetPort: exporter\\n    protocol: TCP\\n  selector:\\n    name: rabbitmq\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/20-rabbitmq-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/21-session-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: session-db\\n  labels:\\n    name: session-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: session-db\\n  template:\\n    metadata:\\n      labels:\\n        name: session-db\\n      annotations:\\n        prometheus.io.scrape: \"false\"\\n    spec:\\n      containers:\\n      - name: session-db\\n        image: redis:alpine\\n        ports:\\n        - name: redis\\n          containerPort: 6379\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/21-session-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/22-session-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: session-db\\n  labels:\\n    name: session-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 6379\\n    targetPort: 6379\\n  selector:\\n    name: session-db\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/22-session-db-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/23-shipping-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: shipping\\n  labels:\\n    name: shipping\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: shipping\\n  template:\\n    metadata:\\n      labels:\\n        name: shipping\\n    spec:\\n      containers:\\n      - name: shipping\\n        image: weaveworksdemos/shipping:0.4.8\\n        env:\\n         - name: ZIPKIN\\n           value: zipkin.jaeger.svc.cluster.local\\n         - name: JAVA_OPTS\\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 500Mi\\n          requests:\\n            cpu: 100m\\n            memory: 300Mi\\n        ports:\\n        - containerPort: 80\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/23-shipping-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/24-shipping-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: shipping\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: shipping\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: shipping\\n\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/24-shipping-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/25-user-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: user\\n  labels:\\n    name: user\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: user\\n  template:\\n    metadata:\\n      labels:\\n        name: user\\n    spec:\\n      containers:\\n      - name: user\\n        image: weaveworksdemos/user:0.4.7\\n        resources:\\n          limits:\\n            cpu: 300m\\n            memory: 200Mi\\n          requests:\\n            cpu: 100m\\n            memory: 100Mi\\n        ports:\\n        - containerPort: 80\\n        env:\\n        - name: mongo\\n          value: user-db:27017\\n        securityContext:\\n          runAsNonRoot: true\\n          runAsUser: 10001\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - NET_BIND_SERVICE\\n          readOnlyRootFilesystem: true\\n        livenessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 300\\n          periodSeconds: 3\\n        readinessProbe:\\n          httpGet:\\n            path: /health\\n            port: 80\\n          initialDelaySeconds: 180\\n          periodSeconds: 3\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/25-user-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/26-user-svc.yaml', content=\"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: user\\n  annotations:\\n        prometheus.io/scrape: 'true'\\n  labels:\\n    name: user\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 80\\n    targetPort: 80\\n  selector:\\n    name: user\\n\\n\", work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/26-user-svc.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/27-user-db-dep.yaml', content='apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: user-db\\n  labels:\\n    name: user-db\\n  namespace: sock-shop\\nspec:\\n  replicas: 2\\n  selector:\\n    matchLabels:\\n      name: user-db\\n  template:\\n    metadata:\\n      labels:\\n        name: user-db\\n    spec:\\n      containers:\\n      - name: user-db\\n        image: weaveworksdemos/user-db:0.3.0\\n\\n        ports:\\n        - name: mongo\\n          containerPort: 27017\\n        securityContext:\\n          capabilities:\\n            drop:\\n              - all\\n            add:\\n              - CHOWN\\n              - SETGID\\n              - SETUID\\n          readOnlyRootFilesystem: true\\n        volumeMounts:\\n        - mountPath: /tmp\\n          name: tmp-volume\\n      volumes:\\n        - name: tmp-volume\\n          emptyDir:\\n            medium: Memory\\n      nodeSelector:\\n        beta.kubernetes.io/os: linux\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/27-user-db-dep.yaml'), File(path='sandbox/cycle_20241127_030827/inputs/sock-shop-2/manifests/28-user-db-svc.yaml', content='apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: user-db\\n  labels:\\n    name: user-db\\n  namespace: sock-shop\\nspec:\\n  ports:\\n    # the port that this service should serve on\\n  - port: 27017\\n    targetPort: 27017\\n  selector:\\n    name: user-db\\n\\n', work_dir='sandbox/cycle_20241127_030827/inputs', fname='sock-shop-2/manifests/28-user-db-svc.yaml')], k8s_summaries=[\"- This manifest defines a Kubernetes Namespace.\\n- The Namespace is named 'sock-shop'.\\n- Namespaces are used to organize and manage resources in a Kubernetes cluster.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'carts' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'carts' application running.\\n- The Deployment uses the Docker image 'weaveworksdemos/carts:0.4.8'.\\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\\n- Resource limits and requests are defined, with a maximum of 300m CPU and 500Mi memory, and a minimum of 100m CPU and 200Mi memory.\\n- The application listens on port 80 within the container.\\n- Security context is configured to run the container as a non-root user with specific capabilities.\\n- The root filesystem is set to be read-only for security purposes.\\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\\n- The Deployment is scheduled to run on nodes with the Linux operating system.\", \"- This is a Kubernetes Service manifest.\\n- The Service is named 'carts'.\\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The Service is labeled with 'name: carts'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\\n- It selects pods with the label 'name: carts' to route traffic to.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'carts-db' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'carts-db' pod running.\\n- The pods are selected based on the label 'name: carts-db'.\\n- Each pod runs a single container using the 'mongo' image.\\n- The container exposes port 27017, which is the default port for MongoDB.\\n- Security settings are applied to drop all capabilities and add only CHOWN, SETGID, and SETUID.\\n- The root filesystem of the container is set to read-only for security purposes.\\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'carts-db'.\\n- It is labeled with 'name: carts-db'.\\n- The Service is created in the 'sock-shop' namespace.\\n- It exposes port 27017 and directs traffic to the same port on the target pods.\\n- The Service selects pods with the label 'name: carts-db' to route traffic to.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'catalogue' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'catalogue' application running.\\n- The Deployment uses the Docker image 'weaveworksdemos/catalogue:0.3.5'.\\n- The application runs with the command '/app' and listens on port 80.\\n- Resource limits are set to 200m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\\n- The container runs as a non-root user with user ID 10001 and has a read-only root filesystem.\\n- Security settings drop all capabilities except 'NET_BIND_SERVICE'.\\n- A liveness probe checks the '/health' endpoint on port 80, starting after 300 seconds and repeating every 3 seconds.\\n- A readiness probe also checks the '/health' endpoint on port 80, starting after 180 seconds and repeating every 3 seconds.\\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\", \"- This is a Kubernetes Service manifest.\\n- The service is named 'catalogue'.\\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The service is labeled with 'name: catalogue'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\\n- It selects pods with the label 'name: catalogue'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'catalogue-db' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'catalogue-db' pod running.\\n- The pods are selected based on the label 'name: catalogue-db'.\\n- Each pod runs a single container using the image 'weaveworksdemos/catalogue-db:0.3.0'.\\n- The container is configured with environment variables for 'MYSQL_ROOT_PASSWORD' and 'MYSQL_DATABASE'.\\n- The container exposes port 3306, which is typically used for MySQL databases.\\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'catalogue-db'.\\n- It is located in the 'sock-shop' namespace.\\n- The Service is configured to expose port 3306.\\n- It targets the same port (3306) on the pods it selects.\\n- The Service uses a selector to match pods with the label 'name: catalogue-db'.\\n- This setup is typically used to provide a stable endpoint for accessing a database running in the cluster.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'front-end' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 1 replica of the front-end application running.\\n- The Deployment uses a selector to match pods with the label 'name: front-end'.\\n- The pod template includes a single container named 'front-end'.\\n- The container uses the image 'weaveworksdemos/front-end:0.3.12'.\\n- Resource limits are set for the container: 300m CPU and 1000Mi memory.\\n- Resource requests are set for the container: 100m CPU and 300Mi memory.\\n- The container exposes port 8079.\\n- An environment variable 'SESSION_REDIS' is set to 'true'.\\n- Security context is configured to run the container as a non-root user with user ID 10001.\\n- All Linux capabilities are dropped, and the root filesystem is set to read-only.\\n- A liveness probe is configured to check the '/' path on port 8079, with an initial delay of 300 seconds and a period of 3 seconds.\\n- A readiness probe is also configured to check the '/' path on port 8079, with an initial delay of 30 seconds and a period of 3 seconds.\\n- The node selector ensures the pod runs on nodes with the operating system labeled as Linux.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'front-end'.\\n- It is located in the 'sock-shop' namespace.\\n- The Service type is 'NodePort', which exposes the service on each Node's IP at a static port.\\n- It listens on port 80 and forwards traffic to target port 8079 on the pods.\\n- The nodePort is set to 30001, which is the port on each node where the service can be accessed externally.\\n- The Service is configured to be scraped by Prometheus for monitoring, as indicated by the annotation 'prometheus.io/scrape: true'.\\n- It uses a selector to target pods with the label 'name: front-end'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'orders' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'orders' application running.\\n- The Deployment uses the Docker image 'weaveworksdemos/orders:0.4.7'.\\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\\n- Resource limits and requests are defined, with a maximum of 500m CPU and 500Mi memory, and a minimum of 100m CPU and 300Mi memory.\\n- The application listens on port 80 within the container.\\n- Security context is configured to run the container as a non-root user with specific capabilities and a read-only root filesystem.\\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\\n- The Deployment is scheduled to run on nodes with the Linux operating system.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'orders'.\\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The Service is labeled with 'name: orders'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The Service exposes port 80 and directs traffic to the same port on the target pods.\\n- It uses a selector to match pods with the label 'name: orders'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'orders-db' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'orders-db' pod running.\\n- The pods are selected based on the label 'name: orders-db'.\\n- Each pod runs a single container using the 'mongo' image.\\n- The container exposes port 27017, which is the default port for MongoDB.\\n- Security settings are applied to drop all capabilities and add specific ones like CHOWN, SETGID, and SETUID.\\n- The root filesystem of the container is set to be read-only for security purposes.\\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'orders-db'.\\n- It is located in the 'sock-shop' namespace.\\n- The Service is configured to expose port 27017.\\n- It targets the same port (27017) on the pods.\\n- The Service selects pods with the label 'name: orders-db'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'payment' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'payment' application running.\\n- The Deployment uses the Docker image 'weaveworksdemos/payment:0.4.3'.\\n- Resource limits are set for the containers: 200m CPU and 200Mi memory.\\n- Resource requests are set for the containers: 99m CPU and 100Mi memory.\\n- The container exposes port 80.\\n- Security context is configured to run the container as a non-root user with user ID 10001.\\n- All capabilities are dropped except 'NET_BIND_SERVICE', and the root filesystem is set to read-only.\\n- A liveness probe is configured to check the '/health' endpoint on port 80, starting after 300 seconds and checking every 3 seconds.\\n- A readiness probe is also configured to check the '/health' endpoint on port 80, starting after 180 seconds and checking every 3 seconds.\\n- The Deployment is scheduled to run on nodes with the operating system labeled as Linux.\", \"- This is a Kubernetes Service manifest.\\n- The service is named 'payment'.\\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The service is labeled with 'name: payment'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\\n- It selects pods with the label 'name: payment'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'queue-master' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'queue-master' pod running.\\n- The pods are selected based on the label 'name: queue-master'.\\n- Each pod runs a single container using the image 'weaveworksdemos/queue-master:0.3.1'.\\n- The container is configured with specific Java options through environment variables.\\n- Resource limits are set for the container, with a maximum of 300m CPU and 500Mi memory, and requests for 100m CPU and 300Mi memory.\\n- The container exposes port 80.\\n- The pods are scheduled on nodes with the operating system labeled as 'linux'.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'queue-master'.\\n- It is annotated to enable Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The Service is labeled with 'name: queue-master'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\\n- It selects pods with the label 'name: queue-master' to route traffic to.\", \"- This manifest defines a Deployment for RabbitMQ in Kubernetes.\\n- The Deployment is named 'rabbitmq' and is located in the 'sock-shop' namespace.\\n- It specifies 2 replicas, meaning there will be 2 instances of RabbitMQ running.\\n- The Deployment uses a label 'name: rabbitmq' to manage its pods.\\n- The RabbitMQ container uses the image 'rabbitmq:3.6.8-management'.\\n- It exposes two ports: 15672 for management and 5672 for RabbitMQ communication.\\n- Security settings drop all capabilities but add CHOWN, SETGID, SETUID, and DAC_OVERRIDE, and the root filesystem is set to read-only.\\n- An additional container, 'rabbitmq-exporter', is included for monitoring purposes, using the 'kbudde/rabbitmq-exporter' image and exposing port 9090.\\n- The Deployment is configured to run on nodes with the Linux operating system.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'rabbitmq'.\\n- It is annotated for Prometheus scraping on port 9090.\\n- The Service is located in the 'sock-shop' namespace.\\n- It exposes two ports: 5672 for RabbitMQ and 9090 for an exporter.\\n- The Service uses TCP protocol for communication.\\n- It selects pods with the label 'name: rabbitmq' to route traffic to.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'session-db' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'session-db' pod running.\\n- The pods are selected based on the label 'name: session-db'.\\n- Each pod runs a single container using the 'redis:alpine' image.\\n- The container exposes port 6379, which is commonly used by Redis.\\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\\n- The root filesystem of the container is set to be read-only for security purposes.\\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'session-db'.\\n- It is located in the 'sock-shop' namespace.\\n- The Service is configured to expose port 6379.\\n- It targets the same port (6379) on the selected pods.\\n- The Service uses a selector to match pods with the label 'name: session-db'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'shipping' and is located in the 'sock-shop' namespace.\\n- It specifies 2 replicas of the 'shipping' application to be run.\\n- The Deployment uses the Docker image 'weaveworksdemos/shipping:0.4.8'.\\n- Environment variables are set for the application, including 'ZIPKIN' and 'JAVA_OPTS'.\\n- Resource limits and requests are defined, with CPU limits at 300m and memory limits at 500Mi, and requests at 100m CPU and 300Mi memory.\\n- The application listens on port 80 within the container.\\n- Security context is configured to run the container as a non-root user with user ID 10001, and it drops all capabilities except 'NET_BIND_SERVICE'.\\n- The root filesystem is set to be read-only.\\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\", \"- This is a Kubernetes Service manifest.\\n- The service is named 'shipping'.\\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The service is labeled with 'name: shipping'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\\n- It selects pods with the label 'name: shipping' to route traffic to.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'user' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'user' application running.\\n- The Deployment uses the Docker image 'weaveworksdemos/user:0.4.7'.\\n- Resource limits are set for the container: 300m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\\n- The container listens on port 80.\\n- An environment variable 'mongo' is set with the value 'user-db:27017'.\\n- Security context is configured to run the container as a non-root user with user ID 10001.\\n- The container has a read-only root filesystem and drops all capabilities except 'NET_BIND_SERVICE'.\\n- Liveness and readiness probes are configured to check the '/health' endpoint on port 80, with initial delays of 300 and 180 seconds, respectively.\\n- The Deployment is scheduled to run on nodes with the Linux operating system.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'user'.\\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\\n- The Service is labeled with 'name: user'.\\n- It is deployed in the 'sock-shop' namespace.\\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\\n- It uses a selector to target pods with the label 'name: user'.\", \"- This manifest defines a Deployment in Kubernetes.\\n- The Deployment is named 'user-db' and is located in the 'sock-shop' namespace.\\n- It specifies that there should be 2 replicas of the 'user-db' pod running.\\n- The pods are labeled with 'name: user-db' for identification and selection.\\n- Each pod runs a single container using the image 'weaveworksdemos/user-db:0.3.0'.\\n- The container exposes port 27017, which is typically used by MongoDB.\\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\\n- The root filesystem of the container is set to be read-only for security purposes.\\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\", \"- This manifest defines a Kubernetes Service.\\n- The Service is named 'user-db'.\\n- It is located in the 'sock-shop' namespace.\\n- The Service is configured to expose port 27017.\\n- It targets the same port (27017) on the pods it selects.\\n- The Service uses a selector to match pods with the label 'name: user-db'.\"], k8s_weakness_summary=\"Issue #0: Missing Port Configuration\\n  - details: The service does not specify the port it should serve on, which can lead to connectivity issues.\\n  - manifests having the issues: ['sock-shop-2/manifests/02-carts-svc.yaml', 'sock-shop-2/manifests/04-carts-db-svc.yaml', 'sock-shop-2/manifests/06-catalogue-svc.yaml', 'sock-shop-2/manifests/08-catalogue-db-svc.yaml', 'sock-shop-2/manifests/12-orders-svc.yaml', 'sock-shop-2/manifests/14-orders-db-svc.yaml', 'sock-shop-2/manifests/16-payment-svc.yaml', 'sock-shop-2/manifests/18-queue-master-svc.yaml', 'sock-shop-2/manifests/22-session-db-svc.yaml', 'sock-shop-2/manifests/24-shipping-svc.yaml', 'sock-shop-2/manifests/26-user-svc.yaml', 'sock-shop-2/manifests/28-user-db-svc.yaml']\\n  - problematic config: The 'ports' field in the Service spec is missing the 'port' configuration.\\n\\nIssue #1: Single Replica Deployment\\n  - details: Having a single replica for a deployment can lead to downtime if the pod fails.\\n  - manifests having the issues: ['sock-shop-2/manifests/09-front-end-dep.yaml']\\n  - problematic config: The 'replicas' field is set to 1.\\n\\nIssue #2: High Initial Delay for Liveness Probe\\n  - details: A high initial delay for the liveness probe can delay the detection of a non-responsive application.\\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/09-front-end-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\\n  - problematic config: The 'initialDelaySeconds' for the liveness probe is set to 300.\\n\\nIssue #3: High Initial Delay for Readiness Probe\\n  - details: A high initial delay for the readiness probe can delay the application from being marked as ready, affecting service availability.\\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\\n  - problematic config: The 'initialDelaySeconds' for the readiness probe is set to 180.\\n\\n\", k8s_app=K8sAppAssumption(thought=\"The manifests provided are part of a well-known microservices demo application called 'Sock Shop'. This application is designed to demonstrate the use of microservices architecture and Kubernetes orchestration. The file names, labels, and images used in the manifests (e.g., 'weaveworksdemos') are indicative of the Sock Shop application, which simulates an e-commerce website for selling socks. The application includes various services such as carts, catalogue, orders, payment, and user management, each with its own database and service components, reflecting a typical e-commerce platform's architecture.\", k8s_application='Sock Shop is an e-commerce application that simulates an online sock store. It offers users the ability to browse a catalogue of socks, add items to a cart, place orders, and manage user accounts. The application is composed of multiple microservices, each responsible for a specific function within the e-commerce workflow, such as handling orders, managing user sessions, and processing payments.'), ce_instructions='- The Chaos-Engineering experiment must be completed within 1 minute.\\n\\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\\n  1. http://front-end.sock-shop.svc.cluster.local/\\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\\n  4. http://front-end.sock-shop.svc.cluster.local/category/\\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html')>\n\n# You will inspect the following state of my system:\nFrontEndLivenessProbeSuccess: The next issue to address is the 'Single Replica Deployment' in the 'sock-shop-2/manifests/09-front-end-dep.yaml'. This issue is critical because having only one replica can lead to downtime if the pod fails. To ensure the system's resilience, we need to verify that the single replica of the 'front-end' deployment is always available. The steady state will check the availability of the 'front-end' pod by ensuring that the liveness probe is successful 95% of the time during a 1-minute period. This will help us confirm that the single replica is stable and responsive, even though it lacks redundancy.\n\n# Please follow the instructions below regarding Chaos Engineering:\n- The Chaos-Engineering experiment must be completed within 1 minute.\n\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\n  1. http://front-end.sock-shop.svc.cluster.local/\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\n  4. http://front-end.sock-shop.svc.cluster.local/category/\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html\n\nPlease define the way to inspect \"FrontEndLivenessProbeSuccess\" in the system defined by the above k8s manifest(s).\nAI: ```json\n{\"thought\":"
            ],
            "{\"thought\":\"To inspect the 'FrontEndLivenessProbeSuccess', we need to ensure that the liveness probe of the 'front-end' deployment is successful 95% of the time during a 1-minute period. Since this involves checking the liveness probe status of a Kubernetes pod, the K8s API is the appropriate tool to use. We will write a Python script using the Kubernetes client library to monitor the liveness probe status of the 'front-end' pod in the 'sock-shop' namespace. The script will check the pod's status every second for a duration of 60 seconds and calculate the success rate of the liveness probe.\",\"tool_type\":\"k8s\",\"tool\":{\"duration\":\"60s\",\"script\":\"import os\\nimport time\\nimport argparse\\nfrom kubernetes import client, config\\n\\ndef check_frontend_liveness(namespace, duration):\\n    # Load Kubernetes configuration based on the environment\\n    if os.getenv('KUBERNETES_SERVICE_HOST'):\\n        config.load_incluster_config()\\n    else:\\n        config.load_kube_config()\\n\\n    v1 = client.CoreV1Api()\\n    success_count = 0\\n    total_checks = 0\\n\\n    for _ in range(duration):\\n        pods = v1.list_namespaced_pod(namespace=namespace, label_selector=\\\"name=front-end\\\").items\\n        if pods:\\n            pod = pods[0]\\n            if pod.status.conditions:\\n                for condition in pod.status.conditions:\\n                    if condition.type == \\\"Ready\\\" and condition.status == \\\"True\\\":\\n                        success_count += 1\\n                        break\\n        total_checks += 1\\n        time.sleep(1)\\n\\n    success_rate = (success_count / total_checks) * 100\\n    print(f\\\"Liveness Probe Success Rate: {success_rate}%\\\")\\n    return success_rate\\n\\n\\ndef main():\\n    parser = argparse.ArgumentParser(description='Check Front-End Liveness Probe Success')\\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the liveness probe in seconds')\\n    args = parser.parse_args()\\n\\n    namespace = 'sock-shop'\\n    success_rate = check_frontend_liveness(namespace, args.duration)\\n    if success_rate >= 95:\\n        print(\\\"Liveness probe is successful 95% of the time.\\\")\\n    else:\\n        print(\\\"Liveness probe success rate is below 95%.\\\")\\n\\nif __name__ == '__main__':\\n    main()\"}}"
        ]
    },
    {
        "name": "threshold_definition",
        "token_usage": {
            "input_tokens": 12092,
            "output_tokens": 182,
            "total_tokens": 12274
        },
        "message_history": [
            [
                "System: You are a helpful AI assistant for Chaos Engineering. \nGiven k8s manifests for a network system, its steady state, and the current value of the steady state, you will define the threshold for the steady state.\nAlways keep the following rules:\n- The threshold must include reasonable tolerance that makes the threshold being more easiliy satisfied to account for some fluctuations.\n- The current value of the steady state must satisfy the threshold (including tolerance) as the currrent value is the normal state and the threshold represents whether the system remains normal.\n- If redundancy already exists in the resource, define at least the minimum required value as the threshold.\n- Explicitly specify all values related to the threshold, such as the number of resources that must be satisfied, the percentage of time it must be satisfied within the monitoring period, etc.\n- The output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"thought\": {\"title\": \"Thought\", \"description\": \"Write your thought process to determine the threshold of the steady state.\", \"type\": \"string\"}, \"threshold\": {\"title\": \"Threshold\", \"description\": \"the threshold of the steady state, which should be satisfied satisfied in the current state.\", \"type\": \"string\"}}, \"required\": [\"thought\", \"threshold\"]}\n```\nHuman: # Here is the overview of my system:\nThe system consists of the following K8s manifest(s):K8s manifest: sock-shop-2/manifests/00-sock-shop-ns.yaml\n```yaml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: sock-shop\n\n```\nSummary of sock-shop-2/manifests/00-sock-shop-ns.yaml:\n- This manifest defines a Kubernetes Namespace.\n- The Namespace is named 'sock-shop'.\n- Namespaces are used to organize and manage resources in a Kubernetes cluster.\n\nK8s manifest: sock-shop-2/manifests/01-carts-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts\n  template:\n    metadata:\n      labels:\n        name: carts\n    spec:\n      containers:\n      - name: carts\n        image: weaveworksdemos/carts:0.4.8\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/01-carts-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/carts:0.4.8'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 300m CPU and 500Mi memory, and a minimum of 100m CPU and 200Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities.\n- The root filesystem is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/02-carts-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: carts\n\n```\nSummary of sock-shop-2/manifests/02-carts-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The Service is named 'carts'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: carts'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: carts' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/03-carts-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts-db\n  template:\n    metadata:\n      labels:\n        name: carts-db\n    spec:\n      containers:\n      - name: carts-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/03-carts-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts-db' pod running.\n- The pods are selected based on the label 'name: carts-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add only CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/04-carts-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: carts-db\n\n```\nSummary of sock-shop-2/manifests/04-carts-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'carts-db'.\n- It is labeled with 'name: carts-db'.\n- The Service is created in the 'sock-shop' namespace.\n- It exposes port 27017 and directs traffic to the same port on the target pods.\n- The Service selects pods with the label 'name: carts-db' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/05-catalogue-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue\n  template:\n    metadata:\n      labels:\n        name: catalogue\n    spec:\n      containers:\n      - name: catalogue\n        image: weaveworksdemos/catalogue:0.3.5\n        command: [\"/app\"]\n        args:\n        - -port=80\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/05-catalogue-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/catalogue:0.3.5'.\n- The application runs with the command '/app' and listens on port 80.\n- Resource limits are set to 200m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container runs as a non-root user with user ID 10001 and has a read-only root filesystem.\n- Security settings drop all capabilities except 'NET_BIND_SERVICE'.\n- A liveness probe checks the '/health' endpoint on port 80, starting after 300 seconds and repeating every 3 seconds.\n- A readiness probe also checks the '/health' endpoint on port 80, starting after 180 seconds and repeating every 3 seconds.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/06-catalogue-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: catalogue\n\n```\nSummary of sock-shop-2/manifests/06-catalogue-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'catalogue'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: catalogue'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: catalogue'.\n\nK8s manifest: sock-shop-2/manifests/07-catalogue-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue-db\n  template:\n    metadata:\n      labels:\n        name: catalogue-db\n    spec:\n      containers:\n      - name: catalogue-db\n        image: weaveworksdemos/catalogue-db:0.3.0\n        env:\n          - name: MYSQL_ROOT_PASSWORD\n            value: fake_password\n          - name: MYSQL_DATABASE\n            value: socksdb\n        ports:\n        - name: mysql\n          containerPort: 3306\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/07-catalogue-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue-db' pod running.\n- The pods are selected based on the label 'name: catalogue-db'.\n- Each pod runs a single container using the image 'weaveworksdemos/catalogue-db:0.3.0'.\n- The container is configured with environment variables for 'MYSQL_ROOT_PASSWORD' and 'MYSQL_DATABASE'.\n- The container exposes port 3306, which is typically used for MySQL databases.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/08-catalogue-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 3306\n    targetPort: 3306\n  selector:\n    name: catalogue-db\n\n```\nSummary of sock-shop-2/manifests/08-catalogue-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'catalogue-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 3306.\n- It targets the same port (3306) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: catalogue-db'.\n- This setup is typically used to provide a stable endpoint for accessing a database running in the cluster.\n\nK8s manifest: sock-shop-2/manifests/09-front-end-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: front-end\n  namespace: sock-shop\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: front-end\n  template:\n    metadata:\n      labels:\n        name: front-end\n    spec:\n      containers:\n      - name: front-end\n        image: weaveworksdemos/front-end:0.3.12\n        resources:\n          limits:\n            cpu: 300m\n            memory: 1000Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 8079\n        env:\n        - name: SESSION_REDIS\n          value: \"true\"\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 30\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n```\nSummary of sock-shop-2/manifests/09-front-end-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'front-end' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 1 replica of the front-end application running.\n- The Deployment uses a selector to match pods with the label 'name: front-end'.\n- The pod template includes a single container named 'front-end'.\n- The container uses the image 'weaveworksdemos/front-end:0.3.12'.\n- Resource limits are set for the container: 300m CPU and 1000Mi memory.\n- Resource requests are set for the container: 100m CPU and 300Mi memory.\n- The container exposes port 8079.\n- An environment variable 'SESSION_REDIS' is set to 'true'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All Linux capabilities are dropped, and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/' path on port 8079, with an initial delay of 300 seconds and a period of 3 seconds.\n- A readiness probe is also configured to check the '/' path on port 8079, with an initial delay of 30 seconds and a period of 3 seconds.\n- The node selector ensures the pod runs on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/10-front-end-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: front-end\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: front-end\n  namespace: sock-shop\nspec:\n  type: NodePort\n  ports:\n  - port: 80\n    targetPort: 8079\n    nodePort: 30001\n  selector:\n    name: front-end\n\n```\nSummary of sock-shop-2/manifests/10-front-end-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'front-end'.\n- It is located in the 'sock-shop' namespace.\n- The Service type is 'NodePort', which exposes the service on each Node's IP at a static port.\n- It listens on port 80 and forwards traffic to target port 8079 on the pods.\n- The nodePort is set to 30001, which is the port on each node where the service can be accessed externally.\n- The Service is configured to be scraped by Prometheus for monitoring, as indicated by the annotation 'prometheus.io/scrape: true'.\n- It uses a selector to target pods with the label 'name: front-end'.\n\nK8s manifest: sock-shop-2/manifests/11-orders-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders\n  template:\n    metadata:\n      labels:\n        name: orders\n    spec:\n      containers:\n      - name: orders\n        image: weaveworksdemos/orders:0.4.7\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 500m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/11-orders-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/orders:0.4.7'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 500m CPU and 500Mi memory, and a minimum of 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities and a read-only root filesystem.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/12-orders-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: orders\n\n```\nSummary of sock-shop-2/manifests/12-orders-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: orders'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the target pods.\n- It uses a selector to match pods with the label 'name: orders'.\n\nK8s manifest: sock-shop-2/manifests/13-orders-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders-db\n  template:\n    metadata:\n      labels:\n        name: orders-db\n    spec:\n      containers:\n      - name: orders-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/13-orders-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders-db' pod running.\n- The pods are selected based on the label 'name: orders-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add specific ones like CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/14-orders-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: orders-db\n\n```\nSummary of sock-shop-2/manifests/14-orders-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods.\n- The Service selects pods with the label 'name: orders-db'.\n\nK8s manifest: sock-shop-2/manifests/15-payment-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: payment\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: payment\n  template:\n    metadata:\n      labels:\n        name: payment\n    spec:\n      containers:\n      - name: payment\n        image: weaveworksdemos/payment:0.4.3\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 99m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/15-payment-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'payment' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'payment' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/payment:0.4.3'.\n- Resource limits are set for the containers: 200m CPU and 200Mi memory.\n- Resource requests are set for the containers: 99m CPU and 100Mi memory.\n- The container exposes port 80.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All capabilities are dropped except 'NET_BIND_SERVICE', and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/health' endpoint on port 80, starting after 300 seconds and checking every 3 seconds.\n- A readiness probe is also configured to check the '/health' endpoint on port 80, starting after 180 seconds and checking every 3 seconds.\n- The Deployment is scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/16-payment-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: payment\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: payment\n\n```\nSummary of sock-shop-2/manifests/16-payment-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'payment'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: payment'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: payment'.\n\nK8s manifest: sock-shop-2/manifests/17-queue-master-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: queue-master\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: queue-master\n  template:\n    metadata:\n      labels:\n        name: queue-master\n    spec:\n      containers:\n      - name: queue-master\n        image: weaveworksdemos/queue-master:0.3.1\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/17-queue-master-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'queue-master' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'queue-master' pod running.\n- The pods are selected based on the label 'name: queue-master'.\n- Each pod runs a single container using the image 'weaveworksdemos/queue-master:0.3.1'.\n- The container is configured with specific Java options through environment variables.\n- Resource limits are set for the container, with a maximum of 300m CPU and 500Mi memory, and requests for 100m CPU and 300Mi memory.\n- The container exposes port 80.\n- The pods are scheduled on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/18-queue-master-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: queue-master\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: queue-master\n```\nSummary of sock-shop-2/manifests/18-queue-master-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'queue-master'.\n- It is annotated to enable Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: queue-master'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: queue-master' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/19-rabbitmq-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: rabbitmq\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: rabbitmq\n  template:\n    metadata:\n      labels:\n        name: rabbitmq\n      annotations:\n        prometheus.io/scrape: \"false\"\n    spec:\n      containers:\n      - name: rabbitmq\n        image: rabbitmq:3.6.8-management\n        ports:\n        - containerPort: 15672\n          name: management\n        - containerPort: 5672\n          name: rabbitmq\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n              - DAC_OVERRIDE\n          readOnlyRootFilesystem: true\n      - name: rabbitmq-exporter\n        image: kbudde/rabbitmq-exporter\n        ports:\n        - containerPort: 9090\n          name: exporter\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/19-rabbitmq-dep.yaml:\n- This manifest defines a Deployment for RabbitMQ in Kubernetes.\n- The Deployment is named 'rabbitmq' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas, meaning there will be 2 instances of RabbitMQ running.\n- The Deployment uses a label 'name: rabbitmq' to manage its pods.\n- The RabbitMQ container uses the image 'rabbitmq:3.6.8-management'.\n- It exposes two ports: 15672 for management and 5672 for RabbitMQ communication.\n- Security settings drop all capabilities but add CHOWN, SETGID, SETUID, and DAC_OVERRIDE, and the root filesystem is set to read-only.\n- An additional container, 'rabbitmq-exporter', is included for monitoring purposes, using the 'kbudde/rabbitmq-exporter' image and exposing port 9090.\n- The Deployment is configured to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/20-rabbitmq-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: rabbitmq\n  annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 5672\n    name: rabbitmq\n    targetPort: 5672\n  - port: 9090\n    name: exporter\n    targetPort: exporter\n    protocol: TCP\n  selector:\n    name: rabbitmq\n\n```\nSummary of sock-shop-2/manifests/20-rabbitmq-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'rabbitmq'.\n- It is annotated for Prometheus scraping on port 9090.\n- The Service is located in the 'sock-shop' namespace.\n- It exposes two ports: 5672 for RabbitMQ and 9090 for an exporter.\n- The Service uses TCP protocol for communication.\n- It selects pods with the label 'name: rabbitmq' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/21-session-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: session-db\n  template:\n    metadata:\n      labels:\n        name: session-db\n      annotations:\n        prometheus.io.scrape: \"false\"\n    spec:\n      containers:\n      - name: session-db\n        image: redis:alpine\n        ports:\n        - name: redis\n          containerPort: 6379\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/21-session-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'session-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'session-db' pod running.\n- The pods are selected based on the label 'name: session-db'.\n- Each pod runs a single container using the 'redis:alpine' image.\n- The container exposes port 6379, which is commonly used by Redis.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/22-session-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 6379\n    targetPort: 6379\n  selector:\n    name: session-db\n\n```\nSummary of sock-shop-2/manifests/22-session-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'session-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 6379.\n- It targets the same port (6379) on the selected pods.\n- The Service uses a selector to match pods with the label 'name: session-db'.\n\nK8s manifest: sock-shop-2/manifests/23-shipping-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: shipping\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: shipping\n  template:\n    metadata:\n      labels:\n        name: shipping\n    spec:\n      containers:\n      - name: shipping\n        image: weaveworksdemos/shipping:0.4.8\n        env:\n         - name: ZIPKIN\n           value: zipkin.jaeger.svc.cluster.local\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/23-shipping-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'shipping' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas of the 'shipping' application to be run.\n- The Deployment uses the Docker image 'weaveworksdemos/shipping:0.4.8'.\n- Environment variables are set for the application, including 'ZIPKIN' and 'JAVA_OPTS'.\n- Resource limits and requests are defined, with CPU limits at 300m and memory limits at 500Mi, and requests at 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with user ID 10001, and it drops all capabilities except 'NET_BIND_SERVICE'.\n- The root filesystem is set to be read-only.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/24-shipping-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: shipping\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: shipping\n\n\n```\nSummary of sock-shop-2/manifests/24-shipping-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'shipping'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: shipping'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: shipping' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/25-user-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user\n  template:\n    metadata:\n      labels:\n        name: user\n    spec:\n      containers:\n      - name: user\n        image: weaveworksdemos/user:0.4.7\n        resources:\n          limits:\n            cpu: 300m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        env:\n        - name: mongo\n          value: user-db:27017\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/25-user-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/user:0.4.7'.\n- Resource limits are set for the container: 300m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container listens on port 80.\n- An environment variable 'mongo' is set with the value 'user-db:27017'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- The container has a read-only root filesystem and drops all capabilities except 'NET_BIND_SERVICE'.\n- Liveness and readiness probes are configured to check the '/health' endpoint on port 80, with initial delays of 300 and 180 seconds, respectively.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/26-user-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: user\n\n\n```\nSummary of sock-shop-2/manifests/26-user-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: user'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It uses a selector to target pods with the label 'name: user'.\n\nK8s manifest: sock-shop-2/manifests/27-user-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user-db\n  template:\n    metadata:\n      labels:\n        name: user-db\n    spec:\n      containers:\n      - name: user-db\n        image: weaveworksdemos/user-db:0.3.0\n\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/27-user-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user-db' pod running.\n- The pods are labeled with 'name: user-db' for identification and selection.\n- Each pod runs a single container using the image 'weaveworksdemos/user-db:0.3.0'.\n- The container exposes port 27017, which is typically used by MongoDB.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/28-user-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: user-db\n\n\n```\nSummary of sock-shop-2/manifests/28-user-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: user-db'.\n\nThe resiliency issues/weaknesses in the system are as follows:\nIssue #0: Missing Port Configuration\n  - details: The service does not specify the port it should serve on, which can lead to connectivity issues.\n  - manifests having the issues: ['sock-shop-2/manifests/02-carts-svc.yaml', 'sock-shop-2/manifests/04-carts-db-svc.yaml', 'sock-shop-2/manifests/06-catalogue-svc.yaml', 'sock-shop-2/manifests/08-catalogue-db-svc.yaml', 'sock-shop-2/manifests/12-orders-svc.yaml', 'sock-shop-2/manifests/14-orders-db-svc.yaml', 'sock-shop-2/manifests/16-payment-svc.yaml', 'sock-shop-2/manifests/18-queue-master-svc.yaml', 'sock-shop-2/manifests/22-session-db-svc.yaml', 'sock-shop-2/manifests/24-shipping-svc.yaml', 'sock-shop-2/manifests/26-user-svc.yaml', 'sock-shop-2/manifests/28-user-db-svc.yaml']\n  - problematic config: The 'ports' field in the Service spec is missing the 'port' configuration.\n\nIssue #1: Single Replica Deployment\n  - details: Having a single replica for a deployment can lead to downtime if the pod fails.\n  - manifests having the issues: ['sock-shop-2/manifests/09-front-end-dep.yaml']\n  - problematic config: The 'replicas' field is set to 1.\n\nIssue #2: High Initial Delay for Liveness Probe\n  - details: A high initial delay for the liveness probe can delay the detection of a non-responsive application.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/09-front-end-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the liveness probe is set to 300.\n\nIssue #3: High Initial Delay for Readiness Probe\n  - details: A high initial delay for the readiness probe can delay the application from being marked as ready, affecting service availability.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the readiness probe is set to 180.\n\nThe expected type of application on the system (i.e., K8s manfests):\nSock Shop is an e-commerce application that simulates an online sock store. It offers users the ability to browse a catalogue of socks, add items to a cart, place orders, and manage user accounts. The application is composed of multiple microservices, each responsible for a specific function within the e-commerce workflow, such as handling orders, managing user sessions, and processing payments.; The manifests provided are part of a well-known microservices demo application called 'Sock Shop'. This application is designed to demonstrate the use of microservices architecture and Kubernetes orchestration. The file names, labels, and images used in the manifests (e.g., 'weaveworksdemos') are indicative of the Sock Shop application, which simulates an e-commerce website for selling socks. The application includes various services such as carts, catalogue, orders, payment, and user management, each with its own database and service components, reflecting a typical e-commerce platform's architecture.\n\n# You will determine a reasonable threshold for the following steady state of my system:\nFrontEndLivenessProbeSuccess: The next issue to address is the 'Single Replica Deployment' in the 'sock-shop-2/manifests/09-front-end-dep.yaml'. This issue is critical because having only one replica can lead to downtime if the pod fails. To ensure the system's resilience, we need to verify that the single replica of the 'front-end' deployment is always available. The steady state will check the availability of the 'front-end' pod by ensuring that the liveness probe is successful 95% of the time during a 1-minute period. This will help us confirm that the single replica is stable and responsive, even though it lacks redundancy.\n\n# The Python code of k8s client libraries to inspect the current state of the steady state and its result are the following:\n## Script:\n```python\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\n\ndef check_frontend_liveness(namespace, duration):\n    # Load Kubernetes configuration based on the environment\n    if os.getenv('KUBERNETES_SERVICE_HOST'):\n        config.load_incluster_config()\n    else:\n        config.load_kube_config()\n\n    v1 = client.CoreV1Api()\n    success_count = 0\n    total_checks = 0\n\n    for _ in range(duration):\n        pods = v1.list_namespaced_pod(namespace=namespace, label_selector=\"name=front-end\").items\n        if pods:\n            pod = pods[0]\n            if pod.status.conditions:\n                for condition in pod.status.conditions:\n                    if condition.type == \"Ready\" and condition.status == \"True\":\n                        success_count += 1\n                        break\n        total_checks += 1\n        time.sleep(1)\n\n    success_rate = (success_count / total_checks) * 100\n    print(f\"Liveness Probe Success Rate: {success_rate}%\")\n    return success_rate\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Check Front-End Liveness Probe Success')\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the liveness probe in seconds')\n    args = parser.parse_args()\n\n    namespace = 'sock-shop'\n    success_rate = check_frontend_liveness(namespace, args.duration)\n    if success_rate >= 95:\n        print(\"Liveness probe is successful 95% of the time.\")\n    else:\n        print(\"Liveness probe success rate is below 95%.\")\n\nif __name__ == '__main__':\n    main()\n```  \n## Result (current state):\nLiveness Probe Success Rate: 100.0%\nLiveness probe is successful 95% of the time.\n\n\n# Please follow the instructions below regarding Chaos Engineering:\n- The Chaos-Engineering experiment must be completed within 1 minute.\n\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\n  1. http://front-end.sock-shop.svc.cluster.local/\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\n  4. http://front-end.sock-shop.svc.cluster.local/category/\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html\n\nNow, please define a reasonable threshold for the steady state according to the above information.\nAI: ```json\n{\"thought\":"
            ],
            "{\"thought\":\"The steady state to be verified is the availability of the 'front-end' pod, specifically ensuring that the liveness probe is successful 95% of the time during a 1-minute period. The current state shows a 100% success rate, which is above the required 95%. To account for fluctuations and ensure the system remains stable, we can set a threshold that allows for some tolerance. Given that the current success rate is 100%, setting the threshold at 95% is reasonable and ensures that the system is considered stable even if there are minor fluctuations. This threshold is also aligned with the requirement to complete the Chaos-Engineering experiment within 1 minute, as it allows for quick verification of the system's stability.\",\"threshold\":\"The liveness probe for the 'front-end' pod must be successful at least 95% of the time during a 1-minute monitoring period.\"}"
        ]
    },
    {
        "name": "unittest_writing",
        "token_usage": {
            "input_tokens": 1378,
            "output_tokens": 606,
            "total_tokens": 1984
        },
        "message_history": [
            [
                "System: You are a helpful AI assistant for writing unit tests in Python.\nGiven the steady state, python script to inspect it, and its threshold, please write a Python unit test (including for-loop for certain duration) to verify if the steady state satisfies the threshold by adding assertion.\nAlways keep the following rules:\n- Include as many comments as possible in your code so that humans can easily understand what you did later.\n- Use the Kubernetes Python API.\n- If there is an explicitly defined values to be satisfied, hardcode that value and use it for threshold assertion.\n- Add argparse '--duration' (type=int) so that users can specify the loop duration as the previous python script.\n- NEVER use \"unittest\" module to use argparse.\n- Create a unit test by inheriting from the 'K8sAPIBase' class below (available via ```from unittest_base import K8sAPIBase```):\n```python\nimport os\nfrom kubernetes import client, config\n\nclass K8sAPIBase:\n    def __init__(self):\n        # Load Kubernetes configuration based on the environment\n        if os.getenv('KUBERNETES_SERVICE_HOST'):\n            config.load_incluster_config()\n        else:\n            config.load_kube_config()\n\n        # Create a Kubernetes API client\n        self.v1 = client.CoreV1Api()\n```\n- Add a entry point at the bottom to allow the test to be run from the command line, as follows:\n```\nif __name__ == '__main__':\n    main()\n```\n- The output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"thought\": {\"title\": \"Thought\", \"description\": \"Describe how you add the threshold assersion to the inspection Python script.\", \"type\": \"string\"}, \"code\": {\"title\": \"Code\", \"description\": \"Python unit test code. Implement a for loop that checks the status every second for the duration, and implement summary output at the end for both success and failure cases (i.e., print and assertion).\\n- Please add an entry point at the bottom to allow the test to be run from the command line.\\n- Please add argparse '--duration' (type=int) so that users can specify the loop duration. Write only the content of the code, and for dictionary values, enclose them within a pair of single double quotes (\\\").\", \"type\": \"string\"}}, \"required\": [\"thought\", \"code\"]}\n```\nHuman: The steady state:\nFrontEndLivenessProbeSuccess: The next issue to address is the 'Single Replica Deployment' in the 'sock-shop-2/manifests/09-front-end-dep.yaml'. This issue is critical because having only one replica can lead to downtime if the pod fails. To ensure the system's resilience, we need to verify that the single replica of the 'front-end' deployment is always available. The steady state will check the availability of the 'front-end' pod by ensuring that the liveness probe is successful 95% of the time during a 1-minute period. This will help us confirm that the single replica is stable and responsive, even though it lacks redundancy.\n\nThe steady state was inspected with the following python code of k8s client libraries:\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\n\ndef check_frontend_liveness(namespace, duration):\n    # Load Kubernetes configuration based on the environment\n    if os.getenv('KUBERNETES_SERVICE_HOST'):\n        config.load_incluster_config()\n    else:\n        config.load_kube_config()\n\n    v1 = client.CoreV1Api()\n    success_count = 0\n    total_checks = 0\n\n    for _ in range(duration):\n        pods = v1.list_namespaced_pod(namespace=namespace, label_selector=\"name=front-end\").items\n        if pods:\n            pod = pods[0]\n            if pod.status.conditions:\n                for condition in pod.status.conditions:\n                    if condition.type == \"Ready\" and condition.status == \"True\":\n                        success_count += 1\n                        break\n        total_checks += 1\n        time.sleep(1)\n\n    success_rate = (success_count / total_checks) * 100\n    print(f\"Liveness Probe Success Rate: {success_rate}%\")\n    return success_rate\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Check Front-End Liveness Probe Success')\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the liveness probe in seconds')\n    args = parser.parse_args()\n\n    namespace = 'sock-shop'\n    success_rate = check_frontend_liveness(namespace, args.duration)\n    if success_rate >= 95:\n        print(\"Liveness probe is successful 95% of the time.\")\n    else:\n        print(\"Liveness probe success rate is below 95%.\")\n\nif __name__ == '__main__':\n    main()\n\nThe threshold of the steady state: The liveness probe for the 'front-end' pod must be successful at least 95% of the time during a 1-minute monitoring period.; The steady state to be verified is the availability of the 'front-end' pod, specifically ensuring that the liveness probe is successful 95% of the time during a 1-minute period. The current state shows a 100% success rate, which is above the required 95%. To account for fluctuations and ensure the system remains stable, we can set a threshold that allows for some tolerance. Given that the current success rate is 100%, setting the threshold at 95% is reasonable and ensures that the system is considered stable even if there are minor fluctuations. This threshold is also aligned with the requirement to complete the Chaos-Engineering experiment within 1 minute, as it allows for quick verification of the system's stability.\n\nGiven the above steady state, command, and threshold, please write a Python unit test to check if the steady state satisfies the threshold.\nThe threshold in the unit test must exactly match the threshold defined above. Implement it to support variable durations. Use a representative value (e.g., percentage, ratio, etc.) for the threshold. NEVER use any fixed absolute values for the threshold.\nAI: ```json\n{\"thought\":"
            ],
            "{\"thought\": \"To verify the steady state of the 'front-end' pod's liveness probe, I will write a Python unit test that checks if the liveness probe is successful at least 95% of the time during a specified duration. The test will use the Kubernetes Python API to monitor the pod's status and calculate the success rate. The threshold of 95% is explicitly defined and will be used in the assertion to ensure the system's stability. The test will include a for-loop to check the status every second for the specified duration, and argparse will be used to allow users to specify the duration. The test will output a summary at the end, indicating whether the threshold was met.\", \"code\": \"import os\\nimport time\\nimport argparse\\nfrom kubernetes import client, config\\nfrom unittest_base import K8sAPIBase\\n\\nclass TestFrontEndLivenessProbe(K8sAPIBase):\\n    def check_frontend_liveness(self, namespace, duration):\\n        success_count = 0\\n        total_checks = 0\\n\\n        for _ in range(duration):\\n            # List pods with the label 'name=front-end' in the specified namespace\\n            pods = self.v1.list_namespaced_pod(namespace=namespace, label_selector=\\\"name=front-end\\\").items\\n            if pods:\\n                pod = pods[0]\\n                if pod.status.conditions:\\n                    for condition in pod.status.conditions:\\n                        if condition.type == \\\"Ready\\\" and condition.status == \\\"True\\\":\\n                            success_count += 1\\n                            break\\n            total_checks += 1\\n            time.sleep(1)\\n\\n        # Calculate the success rate of the liveness probe\\n        success_rate = (success_count / total_checks) * 100\\n        print(f\\\"Liveness Probe Success Rate: {success_rate}%\\\")\\n        return success_rate\\n\\n    def test_liveness_probe_success_rate(self, namespace='sock-shop', duration=60):\\n        # Check the liveness probe success rate\\n        success_rate = self.check_frontend_liveness(namespace, duration)\\n        # Assert that the success rate is at least 95%\\n        assert success_rate >= 95, f\\\"Liveness probe success rate is below 95%: {success_rate}%\\\"\\n\\n\\ndef main():\\n    parser = argparse.ArgumentParser(description='Test Front-End Liveness Probe Success Rate')\\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the liveness probe in seconds')\\n    args = parser.parse_args()\\n\\n    # Create an instance of the test class\\n    test_instance = TestFrontEndLivenessProbe()\\n    # Run the test with the specified duration\\n    test_instance.test_liveness_probe_success_rate(duration=args.duration)\\n\\n\\nif __name__ == '__main__':\\n    main()\"}"
        ]
    },
    {
        "name": "fault_scenario_assumption",
        "token_usage": {
            "input_tokens": 13754,
            "output_tokens": 387,
            "total_tokens": 14141
        },
        "message_history": [
            [
                "System: You are a helpful AI assistant for Chaos Engineering. \nGiven k8s manifests for a system, the steady states of the system, and user's instructions for Chaos Engineering, you will define the most impactful fault injections to reveal potential weaknesses of the system, such as insufficient recovery functions, resource allocation, redundancy, etc.\nAlways keep the following rules:\n- First, assume a real-world event that may be most impactful in the the system, such as promotion campaign, cyber attacks, disasters, etc.\n- Then, define the most impactful fault injections to reveal potential weaknesses of the given system while simulating the assumed real-world event.\n- Prioritize fault injections that target the system's weak resources related to the steady states to verify whether those resources can handle the faults and the steady states can be maintained.\n- The injected faults should be selected from the following fault types of Chaos Mesh:\n- PodChaos: simulates Pod failures, such as Pod node restart, Pod's persistent unavailablility, and certain container failures in a specific Pod. The supported subtypes include 'pod-kill', 'container-kill'.\n- NetworkChaos: simulates network failures, such as network latency, packet loss, packet disorder, and network partitions.\n- DNSChaos: simulates DNS failures, such as the parsing failure of DNS domain name and the wrong IP address returned.\n- HTTPChaos: simulates HTTP communication failures, such as HTTP communication latency.\n- StressChaos: simulates CPU race or memory race.\n- IOChaos: simulates the I/O failure of an application file, such as I/O delays, read and write failures.\n- TimeChaos: simulates the time jump exception.\n\n- The output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"event\": {\"title\": \"Event\", \"description\": \"Consider a real-world fault event that may be most impactful of the system, such as promotion campaign, cyber attacks, disasters, etc.\", \"type\": \"string\"}, \"thought\": {\"title\": \"Thought\", \"description\": \"Write down your thought process to define a sequence of fault injections that exploit the system's weaknesses of while simulating the fault event: 1) how the system's weaknesses affect the steady state; 2) how each fault injection exploit the system's weaknesses; 3) how the sequence simulates the phenamena in the fault event (consider carefully the sequence order). Prioritize fault injections that directly attack the weaknessses of the system, such as insufficient recovery functions, resource allocation, redundancy, etc.\", \"type\": \"string\"}, \"faults\": {\"title\": \"Faults\", \"description\": \"Define a sequence of fault injections that exploit the system's vulnerabilities to the fullest according to the above thoughts. In the inner list, a set of simultaneously injected faults are listed, while in the outer list, the sets are listed in the injection order. For example, [[fault_a], [fault_b, fault_c]] indicates that fault_a is injected, then fault_b and fault_c are injected simultaneously.\", \"type\": \"array\", \"items\": {\"type\": \"array\", \"items\": {\"$ref\": \"#/definitions/Fault\"}}}}, \"required\": [\"event\", \"thought\", \"faults\"], \"definitions\": {\"Fault\": {\"title\": \"Fault\", \"type\": \"object\", \"properties\": {\"name\": {\"title\": \"Name\", \"description\": \"Select a fault type from [\\\"PodChaos\\\", \\\"NetworkChaos\\\", \\\"DNSChaos\\\", \\\"HTTPChaos\\\", \\\"StressChaos\\\", \\\"IOChaos\\\", \\\"TimeChaos\\\"]\", \"enum\": [\"PodChaos\", \"NetworkChaos\", \"DNSChaos\", \"HTTPChaos\", \"StressChaos\", \"IOChaos\", \"TimeChaos\"], \"type\": \"string\"}, \"name_id\": {\"title\": \"Name Id\", \"description\": \"An identifier to prevent name conflicts when the same Fault appears. Assign numbers starting from 0 in sequential order to prevent name conflicts.\", \"type\": \"integer\"}, \"scope\": {\"title\": \"Scope\", \"description\": \"Specify only the fault injection scope (i.e., the target resource where the fault is injected) in advance here.\", \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}}, \"required\": [\"name\", \"name_id\", \"scope\"]}}}\n```\nHuman: Here is the overview of my system:\nThe system consists of the following K8s manifest(s):K8s manifest: sock-shop-2/manifests/00-sock-shop-ns.yaml\n```yaml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: sock-shop\n\n```\nSummary of sock-shop-2/manifests/00-sock-shop-ns.yaml:\n- This manifest defines a Kubernetes Namespace.\n- The Namespace is named 'sock-shop'.\n- Namespaces are used to organize and manage resources in a Kubernetes cluster.\n\nK8s manifest: sock-shop-2/manifests/01-carts-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts\n  template:\n    metadata:\n      labels:\n        name: carts\n    spec:\n      containers:\n      - name: carts\n        image: weaveworksdemos/carts:0.4.8\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/01-carts-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/carts:0.4.8'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 300m CPU and 500Mi memory, and a minimum of 100m CPU and 200Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities.\n- The root filesystem is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/02-carts-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: carts\n\n```\nSummary of sock-shop-2/manifests/02-carts-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The Service is named 'carts'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: carts'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: carts' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/03-carts-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts-db\n  template:\n    metadata:\n      labels:\n        name: carts-db\n    spec:\n      containers:\n      - name: carts-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/03-carts-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts-db' pod running.\n- The pods are selected based on the label 'name: carts-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add only CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/04-carts-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: carts-db\n\n```\nSummary of sock-shop-2/manifests/04-carts-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'carts-db'.\n- It is labeled with 'name: carts-db'.\n- The Service is created in the 'sock-shop' namespace.\n- It exposes port 27017 and directs traffic to the same port on the target pods.\n- The Service selects pods with the label 'name: carts-db' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/05-catalogue-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue\n  template:\n    metadata:\n      labels:\n        name: catalogue\n    spec:\n      containers:\n      - name: catalogue\n        image: weaveworksdemos/catalogue:0.3.5\n        command: [\"/app\"]\n        args:\n        - -port=80\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/05-catalogue-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/catalogue:0.3.5'.\n- The application runs with the command '/app' and listens on port 80.\n- Resource limits are set to 200m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container runs as a non-root user with user ID 10001 and has a read-only root filesystem.\n- Security settings drop all capabilities except 'NET_BIND_SERVICE'.\n- A liveness probe checks the '/health' endpoint on port 80, starting after 300 seconds and repeating every 3 seconds.\n- A readiness probe also checks the '/health' endpoint on port 80, starting after 180 seconds and repeating every 3 seconds.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/06-catalogue-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: catalogue\n\n```\nSummary of sock-shop-2/manifests/06-catalogue-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'catalogue'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: catalogue'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: catalogue'.\n\nK8s manifest: sock-shop-2/manifests/07-catalogue-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue-db\n  template:\n    metadata:\n      labels:\n        name: catalogue-db\n    spec:\n      containers:\n      - name: catalogue-db\n        image: weaveworksdemos/catalogue-db:0.3.0\n        env:\n          - name: MYSQL_ROOT_PASSWORD\n            value: fake_password\n          - name: MYSQL_DATABASE\n            value: socksdb\n        ports:\n        - name: mysql\n          containerPort: 3306\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/07-catalogue-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue-db' pod running.\n- The pods are selected based on the label 'name: catalogue-db'.\n- Each pod runs a single container using the image 'weaveworksdemos/catalogue-db:0.3.0'.\n- The container is configured with environment variables for 'MYSQL_ROOT_PASSWORD' and 'MYSQL_DATABASE'.\n- The container exposes port 3306, which is typically used for MySQL databases.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/08-catalogue-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 3306\n    targetPort: 3306\n  selector:\n    name: catalogue-db\n\n```\nSummary of sock-shop-2/manifests/08-catalogue-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'catalogue-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 3306.\n- It targets the same port (3306) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: catalogue-db'.\n- This setup is typically used to provide a stable endpoint for accessing a database running in the cluster.\n\nK8s manifest: sock-shop-2/manifests/09-front-end-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: front-end\n  namespace: sock-shop\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: front-end\n  template:\n    metadata:\n      labels:\n        name: front-end\n    spec:\n      containers:\n      - name: front-end\n        image: weaveworksdemos/front-end:0.3.12\n        resources:\n          limits:\n            cpu: 300m\n            memory: 1000Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 8079\n        env:\n        - name: SESSION_REDIS\n          value: \"true\"\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 30\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n```\nSummary of sock-shop-2/manifests/09-front-end-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'front-end' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 1 replica of the front-end application running.\n- The Deployment uses a selector to match pods with the label 'name: front-end'.\n- The pod template includes a single container named 'front-end'.\n- The container uses the image 'weaveworksdemos/front-end:0.3.12'.\n- Resource limits are set for the container: 300m CPU and 1000Mi memory.\n- Resource requests are set for the container: 100m CPU and 300Mi memory.\n- The container exposes port 8079.\n- An environment variable 'SESSION_REDIS' is set to 'true'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All Linux capabilities are dropped, and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/' path on port 8079, with an initial delay of 300 seconds and a period of 3 seconds.\n- A readiness probe is also configured to check the '/' path on port 8079, with an initial delay of 30 seconds and a period of 3 seconds.\n- The node selector ensures the pod runs on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/10-front-end-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: front-end\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: front-end\n  namespace: sock-shop\nspec:\n  type: NodePort\n  ports:\n  - port: 80\n    targetPort: 8079\n    nodePort: 30001\n  selector:\n    name: front-end\n\n```\nSummary of sock-shop-2/manifests/10-front-end-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'front-end'.\n- It is located in the 'sock-shop' namespace.\n- The Service type is 'NodePort', which exposes the service on each Node's IP at a static port.\n- It listens on port 80 and forwards traffic to target port 8079 on the pods.\n- The nodePort is set to 30001, which is the port on each node where the service can be accessed externally.\n- The Service is configured to be scraped by Prometheus for monitoring, as indicated by the annotation 'prometheus.io/scrape: true'.\n- It uses a selector to target pods with the label 'name: front-end'.\n\nK8s manifest: sock-shop-2/manifests/11-orders-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders\n  template:\n    metadata:\n      labels:\n        name: orders\n    spec:\n      containers:\n      - name: orders\n        image: weaveworksdemos/orders:0.4.7\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 500m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/11-orders-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/orders:0.4.7'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 500m CPU and 500Mi memory, and a minimum of 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities and a read-only root filesystem.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/12-orders-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: orders\n\n```\nSummary of sock-shop-2/manifests/12-orders-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: orders'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the target pods.\n- It uses a selector to match pods with the label 'name: orders'.\n\nK8s manifest: sock-shop-2/manifests/13-orders-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders-db\n  template:\n    metadata:\n      labels:\n        name: orders-db\n    spec:\n      containers:\n      - name: orders-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/13-orders-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders-db' pod running.\n- The pods are selected based on the label 'name: orders-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add specific ones like CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/14-orders-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: orders-db\n\n```\nSummary of sock-shop-2/manifests/14-orders-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods.\n- The Service selects pods with the label 'name: orders-db'.\n\nK8s manifest: sock-shop-2/manifests/15-payment-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: payment\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: payment\n  template:\n    metadata:\n      labels:\n        name: payment\n    spec:\n      containers:\n      - name: payment\n        image: weaveworksdemos/payment:0.4.3\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 99m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/15-payment-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'payment' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'payment' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/payment:0.4.3'.\n- Resource limits are set for the containers: 200m CPU and 200Mi memory.\n- Resource requests are set for the containers: 99m CPU and 100Mi memory.\n- The container exposes port 80.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All capabilities are dropped except 'NET_BIND_SERVICE', and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/health' endpoint on port 80, starting after 300 seconds and checking every 3 seconds.\n- A readiness probe is also configured to check the '/health' endpoint on port 80, starting after 180 seconds and checking every 3 seconds.\n- The Deployment is scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/16-payment-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: payment\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: payment\n\n```\nSummary of sock-shop-2/manifests/16-payment-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'payment'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: payment'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: payment'.\n\nK8s manifest: sock-shop-2/manifests/17-queue-master-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: queue-master\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: queue-master\n  template:\n    metadata:\n      labels:\n        name: queue-master\n    spec:\n      containers:\n      - name: queue-master\n        image: weaveworksdemos/queue-master:0.3.1\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/17-queue-master-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'queue-master' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'queue-master' pod running.\n- The pods are selected based on the label 'name: queue-master'.\n- Each pod runs a single container using the image 'weaveworksdemos/queue-master:0.3.1'.\n- The container is configured with specific Java options through environment variables.\n- Resource limits are set for the container, with a maximum of 300m CPU and 500Mi memory, and requests for 100m CPU and 300Mi memory.\n- The container exposes port 80.\n- The pods are scheduled on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/18-queue-master-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: queue-master\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: queue-master\n```\nSummary of sock-shop-2/manifests/18-queue-master-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'queue-master'.\n- It is annotated to enable Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: queue-master'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: queue-master' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/19-rabbitmq-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: rabbitmq\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: rabbitmq\n  template:\n    metadata:\n      labels:\n        name: rabbitmq\n      annotations:\n        prometheus.io/scrape: \"false\"\n    spec:\n      containers:\n      - name: rabbitmq\n        image: rabbitmq:3.6.8-management\n        ports:\n        - containerPort: 15672\n          name: management\n        - containerPort: 5672\n          name: rabbitmq\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n              - DAC_OVERRIDE\n          readOnlyRootFilesystem: true\n      - name: rabbitmq-exporter\n        image: kbudde/rabbitmq-exporter\n        ports:\n        - containerPort: 9090\n          name: exporter\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/19-rabbitmq-dep.yaml:\n- This manifest defines a Deployment for RabbitMQ in Kubernetes.\n- The Deployment is named 'rabbitmq' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas, meaning there will be 2 instances of RabbitMQ running.\n- The Deployment uses a label 'name: rabbitmq' to manage its pods.\n- The RabbitMQ container uses the image 'rabbitmq:3.6.8-management'.\n- It exposes two ports: 15672 for management and 5672 for RabbitMQ communication.\n- Security settings drop all capabilities but add CHOWN, SETGID, SETUID, and DAC_OVERRIDE, and the root filesystem is set to read-only.\n- An additional container, 'rabbitmq-exporter', is included for monitoring purposes, using the 'kbudde/rabbitmq-exporter' image and exposing port 9090.\n- The Deployment is configured to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/20-rabbitmq-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: rabbitmq\n  annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 5672\n    name: rabbitmq\n    targetPort: 5672\n  - port: 9090\n    name: exporter\n    targetPort: exporter\n    protocol: TCP\n  selector:\n    name: rabbitmq\n\n```\nSummary of sock-shop-2/manifests/20-rabbitmq-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'rabbitmq'.\n- It is annotated for Prometheus scraping on port 9090.\n- The Service is located in the 'sock-shop' namespace.\n- It exposes two ports: 5672 for RabbitMQ and 9090 for an exporter.\n- The Service uses TCP protocol for communication.\n- It selects pods with the label 'name: rabbitmq' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/21-session-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: session-db\n  template:\n    metadata:\n      labels:\n        name: session-db\n      annotations:\n        prometheus.io.scrape: \"false\"\n    spec:\n      containers:\n      - name: session-db\n        image: redis:alpine\n        ports:\n        - name: redis\n          containerPort: 6379\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/21-session-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'session-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'session-db' pod running.\n- The pods are selected based on the label 'name: session-db'.\n- Each pod runs a single container using the 'redis:alpine' image.\n- The container exposes port 6379, which is commonly used by Redis.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/22-session-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 6379\n    targetPort: 6379\n  selector:\n    name: session-db\n\n```\nSummary of sock-shop-2/manifests/22-session-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'session-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 6379.\n- It targets the same port (6379) on the selected pods.\n- The Service uses a selector to match pods with the label 'name: session-db'.\n\nK8s manifest: sock-shop-2/manifests/23-shipping-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: shipping\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: shipping\n  template:\n    metadata:\n      labels:\n        name: shipping\n    spec:\n      containers:\n      - name: shipping\n        image: weaveworksdemos/shipping:0.4.8\n        env:\n         - name: ZIPKIN\n           value: zipkin.jaeger.svc.cluster.local\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/23-shipping-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'shipping' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas of the 'shipping' application to be run.\n- The Deployment uses the Docker image 'weaveworksdemos/shipping:0.4.8'.\n- Environment variables are set for the application, including 'ZIPKIN' and 'JAVA_OPTS'.\n- Resource limits and requests are defined, with CPU limits at 300m and memory limits at 500Mi, and requests at 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with user ID 10001, and it drops all capabilities except 'NET_BIND_SERVICE'.\n- The root filesystem is set to be read-only.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/24-shipping-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: shipping\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: shipping\n\n\n```\nSummary of sock-shop-2/manifests/24-shipping-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'shipping'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: shipping'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: shipping' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/25-user-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user\n  template:\n    metadata:\n      labels:\n        name: user\n    spec:\n      containers:\n      - name: user\n        image: weaveworksdemos/user:0.4.7\n        resources:\n          limits:\n            cpu: 300m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        env:\n        - name: mongo\n          value: user-db:27017\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/25-user-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/user:0.4.7'.\n- Resource limits are set for the container: 300m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container listens on port 80.\n- An environment variable 'mongo' is set with the value 'user-db:27017'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- The container has a read-only root filesystem and drops all capabilities except 'NET_BIND_SERVICE'.\n- Liveness and readiness probes are configured to check the '/health' endpoint on port 80, with initial delays of 300 and 180 seconds, respectively.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/26-user-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: user\n\n\n```\nSummary of sock-shop-2/manifests/26-user-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: user'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It uses a selector to target pods with the label 'name: user'.\n\nK8s manifest: sock-shop-2/manifests/27-user-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user-db\n  template:\n    metadata:\n      labels:\n        name: user-db\n    spec:\n      containers:\n      - name: user-db\n        image: weaveworksdemos/user-db:0.3.0\n\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/27-user-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user-db' pod running.\n- The pods are labeled with 'name: user-db' for identification and selection.\n- Each pod runs a single container using the image 'weaveworksdemos/user-db:0.3.0'.\n- The container exposes port 27017, which is typically used by MongoDB.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/28-user-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: user-db\n\n\n```\nSummary of sock-shop-2/manifests/28-user-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: user-db'.\n\nThe resiliency issues/weaknesses in the system are as follows:\nIssue #0: Missing Port Configuration\n  - details: The service does not specify the port it should serve on, which can lead to connectivity issues.\n  - manifests having the issues: ['sock-shop-2/manifests/02-carts-svc.yaml', 'sock-shop-2/manifests/04-carts-db-svc.yaml', 'sock-shop-2/manifests/06-catalogue-svc.yaml', 'sock-shop-2/manifests/08-catalogue-db-svc.yaml', 'sock-shop-2/manifests/12-orders-svc.yaml', 'sock-shop-2/manifests/14-orders-db-svc.yaml', 'sock-shop-2/manifests/16-payment-svc.yaml', 'sock-shop-2/manifests/18-queue-master-svc.yaml', 'sock-shop-2/manifests/22-session-db-svc.yaml', 'sock-shop-2/manifests/24-shipping-svc.yaml', 'sock-shop-2/manifests/26-user-svc.yaml', 'sock-shop-2/manifests/28-user-db-svc.yaml']\n  - problematic config: The 'ports' field in the Service spec is missing the 'port' configuration.\n\nIssue #1: Single Replica Deployment\n  - details: Having a single replica for a deployment can lead to downtime if the pod fails.\n  - manifests having the issues: ['sock-shop-2/manifests/09-front-end-dep.yaml']\n  - problematic config: The 'replicas' field is set to 1.\n\nIssue #2: High Initial Delay for Liveness Probe\n  - details: A high initial delay for the liveness probe can delay the detection of a non-responsive application.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/09-front-end-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the liveness probe is set to 300.\n\nIssue #3: High Initial Delay for Readiness Probe\n  - details: A high initial delay for the readiness probe can delay the application from being marked as ready, affecting service availability.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the readiness probe is set to 180.\n\nThe expected type of application on the system (i.e., K8s manfests):\nSock Shop is an e-commerce application that simulates an online sock store. It offers users the ability to browse a catalogue of socks, add items to a cart, place orders, and manage user accounts. The application is composed of multiple microservices, each responsible for a specific function within the e-commerce workflow, such as handling orders, managing user sessions, and processing payments.; The manifests provided are part of a well-known microservices demo application called 'Sock Shop'. This application is designed to demonstrate the use of microservices architecture and Kubernetes orchestration. The file names, labels, and images used in the manifests (e.g., 'weaveworksdemos') are indicative of the Sock Shop application, which simulates an e-commerce website for selling socks. The application includes various services such as carts, catalogue, orders, payment, and user management, each with its own database and service components, reflecting a typical e-commerce platform's architecture.\n\nSteady states of the network system defined by the manifests are the following:\n2 steady states are defined.\n1st steady states:\n- Name: CartsServiceEndpointsAvailable\n- Description: The first issue to address is the 'Missing Port Configuration' in the Service manifests. This issue is likely to cause connectivity problems, making it a critical aspect to verify. Among the manifests with this issue, 'sock-shop-2/manifests/02-carts-svc.yaml' is selected as it is the first in the list. The steady state will ensure that the Service is functioning correctly by checking the number of endpoints available for the 'carts' service, which should match the number of replicas in the corresponding Deployment.\n- Threshold for the steady state: At least 1 endpoint must be available for the 'carts' service 95% of the time during a 1-minute period, with a target of 2 endpoints available.; The steady state to be verified is the availability of endpoints for the 'carts' service, which should match the number of replicas specified in the corresponding Deployment. The Deployment for 'carts' specifies 2 replicas, and the current state shows that there are 2 endpoints available consistently over a period of 5 seconds. This indicates that the system is currently in a healthy state. To account for potential fluctuations and ensure the system remains resilient, a reasonable threshold should allow for a small tolerance. Given the redundancy with 2 replicas, the threshold can be set to require at least 1 endpoint to be available at all times, but ideally, both should be available. Additionally, the threshold should specify that this condition must be met for at least 95% of the time during the 1-minute chaos experiment, allowing for brief disruptions without failing the steady state check.\n- Whether the steady state meets the threshold is determined by the following Python script with K8s API:\n```\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\nfrom unittest_base import K8sAPIBase\n\nclass TestCartsServiceEndpoints(K8sAPIBase):\n    def __init__(self):\n        super().__init__()\n        self.apps_v1 = client.AppsV1Api()  # Initialize AppsV1Api\n        self.namespace = 'sock-shop'\n        self.service_name = 'carts'\n        self.deployment_name = 'carts'\n\n    def get_endpoints_count(self):\n        endpoints = self.v1.read_namespaced_endpoints(self.service_name, self.namespace)\n        return len(endpoints.subsets[0].addresses) if endpoints.subsets else 0\n\n    def get_replicas_count(self):\n        deployment = self.apps_v1.read_namespaced_deployment(self.deployment_name, self.namespace)  # Use AppsV1Api\n        return deployment.status.replicas\n\n    def test_endpoints_availability(self, duration):\n        success_count = 0\n        total_checks = duration\n\n        for _ in range(duration):\n            endpoints_count = self.get_endpoints_count()\n            replicas_count = self.get_replicas_count()\n            print(f'Endpoints available: {endpoints_count}, Expected replicas: {replicas_count}')\n\n            # Check if at least 1 endpoint is available\n            if endpoints_count >= 1:\n                success_count += 1\n\n            time.sleep(1)\n\n        # Calculate the success rate\n        success_rate = (success_count / total_checks) * 100\n        print(f'Success rate: {success_rate}%')\n\n        # Assert that the success rate is at least 95%\n        assert success_rate >= 95, f'Success rate {success_rate}% is below the threshold of 95%'\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Test Carts Service Endpoints Availability')\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the state in seconds')\n    args = parser.parse_args()\n\n    test = TestCartsServiceEndpoints()\n    test.test_endpoints_availability(args.duration)\n\n\nif __name__ == '__main__':\n    main()\n\n```2nd steady states:\n- Name: FrontEndLivenessProbeSuccess\n- Description: The next issue to address is the 'Single Replica Deployment' in the 'sock-shop-2/manifests/09-front-end-dep.yaml'. This issue is critical because having only one replica can lead to downtime if the pod fails. To ensure the system's resilience, we need to verify that the single replica of the 'front-end' deployment is always available. The steady state will check the availability of the 'front-end' pod by ensuring that the liveness probe is successful 95% of the time during a 1-minute period. This will help us confirm that the single replica is stable and responsive, even though it lacks redundancy.\n- Threshold for the steady state: The liveness probe for the 'front-end' pod must be successful at least 95% of the time during a 1-minute monitoring period.; The steady state to be verified is the availability of the 'front-end' pod, specifically ensuring that the liveness probe is successful 95% of the time during a 1-minute period. The current state shows a 100% success rate, which is above the required 95%. To account for fluctuations and ensure the system remains stable, we can set a threshold that allows for some tolerance. Given that the current success rate is 100%, setting the threshold at 95% is reasonable and ensures that the system is considered stable even if there are minor fluctuations. This threshold is also aligned with the requirement to complete the Chaos-Engineering experiment within 1 minute, as it allows for quick verification of the system's stability.\n- Whether the steady state meets the threshold is determined by the following Python script with K8s API:\n```\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\nfrom unittest_base import K8sAPIBase\n\nclass TestFrontEndLivenessProbe(K8sAPIBase):\n    def check_frontend_liveness(self, namespace, duration):\n        success_count = 0\n        total_checks = 0\n\n        for _ in range(duration):\n            # List pods with the label 'name=front-end' in the specified namespace\n            pods = self.v1.list_namespaced_pod(namespace=namespace, label_selector=\"name=front-end\").items\n            if pods:\n                pod = pods[0]\n                if pod.status.conditions:\n                    for condition in pod.status.conditions:\n                        if condition.type == \"Ready\" and condition.status == \"True\":\n                            success_count += 1\n                            break\n            total_checks += 1\n            time.sleep(1)\n\n        # Calculate the success rate of the liveness probe\n        success_rate = (success_count / total_checks) * 100\n        print(f\"Liveness Probe Success Rate: {success_rate}%\")\n        return success_rate\n\n    def test_liveness_probe_success_rate(self, namespace='sock-shop', duration=60):\n        # Check the liveness probe success rate\n        success_rate = self.check_frontend_liveness(namespace, duration)\n        # Assert that the success rate is at least 95%\n        assert success_rate >= 95, f\"Liveness probe success rate is below 95%: {success_rate}%\"\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Test Front-End Liveness Probe Success Rate')\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the liveness probe in seconds')\n    args = parser.parse_args()\n\n    # Create an instance of the test class\n    test_instance = TestFrontEndLivenessProbe()\n    # Run the test with the specified duration\n    test_instance.test_liveness_probe_success_rate(duration=args.duration)\n\n\nif __name__ == '__main__':\n    main()\n```\n\nPlease follow the instructions below regarding Chaos Engineering as necessary:\n- The Chaos-Engineering experiment must be completed within 1 minute.\n\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\n  1. http://front-end.sock-shop.svc.cluster.local/\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\n  4. http://front-end.sock-shop.svc.cluster.local/category/\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html\n\nNow, please define fault injections to reveal the system's vulnerabilities.\nAI: ```json\n{\"event\":"
            ],
            "{\"event\": \"Black Friday Sale\", \"thought\": \"During a Black Friday sale, the system is expected to handle a significant increase in traffic and load. This event will test the system's ability to maintain steady states under high demand. The 'CartsServiceEndpointsAvailable' steady state is crucial as it ensures the availability of the carts service, which is essential for users to add items to their cart. The 'FrontEndLivenessProbeSuccess' steady state is also critical as it ensures the front-end is responsive, allowing users to browse and make purchases. The system's weaknesses include missing port configurations, a single replica deployment for the front-end, and high initial delays for probes. To simulate the Black Friday event, we will first inject a 'StressChaos' fault to simulate high CPU usage on the 'carts' and 'front-end' pods, testing their ability to handle increased load. Next, we will inject a 'NetworkChaos' fault to simulate network latency, testing the system's resilience to network issues during high traffic. Finally, we will inject a 'PodChaos' fault to kill the single replica of the 'front-end' pod, testing the system's ability to recover from pod failures without redundancy.\", \"faults\": [[{\"name\": \"StressChaos\", \"name_id\": 0, \"scope\": {\"namespace\": \"sock-shop\", \"label\": \"name=carts\"}}, {\"name\": \"StressChaos\", \"name_id\": 1, \"scope\": {\"namespace\": \"sock-shop\", \"label\": \"name=front-end\"}}], [{\"name\": \"NetworkChaos\", \"name_id\": 0, \"scope\": {\"namespace\": \"sock-shop\", \"label\": \"name=front-end\"}}], [{\"name\": \"PodChaos\", \"name_id\": 0, \"scope\": {\"namespace\": \"sock-shop\", \"label\": \"name=front-end\"}}]]}\n"
        ]
    },
    {
        "name": "refine_fault_params",
        "token_usage": {
            "input_tokens": 61190,
            "output_tokens": 259,
            "total_tokens": 61449
        },
        "message_history": [
            [
                "System: You are a helpful AI assistant for Chaos Engineering.\nGiven k8s manifests that defines a network system, its steady states, and a fault type that may affect the steady states in the system, please detail the parameters of the fault.\nAlways keep the following rules:\n- Pay attention to namespace specification. If the namespace is specified in the manifest, it is deployed with the namespace. If not, it is deployed with the 'default' namespace.\n- The parameters follow the format of Chaos Mesh.\nHuman: Here is the overview of my system:\nThe system consists of the following K8s manifest(s):K8s manifest: sock-shop-2/manifests/00-sock-shop-ns.yaml\n```yaml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: sock-shop\n\n```\nSummary of sock-shop-2/manifests/00-sock-shop-ns.yaml:\n- This manifest defines a Kubernetes Namespace.\n- The Namespace is named 'sock-shop'.\n- Namespaces are used to organize and manage resources in a Kubernetes cluster.\n\nK8s manifest: sock-shop-2/manifests/01-carts-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts\n  template:\n    metadata:\n      labels:\n        name: carts\n    spec:\n      containers:\n      - name: carts\n        image: weaveworksdemos/carts:0.4.8\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/01-carts-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/carts:0.4.8'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 300m CPU and 500Mi memory, and a minimum of 100m CPU and 200Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities.\n- The root filesystem is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/02-carts-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: carts\n\n```\nSummary of sock-shop-2/manifests/02-carts-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The Service is named 'carts'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: carts'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: carts' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/03-carts-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts-db\n  template:\n    metadata:\n      labels:\n        name: carts-db\n    spec:\n      containers:\n      - name: carts-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/03-carts-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts-db' pod running.\n- The pods are selected based on the label 'name: carts-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add only CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/04-carts-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: carts-db\n\n```\nSummary of sock-shop-2/manifests/04-carts-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'carts-db'.\n- It is labeled with 'name: carts-db'.\n- The Service is created in the 'sock-shop' namespace.\n- It exposes port 27017 and directs traffic to the same port on the target pods.\n- The Service selects pods with the label 'name: carts-db' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/05-catalogue-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue\n  template:\n    metadata:\n      labels:\n        name: catalogue\n    spec:\n      containers:\n      - name: catalogue\n        image: weaveworksdemos/catalogue:0.3.5\n        command: [\"/app\"]\n        args:\n        - -port=80\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/05-catalogue-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/catalogue:0.3.5'.\n- The application runs with the command '/app' and listens on port 80.\n- Resource limits are set to 200m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container runs as a non-root user with user ID 10001 and has a read-only root filesystem.\n- Security settings drop all capabilities except 'NET_BIND_SERVICE'.\n- A liveness probe checks the '/health' endpoint on port 80, starting after 300 seconds and repeating every 3 seconds.\n- A readiness probe also checks the '/health' endpoint on port 80, starting after 180 seconds and repeating every 3 seconds.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/06-catalogue-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: catalogue\n\n```\nSummary of sock-shop-2/manifests/06-catalogue-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'catalogue'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: catalogue'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: catalogue'.\n\nK8s manifest: sock-shop-2/manifests/07-catalogue-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue-db\n  template:\n    metadata:\n      labels:\n        name: catalogue-db\n    spec:\n      containers:\n      - name: catalogue-db\n        image: weaveworksdemos/catalogue-db:0.3.0\n        env:\n          - name: MYSQL_ROOT_PASSWORD\n            value: fake_password\n          - name: MYSQL_DATABASE\n            value: socksdb\n        ports:\n        - name: mysql\n          containerPort: 3306\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/07-catalogue-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue-db' pod running.\n- The pods are selected based on the label 'name: catalogue-db'.\n- Each pod runs a single container using the image 'weaveworksdemos/catalogue-db:0.3.0'.\n- The container is configured with environment variables for 'MYSQL_ROOT_PASSWORD' and 'MYSQL_DATABASE'.\n- The container exposes port 3306, which is typically used for MySQL databases.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/08-catalogue-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 3306\n    targetPort: 3306\n  selector:\n    name: catalogue-db\n\n```\nSummary of sock-shop-2/manifests/08-catalogue-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'catalogue-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 3306.\n- It targets the same port (3306) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: catalogue-db'.\n- This setup is typically used to provide a stable endpoint for accessing a database running in the cluster.\n\nK8s manifest: sock-shop-2/manifests/09-front-end-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: front-end\n  namespace: sock-shop\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: front-end\n  template:\n    metadata:\n      labels:\n        name: front-end\n    spec:\n      containers:\n      - name: front-end\n        image: weaveworksdemos/front-end:0.3.12\n        resources:\n          limits:\n            cpu: 300m\n            memory: 1000Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 8079\n        env:\n        - name: SESSION_REDIS\n          value: \"true\"\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 30\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n```\nSummary of sock-shop-2/manifests/09-front-end-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'front-end' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 1 replica of the front-end application running.\n- The Deployment uses a selector to match pods with the label 'name: front-end'.\n- The pod template includes a single container named 'front-end'.\n- The container uses the image 'weaveworksdemos/front-end:0.3.12'.\n- Resource limits are set for the container: 300m CPU and 1000Mi memory.\n- Resource requests are set for the container: 100m CPU and 300Mi memory.\n- The container exposes port 8079.\n- An environment variable 'SESSION_REDIS' is set to 'true'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All Linux capabilities are dropped, and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/' path on port 8079, with an initial delay of 300 seconds and a period of 3 seconds.\n- A readiness probe is also configured to check the '/' path on port 8079, with an initial delay of 30 seconds and a period of 3 seconds.\n- The node selector ensures the pod runs on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/10-front-end-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: front-end\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: front-end\n  namespace: sock-shop\nspec:\n  type: NodePort\n  ports:\n  - port: 80\n    targetPort: 8079\n    nodePort: 30001\n  selector:\n    name: front-end\n\n```\nSummary of sock-shop-2/manifests/10-front-end-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'front-end'.\n- It is located in the 'sock-shop' namespace.\n- The Service type is 'NodePort', which exposes the service on each Node's IP at a static port.\n- It listens on port 80 and forwards traffic to target port 8079 on the pods.\n- The nodePort is set to 30001, which is the port on each node where the service can be accessed externally.\n- The Service is configured to be scraped by Prometheus for monitoring, as indicated by the annotation 'prometheus.io/scrape: true'.\n- It uses a selector to target pods with the label 'name: front-end'.\n\nK8s manifest: sock-shop-2/manifests/11-orders-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders\n  template:\n    metadata:\n      labels:\n        name: orders\n    spec:\n      containers:\n      - name: orders\n        image: weaveworksdemos/orders:0.4.7\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 500m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/11-orders-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/orders:0.4.7'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 500m CPU and 500Mi memory, and a minimum of 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities and a read-only root filesystem.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/12-orders-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: orders\n\n```\nSummary of sock-shop-2/manifests/12-orders-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: orders'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the target pods.\n- It uses a selector to match pods with the label 'name: orders'.\n\nK8s manifest: sock-shop-2/manifests/13-orders-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders-db\n  template:\n    metadata:\n      labels:\n        name: orders-db\n    spec:\n      containers:\n      - name: orders-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/13-orders-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders-db' pod running.\n- The pods are selected based on the label 'name: orders-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add specific ones like CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/14-orders-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: orders-db\n\n```\nSummary of sock-shop-2/manifests/14-orders-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods.\n- The Service selects pods with the label 'name: orders-db'.\n\nK8s manifest: sock-shop-2/manifests/15-payment-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: payment\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: payment\n  template:\n    metadata:\n      labels:\n        name: payment\n    spec:\n      containers:\n      - name: payment\n        image: weaveworksdemos/payment:0.4.3\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 99m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/15-payment-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'payment' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'payment' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/payment:0.4.3'.\n- Resource limits are set for the containers: 200m CPU and 200Mi memory.\n- Resource requests are set for the containers: 99m CPU and 100Mi memory.\n- The container exposes port 80.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All capabilities are dropped except 'NET_BIND_SERVICE', and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/health' endpoint on port 80, starting after 300 seconds and checking every 3 seconds.\n- A readiness probe is also configured to check the '/health' endpoint on port 80, starting after 180 seconds and checking every 3 seconds.\n- The Deployment is scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/16-payment-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: payment\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: payment\n\n```\nSummary of sock-shop-2/manifests/16-payment-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'payment'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: payment'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: payment'.\n\nK8s manifest: sock-shop-2/manifests/17-queue-master-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: queue-master\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: queue-master\n  template:\n    metadata:\n      labels:\n        name: queue-master\n    spec:\n      containers:\n      - name: queue-master\n        image: weaveworksdemos/queue-master:0.3.1\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/17-queue-master-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'queue-master' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'queue-master' pod running.\n- The pods are selected based on the label 'name: queue-master'.\n- Each pod runs a single container using the image 'weaveworksdemos/queue-master:0.3.1'.\n- The container is configured with specific Java options through environment variables.\n- Resource limits are set for the container, with a maximum of 300m CPU and 500Mi memory, and requests for 100m CPU and 300Mi memory.\n- The container exposes port 80.\n- The pods are scheduled on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/18-queue-master-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: queue-master\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: queue-master\n```\nSummary of sock-shop-2/manifests/18-queue-master-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'queue-master'.\n- It is annotated to enable Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: queue-master'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: queue-master' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/19-rabbitmq-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: rabbitmq\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: rabbitmq\n  template:\n    metadata:\n      labels:\n        name: rabbitmq\n      annotations:\n        prometheus.io/scrape: \"false\"\n    spec:\n      containers:\n      - name: rabbitmq\n        image: rabbitmq:3.6.8-management\n        ports:\n        - containerPort: 15672\n          name: management\n        - containerPort: 5672\n          name: rabbitmq\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n              - DAC_OVERRIDE\n          readOnlyRootFilesystem: true\n      - name: rabbitmq-exporter\n        image: kbudde/rabbitmq-exporter\n        ports:\n        - containerPort: 9090\n          name: exporter\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/19-rabbitmq-dep.yaml:\n- This manifest defines a Deployment for RabbitMQ in Kubernetes.\n- The Deployment is named 'rabbitmq' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas, meaning there will be 2 instances of RabbitMQ running.\n- The Deployment uses a label 'name: rabbitmq' to manage its pods.\n- The RabbitMQ container uses the image 'rabbitmq:3.6.8-management'.\n- It exposes two ports: 15672 for management and 5672 for RabbitMQ communication.\n- Security settings drop all capabilities but add CHOWN, SETGID, SETUID, and DAC_OVERRIDE, and the root filesystem is set to read-only.\n- An additional container, 'rabbitmq-exporter', is included for monitoring purposes, using the 'kbudde/rabbitmq-exporter' image and exposing port 9090.\n- The Deployment is configured to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/20-rabbitmq-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: rabbitmq\n  annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 5672\n    name: rabbitmq\n    targetPort: 5672\n  - port: 9090\n    name: exporter\n    targetPort: exporter\n    protocol: TCP\n  selector:\n    name: rabbitmq\n\n```\nSummary of sock-shop-2/manifests/20-rabbitmq-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'rabbitmq'.\n- It is annotated for Prometheus scraping on port 9090.\n- The Service is located in the 'sock-shop' namespace.\n- It exposes two ports: 5672 for RabbitMQ and 9090 for an exporter.\n- The Service uses TCP protocol for communication.\n- It selects pods with the label 'name: rabbitmq' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/21-session-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: session-db\n  template:\n    metadata:\n      labels:\n        name: session-db\n      annotations:\n        prometheus.io.scrape: \"false\"\n    spec:\n      containers:\n      - name: session-db\n        image: redis:alpine\n        ports:\n        - name: redis\n          containerPort: 6379\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/21-session-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'session-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'session-db' pod running.\n- The pods are selected based on the label 'name: session-db'.\n- Each pod runs a single container using the 'redis:alpine' image.\n- The container exposes port 6379, which is commonly used by Redis.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/22-session-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 6379\n    targetPort: 6379\n  selector:\n    name: session-db\n\n```\nSummary of sock-shop-2/manifests/22-session-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'session-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 6379.\n- It targets the same port (6379) on the selected pods.\n- The Service uses a selector to match pods with the label 'name: session-db'.\n\nK8s manifest: sock-shop-2/manifests/23-shipping-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: shipping\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: shipping\n  template:\n    metadata:\n      labels:\n        name: shipping\n    spec:\n      containers:\n      - name: shipping\n        image: weaveworksdemos/shipping:0.4.8\n        env:\n         - name: ZIPKIN\n           value: zipkin.jaeger.svc.cluster.local\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/23-shipping-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'shipping' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas of the 'shipping' application to be run.\n- The Deployment uses the Docker image 'weaveworksdemos/shipping:0.4.8'.\n- Environment variables are set for the application, including 'ZIPKIN' and 'JAVA_OPTS'.\n- Resource limits and requests are defined, with CPU limits at 300m and memory limits at 500Mi, and requests at 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with user ID 10001, and it drops all capabilities except 'NET_BIND_SERVICE'.\n- The root filesystem is set to be read-only.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/24-shipping-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: shipping\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: shipping\n\n\n```\nSummary of sock-shop-2/manifests/24-shipping-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'shipping'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: shipping'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: shipping' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/25-user-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user\n  template:\n    metadata:\n      labels:\n        name: user\n    spec:\n      containers:\n      - name: user\n        image: weaveworksdemos/user:0.4.7\n        resources:\n          limits:\n            cpu: 300m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        env:\n        - name: mongo\n          value: user-db:27017\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/25-user-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/user:0.4.7'.\n- Resource limits are set for the container: 300m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container listens on port 80.\n- An environment variable 'mongo' is set with the value 'user-db:27017'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- The container has a read-only root filesystem and drops all capabilities except 'NET_BIND_SERVICE'.\n- Liveness and readiness probes are configured to check the '/health' endpoint on port 80, with initial delays of 300 and 180 seconds, respectively.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/26-user-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: user\n\n\n```\nSummary of sock-shop-2/manifests/26-user-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: user'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It uses a selector to target pods with the label 'name: user'.\n\nK8s manifest: sock-shop-2/manifests/27-user-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user-db\n  template:\n    metadata:\n      labels:\n        name: user-db\n    spec:\n      containers:\n      - name: user-db\n        image: weaveworksdemos/user-db:0.3.0\n\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/27-user-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user-db' pod running.\n- The pods are labeled with 'name: user-db' for identification and selection.\n- Each pod runs a single container using the image 'weaveworksdemos/user-db:0.3.0'.\n- The container exposes port 27017, which is typically used by MongoDB.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/28-user-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: user-db\n\n\n```\nSummary of sock-shop-2/manifests/28-user-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: user-db'.\n\nThe resiliency issues/weaknesses in the system are as follows:\nIssue #0: Missing Port Configuration\n  - details: The service does not specify the port it should serve on, which can lead to connectivity issues.\n  - manifests having the issues: ['sock-shop-2/manifests/02-carts-svc.yaml', 'sock-shop-2/manifests/04-carts-db-svc.yaml', 'sock-shop-2/manifests/06-catalogue-svc.yaml', 'sock-shop-2/manifests/08-catalogue-db-svc.yaml', 'sock-shop-2/manifests/12-orders-svc.yaml', 'sock-shop-2/manifests/14-orders-db-svc.yaml', 'sock-shop-2/manifests/16-payment-svc.yaml', 'sock-shop-2/manifests/18-queue-master-svc.yaml', 'sock-shop-2/manifests/22-session-db-svc.yaml', 'sock-shop-2/manifests/24-shipping-svc.yaml', 'sock-shop-2/manifests/26-user-svc.yaml', 'sock-shop-2/manifests/28-user-db-svc.yaml']\n  - problematic config: The 'ports' field in the Service spec is missing the 'port' configuration.\n\nIssue #1: Single Replica Deployment\n  - details: Having a single replica for a deployment can lead to downtime if the pod fails.\n  - manifests having the issues: ['sock-shop-2/manifests/09-front-end-dep.yaml']\n  - problematic config: The 'replicas' field is set to 1.\n\nIssue #2: High Initial Delay for Liveness Probe\n  - details: A high initial delay for the liveness probe can delay the detection of a non-responsive application.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/09-front-end-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the liveness probe is set to 300.\n\nIssue #3: High Initial Delay for Readiness Probe\n  - details: A high initial delay for the readiness probe can delay the application from being marked as ready, affecting service availability.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the readiness probe is set to 180.\n\nThe expected type of application on the system (i.e., K8s manfests):\nSock Shop is an e-commerce application that simulates an online sock store. It offers users the ability to browse a catalogue of socks, add items to a cart, place orders, and manage user accounts. The application is composed of multiple microservices, each responsible for a specific function within the e-commerce workflow, such as handling orders, managing user sessions, and processing payments.; The manifests provided are part of a well-known microservices demo application called 'Sock Shop'. This application is designed to demonstrate the use of microservices architecture and Kubernetes orchestration. The file names, labels, and images used in the manifests (e.g., 'weaveworksdemos') are indicative of the Sock Shop application, which simulates an e-commerce website for selling socks. The application includes various services such as carts, catalogue, orders, payment, and user management, each with its own database and service components, reflecting a typical e-commerce platform's architecture.\n\nSteady states of my system:\n2 steady states are defined.\n1st steady states:\n- Name: CartsServiceEndpointsAvailable\n- Description: The first issue to address is the 'Missing Port Configuration' in the Service manifests. This issue is likely to cause connectivity problems, making it a critical aspect to verify. Among the manifests with this issue, 'sock-shop-2/manifests/02-carts-svc.yaml' is selected as it is the first in the list. The steady state will ensure that the Service is functioning correctly by checking the number of endpoints available for the 'carts' service, which should match the number of replicas in the corresponding Deployment.\n- Threshold for the steady state: At least 1 endpoint must be available for the 'carts' service 95% of the time during a 1-minute period, with a target of 2 endpoints available.; The steady state to be verified is the availability of endpoints for the 'carts' service, which should match the number of replicas specified in the corresponding Deployment. The Deployment for 'carts' specifies 2 replicas, and the current state shows that there are 2 endpoints available consistently over a period of 5 seconds. This indicates that the system is currently in a healthy state. To account for potential fluctuations and ensure the system remains resilient, a reasonable threshold should allow for a small tolerance. Given the redundancy with 2 replicas, the threshold can be set to require at least 1 endpoint to be available at all times, but ideally, both should be available. Additionally, the threshold should specify that this condition must be met for at least 95% of the time during the 1-minute chaos experiment, allowing for brief disruptions without failing the steady state check.\n- Whether the steady state meets the threshold is determined by the following Python script with K8s API:\n```\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\nfrom unittest_base import K8sAPIBase\n\nclass TestCartsServiceEndpoints(K8sAPIBase):\n    def __init__(self):\n        super().__init__()\n        self.apps_v1 = client.AppsV1Api()  # Initialize AppsV1Api\n        self.namespace = 'sock-shop'\n        self.service_name = 'carts'\n        self.deployment_name = 'carts'\n\n    def get_endpoints_count(self):\n        endpoints = self.v1.read_namespaced_endpoints(self.service_name, self.namespace)\n        return len(endpoints.subsets[0].addresses) if endpoints.subsets else 0\n\n    def get_replicas_count(self):\n        deployment = self.apps_v1.read_namespaced_deployment(self.deployment_name, self.namespace)  # Use AppsV1Api\n        return deployment.status.replicas\n\n    def test_endpoints_availability(self, duration):\n        success_count = 0\n        total_checks = duration\n\n        for _ in range(duration):\n            endpoints_count = self.get_endpoints_count()\n            replicas_count = self.get_replicas_count()\n            print(f'Endpoints available: {endpoints_count}, Expected replicas: {replicas_count}')\n\n            # Check if at least 1 endpoint is available\n            if endpoints_count >= 1:\n                success_count += 1\n\n            time.sleep(1)\n\n        # Calculate the success rate\n        success_rate = (success_count / total_checks) * 100\n        print(f'Success rate: {success_rate}%')\n\n        # Assert that the success rate is at least 95%\n        assert success_rate >= 95, f'Success rate {success_rate}% is below the threshold of 95%'\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Test Carts Service Endpoints Availability')\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the state in seconds')\n    args = parser.parse_args()\n\n    test = TestCartsServiceEndpoints()\n    test.test_endpoints_availability(args.duration)\n\n\nif __name__ == '__main__':\n    main()\n\n```2nd steady states:\n- Name: FrontEndLivenessProbeSuccess\n- Description: The next issue to address is the 'Single Replica Deployment' in the 'sock-shop-2/manifests/09-front-end-dep.yaml'. This issue is critical because having only one replica can lead to downtime if the pod fails. To ensure the system's resilience, we need to verify that the single replica of the 'front-end' deployment is always available. The steady state will check the availability of the 'front-end' pod by ensuring that the liveness probe is successful 95% of the time during a 1-minute period. This will help us confirm that the single replica is stable and responsive, even though it lacks redundancy.\n- Threshold for the steady state: The liveness probe for the 'front-end' pod must be successful at least 95% of the time during a 1-minute monitoring period.; The steady state to be verified is the availability of the 'front-end' pod, specifically ensuring that the liveness probe is successful 95% of the time during a 1-minute period. The current state shows a 100% success rate, which is above the required 95%. To account for fluctuations and ensure the system remains stable, we can set a threshold that allows for some tolerance. Given that the current success rate is 100%, setting the threshold at 95% is reasonable and ensures that the system is considered stable even if there are minor fluctuations. This threshold is also aligned with the requirement to complete the Chaos-Engineering experiment within 1 minute, as it allows for quick verification of the system's stability.\n- Whether the steady state meets the threshold is determined by the following Python script with K8s API:\n```\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\nfrom unittest_base import K8sAPIBase\n\nclass TestFrontEndLivenessProbe(K8sAPIBase):\n    def check_frontend_liveness(self, namespace, duration):\n        success_count = 0\n        total_checks = 0\n\n        for _ in range(duration):\n            # List pods with the label 'name=front-end' in the specified namespace\n            pods = self.v1.list_namespaced_pod(namespace=namespace, label_selector=\"name=front-end\").items\n            if pods:\n                pod = pods[0]\n                if pod.status.conditions:\n                    for condition in pod.status.conditions:\n                        if condition.type == \"Ready\" and condition.status == \"True\":\n                            success_count += 1\n                            break\n            total_checks += 1\n            time.sleep(1)\n\n        # Calculate the success rate of the liveness probe\n        success_rate = (success_count / total_checks) * 100\n        print(f\"Liveness Probe Success Rate: {success_rate}%\")\n        return success_rate\n\n    def test_liveness_probe_success_rate(self, namespace='sock-shop', duration=60):\n        # Check the liveness probe success rate\n        success_rate = self.check_frontend_liveness(namespace, duration)\n        # Assert that the success rate is at least 95%\n        assert success_rate >= 95, f\"Liveness probe success rate is below 95%: {success_rate}%\"\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Test Front-End Liveness Probe Success Rate')\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the liveness probe in seconds')\n    args = parser.parse_args()\n\n    # Create an instance of the test class\n    test_instance = TestFrontEndLivenessProbe()\n    # Run the test with the specified duration\n    test_instance.test_liveness_probe_success_rate(duration=args.duration)\n\n\nif __name__ == '__main__':\n    main()\n```\n\nA fault scenario that may occur in my system and may affect the steady states:\n\nAn assumed fault scenario is as follows:\n- Event: Black Friday Sale\n- Used Chaos Engineering tool: Chaos Mesh\n- Faults to simulate the event: [[{'name': 'StressChaos', 'name_id': 0, 'scope': {'namespace': 'sock-shop', 'label': 'name=carts'}}, {'name': 'StressChaos', 'name_id': 1, 'scope': {'namespace': 'sock-shop', 'label': 'name=front-end'}}], [{'name': 'NetworkChaos', 'name_id': 0, 'scope': {'namespace': 'sock-shop', 'label': 'name=front-end'}}], [{'name': 'PodChaos', 'name_id': 0, 'scope': {'namespace': 'sock-shop', 'label': 'name=front-end'}}]]\n- Description: During a Black Friday sale, the system is expected to handle a significant increase in traffic and load. This event will test the system's ability to maintain steady states under high demand. The 'CartsServiceEndpointsAvailable' steady state is crucial as it ensures the availability of the carts service, which is essential for users to add items to their cart. The 'FrontEndLivenessProbeSuccess' steady state is also critical as it ensures the front-end is responsive, allowing users to browse and make purchases. The system's weaknesses include missing port configurations, a single replica deployment for the front-end, and high initial delays for probes. To simulate the Black Friday event, we will first inject a 'StressChaos' fault to simulate high CPU usage on the 'carts' and 'front-end' pods, testing their ability to handle increased load. Next, we will inject a 'NetworkChaos' fault to simulate network latency, testing the system's resilience to network issues during high traffic. Finally, we will inject a 'PodChaos' fault to kill the single replica of the 'front-end' pod, testing the system's ability to recover from pod failures without redundancy.\n\nPlease follow the instructions below regarding Chaos Engineering as necessary:\n- The Chaos-Engineering experiment must be completed within 1 minute.\n\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\n  1. http://front-end.sock-shop.svc.cluster.local/\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\n  4. http://front-end.sock-shop.svc.cluster.local/category/\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html\n\nNow, please detail the parameters of the fault \"StressChaos({'namespace': 'sock-shop', 'label': 'name=carts'})\".\nThe output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"mode\": {\"title\": \"Mode\", \"description\": \"Specifies the mode of the experiment. The mode options include 'one' (selecting a random Pod), 'all' (selecting all eligible Pods), 'fixed' (selecting a specified number of eligible Pods), 'fixed-percent' (selecting a specified percentage of Pods from the eligible Pods), and 'random-max-percent' (selecting the maximum percentage of Pods from the eligible Pods)\", \"example\": \"one\", \"enum\": [\"one\", \"all\", \"fixed\", \"fixed-percent\", \"random-max-percent\"], \"type\": \"string\"}, \"value\": {\"title\": \"Value\", \"description\": \"Provides parameters for the mode configuration, depending on mode.For example, when mode is set to fixed-percent, value specifies the percentage of Pods.\", \"example\": \"1\", \"type\": \"string\"}, \"stressors\": {\"title\": \"Stressors\", \"description\": \"Specifies the stress of CPU or memory\", \"dafault\": null, \"allOf\": [{\"$ref\": \"#/definitions/Stressors\"}]}, \"stressngStressors\": {\"title\": \"Stressngstressors\", \"description\": \"Specifies the stres-ng parameter to reach richer stress injection\", \"example\": \"--clone 2\", \"type\": \"string\"}, \"containerNames\": {\"title\": \"Containernames\", \"description\": \"Specifies the name of the container into which the fault is injected.\", \"example\": [\"nginx\"], \"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"selector\": {\"title\": \"Selector\", \"description\": \"Specifies the target Pod.\", \"allOf\": [{\"$ref\": \"#/definitions/Selectors\"}]}}, \"required\": [\"mode\", \"selector\"], \"definitions\": {\"MemoryStressor\": {\"title\": \"MemoryStressor\", \"type\": \"object\", \"properties\": {\"workers\": {\"title\": \"Workers\", \"description\": \"Specifies the number of threads that apply memory stress\", \"example\": 1, \"type\": \"integer\"}, \"size\": {\"title\": \"Size\", \"description\": \"Specifies the memory size to be occupied or a percentage of the total memory size. The final sum of the occupied memory size is size.\", \"example\": \"256MB\", \"type\": \"string\"}, \"oomScoreAdj\": {\"title\": \"Oomscoreadj\", \"description\": \"Specifies the oom_score_adj of the stress process.\", \"example\": -1000, \"type\": \"integer\"}}}, \"CPUStressor\": {\"title\": \"CPUStressor\", \"type\": \"object\", \"properties\": {\"workers\": {\"title\": \"Workers\", \"description\": \"Specifies the number of threads that apply CPU stress\", \"example\": 1, \"type\": \"integer\"}, \"load\": {\"title\": \"Load\", \"description\": \"Specifies the percentage of CPU occupied. 0 means that no additional CPU is added, and 100 refers to full load. The final sum of CPU load is workers * load.\", \"example\": 50, \"type\": \"integer\"}}}, \"Stressors\": {\"title\": \"Stressors\", \"type\": \"object\", \"properties\": {\"memory\": {\"title\": \"Memory\", \"description\": \"Specifies the memory stress\", \"allOf\": [{\"$ref\": \"#/definitions/MemoryStressor\"}]}, \"cpu\": {\"title\": \"Cpu\", \"description\": \"Specifies the CPU stress\", \"allOf\": [{\"$ref\": \"#/definitions/CPUStressor\"}]}}}, \"SetBasedRequirements\": {\"title\": \"SetBasedRequirements\", \"type\": \"object\", \"properties\": {\"key\": {\"title\": \"Key\", \"description\": \"Label key\", \"type\": \"string\"}, \"operator\": {\"title\": \"Operator\", \"description\": \"Select an operator.\", \"enum\": [\"In\", \"NotIn\", \"Exists\", \"DoesNotExist\"], \"type\": \"string\"}, \"values\": {\"title\": \"Values\", \"description\": \"Label values. The values set must be non-empty in the case of In and NotIn.\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"key\", \"operator\", \"values\"]}, \"Selectors\": {\"title\": \"Selectors\", \"type\": \"object\", \"properties\": {\"namespaces\": {\"title\": \"Namespaces\", \"description\": \"Specifies the namespace of the experiment's target Pod. If this selector is None, Chaos Mesh will set it to the namespace of the current Chaos experiment.\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"labelSelectors\": {\"title\": \"Labelselectors\", \"description\": \"Specifies the label-key/value pairs that the experiment's target Pod must have. If multiple labels are specified, the experiment target must have all the labels specified by this selector.\", \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"expressionSelectors\": {\"title\": \"Expressionselectors\", \"description\": \"Specifies a set of expressions that define the label's rules to specifiy the experiment's target Pod.\", \"example\": [{\"key\": \"tier\", \"operator\": \"In\", \"values\": [\"cache\"]}, {\"key\": \"environment\", \"operator\": \"NotIn\", \"values\": [\"dev\"]}], \"type\": \"array\", \"items\": {\"$ref\": \"#/definitions/SetBasedRequirements\"}}, \"annotationSelectors\": {\"title\": \"Annotationselectors\", \"description\": \"Specifies the annotation-key/value pairs that the experiment's target Pod must have. If multiple annotations are specified, the experiment target must have all annotations specified by this selector.\", \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"fieldSelectors\": {\"title\": \"Fieldselectors\", \"description\": \"Specifies the field-key/value pairs of the experiment's target Pod. If multiple fields are specified, the experiment target must have all fields set by this selector.\", \"example\": {\"metadata.name\": \"my-pod\", \"metadata.namespace\": \"dafault\"}, \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"podPhaseSelectors\": {\"title\": \"Podphaseselectors\", \"description\": \"Specifies the phase of the experiment's target Pod. If this selector is None, the target Pod's phase is not limited.\", \"type\": \"array\", \"items\": {\"enum\": [\"Pending\", \"Running\", \"Succeeded\", \"Failed\", \"Unknown\"], \"type\": \"string\"}}, \"nodeSelectors\": {\"title\": \"Nodeselectors\", \"description\": \"Specifies the node-label-key/value pairs to which the experiment's target Pod belongs.\", \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"nodes\": {\"title\": \"Nodes\", \"description\": \"Specifies the node to which the experiment's target Pod belongs. The target Pod can only belong to one node in the configured node list. If multiple node labels are specified, the node to which the experiment's target Pod belongs must have all labels specified by this selector.\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"pods\": {\"title\": \"Pods\", \"description\": \"Specifies the namespaces and list of the experiment's target Pods. If you have specified this selector, Chaos Mesh ignores other configured selectors.\", \"example\": {\"default\": [\"pod-0\", \"pod-2\"]}, \"type\": \"object\", \"additionalProperties\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}}}\n```\nAI: ```json\n{\"mode\":"
            ],
            "{\"mode\": \"all\", \"value\": \"2\", \"stressors\": {\"cpu\": {\"workers\": 2, \"load\": 100}}, \"stressngStressors\": \"\", \"containerNames\": [\"carts\"], \"selector\": {\"namespaces\": [\"sock-shop\"], \"labelSelectors\": {\"name\": \"carts\"}}}",
            [
                "System: You are a helpful AI assistant for Chaos Engineering.\nGiven k8s manifests that defines a network system, its steady states, and a fault type that may affect the steady states in the system, please detail the parameters of the fault.\nAlways keep the following rules:\n- Pay attention to namespace specification. If the namespace is specified in the manifest, it is deployed with the namespace. If not, it is deployed with the 'default' namespace.\n- The parameters follow the format of Chaos Mesh.\nHuman: Here is the overview of my system:\nThe system consists of the following K8s manifest(s):K8s manifest: sock-shop-2/manifests/00-sock-shop-ns.yaml\n```yaml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: sock-shop\n\n```\nSummary of sock-shop-2/manifests/00-sock-shop-ns.yaml:\n- This manifest defines a Kubernetes Namespace.\n- The Namespace is named 'sock-shop'.\n- Namespaces are used to organize and manage resources in a Kubernetes cluster.\n\nK8s manifest: sock-shop-2/manifests/01-carts-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts\n  template:\n    metadata:\n      labels:\n        name: carts\n    spec:\n      containers:\n      - name: carts\n        image: weaveworksdemos/carts:0.4.8\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/01-carts-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/carts:0.4.8'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 300m CPU and 500Mi memory, and a minimum of 100m CPU and 200Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities.\n- The root filesystem is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/02-carts-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: carts\n\n```\nSummary of sock-shop-2/manifests/02-carts-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The Service is named 'carts'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: carts'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: carts' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/03-carts-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts-db\n  template:\n    metadata:\n      labels:\n        name: carts-db\n    spec:\n      containers:\n      - name: carts-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/03-carts-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts-db' pod running.\n- The pods are selected based on the label 'name: carts-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add only CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/04-carts-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: carts-db\n\n```\nSummary of sock-shop-2/manifests/04-carts-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'carts-db'.\n- It is labeled with 'name: carts-db'.\n- The Service is created in the 'sock-shop' namespace.\n- It exposes port 27017 and directs traffic to the same port on the target pods.\n- The Service selects pods with the label 'name: carts-db' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/05-catalogue-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue\n  template:\n    metadata:\n      labels:\n        name: catalogue\n    spec:\n      containers:\n      - name: catalogue\n        image: weaveworksdemos/catalogue:0.3.5\n        command: [\"/app\"]\n        args:\n        - -port=80\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/05-catalogue-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/catalogue:0.3.5'.\n- The application runs with the command '/app' and listens on port 80.\n- Resource limits are set to 200m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container runs as a non-root user with user ID 10001 and has a read-only root filesystem.\n- Security settings drop all capabilities except 'NET_BIND_SERVICE'.\n- A liveness probe checks the '/health' endpoint on port 80, starting after 300 seconds and repeating every 3 seconds.\n- A readiness probe also checks the '/health' endpoint on port 80, starting after 180 seconds and repeating every 3 seconds.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/06-catalogue-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: catalogue\n\n```\nSummary of sock-shop-2/manifests/06-catalogue-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'catalogue'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: catalogue'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: catalogue'.\n\nK8s manifest: sock-shop-2/manifests/07-catalogue-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue-db\n  template:\n    metadata:\n      labels:\n        name: catalogue-db\n    spec:\n      containers:\n      - name: catalogue-db\n        image: weaveworksdemos/catalogue-db:0.3.0\n        env:\n          - name: MYSQL_ROOT_PASSWORD\n            value: fake_password\n          - name: MYSQL_DATABASE\n            value: socksdb\n        ports:\n        - name: mysql\n          containerPort: 3306\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/07-catalogue-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue-db' pod running.\n- The pods are selected based on the label 'name: catalogue-db'.\n- Each pod runs a single container using the image 'weaveworksdemos/catalogue-db:0.3.0'.\n- The container is configured with environment variables for 'MYSQL_ROOT_PASSWORD' and 'MYSQL_DATABASE'.\n- The container exposes port 3306, which is typically used for MySQL databases.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/08-catalogue-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 3306\n    targetPort: 3306\n  selector:\n    name: catalogue-db\n\n```\nSummary of sock-shop-2/manifests/08-catalogue-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'catalogue-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 3306.\n- It targets the same port (3306) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: catalogue-db'.\n- This setup is typically used to provide a stable endpoint for accessing a database running in the cluster.\n\nK8s manifest: sock-shop-2/manifests/09-front-end-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: front-end\n  namespace: sock-shop\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: front-end\n  template:\n    metadata:\n      labels:\n        name: front-end\n    spec:\n      containers:\n      - name: front-end\n        image: weaveworksdemos/front-end:0.3.12\n        resources:\n          limits:\n            cpu: 300m\n            memory: 1000Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 8079\n        env:\n        - name: SESSION_REDIS\n          value: \"true\"\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 30\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n```\nSummary of sock-shop-2/manifests/09-front-end-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'front-end' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 1 replica of the front-end application running.\n- The Deployment uses a selector to match pods with the label 'name: front-end'.\n- The pod template includes a single container named 'front-end'.\n- The container uses the image 'weaveworksdemos/front-end:0.3.12'.\n- Resource limits are set for the container: 300m CPU and 1000Mi memory.\n- Resource requests are set for the container: 100m CPU and 300Mi memory.\n- The container exposes port 8079.\n- An environment variable 'SESSION_REDIS' is set to 'true'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All Linux capabilities are dropped, and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/' path on port 8079, with an initial delay of 300 seconds and a period of 3 seconds.\n- A readiness probe is also configured to check the '/' path on port 8079, with an initial delay of 30 seconds and a period of 3 seconds.\n- The node selector ensures the pod runs on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/10-front-end-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: front-end\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: front-end\n  namespace: sock-shop\nspec:\n  type: NodePort\n  ports:\n  - port: 80\n    targetPort: 8079\n    nodePort: 30001\n  selector:\n    name: front-end\n\n```\nSummary of sock-shop-2/manifests/10-front-end-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'front-end'.\n- It is located in the 'sock-shop' namespace.\n- The Service type is 'NodePort', which exposes the service on each Node's IP at a static port.\n- It listens on port 80 and forwards traffic to target port 8079 on the pods.\n- The nodePort is set to 30001, which is the port on each node where the service can be accessed externally.\n- The Service is configured to be scraped by Prometheus for monitoring, as indicated by the annotation 'prometheus.io/scrape: true'.\n- It uses a selector to target pods with the label 'name: front-end'.\n\nK8s manifest: sock-shop-2/manifests/11-orders-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders\n  template:\n    metadata:\n      labels:\n        name: orders\n    spec:\n      containers:\n      - name: orders\n        image: weaveworksdemos/orders:0.4.7\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 500m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/11-orders-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/orders:0.4.7'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 500m CPU and 500Mi memory, and a minimum of 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities and a read-only root filesystem.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/12-orders-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: orders\n\n```\nSummary of sock-shop-2/manifests/12-orders-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: orders'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the target pods.\n- It uses a selector to match pods with the label 'name: orders'.\n\nK8s manifest: sock-shop-2/manifests/13-orders-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders-db\n  template:\n    metadata:\n      labels:\n        name: orders-db\n    spec:\n      containers:\n      - name: orders-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/13-orders-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders-db' pod running.\n- The pods are selected based on the label 'name: orders-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add specific ones like CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/14-orders-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: orders-db\n\n```\nSummary of sock-shop-2/manifests/14-orders-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods.\n- The Service selects pods with the label 'name: orders-db'.\n\nK8s manifest: sock-shop-2/manifests/15-payment-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: payment\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: payment\n  template:\n    metadata:\n      labels:\n        name: payment\n    spec:\n      containers:\n      - name: payment\n        image: weaveworksdemos/payment:0.4.3\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 99m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/15-payment-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'payment' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'payment' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/payment:0.4.3'.\n- Resource limits are set for the containers: 200m CPU and 200Mi memory.\n- Resource requests are set for the containers: 99m CPU and 100Mi memory.\n- The container exposes port 80.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All capabilities are dropped except 'NET_BIND_SERVICE', and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/health' endpoint on port 80, starting after 300 seconds and checking every 3 seconds.\n- A readiness probe is also configured to check the '/health' endpoint on port 80, starting after 180 seconds and checking every 3 seconds.\n- The Deployment is scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/16-payment-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: payment\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: payment\n\n```\nSummary of sock-shop-2/manifests/16-payment-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'payment'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: payment'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: payment'.\n\nK8s manifest: sock-shop-2/manifests/17-queue-master-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: queue-master\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: queue-master\n  template:\n    metadata:\n      labels:\n        name: queue-master\n    spec:\n      containers:\n      - name: queue-master\n        image: weaveworksdemos/queue-master:0.3.1\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/17-queue-master-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'queue-master' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'queue-master' pod running.\n- The pods are selected based on the label 'name: queue-master'.\n- Each pod runs a single container using the image 'weaveworksdemos/queue-master:0.3.1'.\n- The container is configured with specific Java options through environment variables.\n- Resource limits are set for the container, with a maximum of 300m CPU and 500Mi memory, and requests for 100m CPU and 300Mi memory.\n- The container exposes port 80.\n- The pods are scheduled on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/18-queue-master-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: queue-master\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: queue-master\n```\nSummary of sock-shop-2/manifests/18-queue-master-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'queue-master'.\n- It is annotated to enable Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: queue-master'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: queue-master' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/19-rabbitmq-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: rabbitmq\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: rabbitmq\n  template:\n    metadata:\n      labels:\n        name: rabbitmq\n      annotations:\n        prometheus.io/scrape: \"false\"\n    spec:\n      containers:\n      - name: rabbitmq\n        image: rabbitmq:3.6.8-management\n        ports:\n        - containerPort: 15672\n          name: management\n        - containerPort: 5672\n          name: rabbitmq\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n              - DAC_OVERRIDE\n          readOnlyRootFilesystem: true\n      - name: rabbitmq-exporter\n        image: kbudde/rabbitmq-exporter\n        ports:\n        - containerPort: 9090\n          name: exporter\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/19-rabbitmq-dep.yaml:\n- This manifest defines a Deployment for RabbitMQ in Kubernetes.\n- The Deployment is named 'rabbitmq' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas, meaning there will be 2 instances of RabbitMQ running.\n- The Deployment uses a label 'name: rabbitmq' to manage its pods.\n- The RabbitMQ container uses the image 'rabbitmq:3.6.8-management'.\n- It exposes two ports: 15672 for management and 5672 for RabbitMQ communication.\n- Security settings drop all capabilities but add CHOWN, SETGID, SETUID, and DAC_OVERRIDE, and the root filesystem is set to read-only.\n- An additional container, 'rabbitmq-exporter', is included for monitoring purposes, using the 'kbudde/rabbitmq-exporter' image and exposing port 9090.\n- The Deployment is configured to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/20-rabbitmq-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: rabbitmq\n  annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 5672\n    name: rabbitmq\n    targetPort: 5672\n  - port: 9090\n    name: exporter\n    targetPort: exporter\n    protocol: TCP\n  selector:\n    name: rabbitmq\n\n```\nSummary of sock-shop-2/manifests/20-rabbitmq-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'rabbitmq'.\n- It is annotated for Prometheus scraping on port 9090.\n- The Service is located in the 'sock-shop' namespace.\n- It exposes two ports: 5672 for RabbitMQ and 9090 for an exporter.\n- The Service uses TCP protocol for communication.\n- It selects pods with the label 'name: rabbitmq' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/21-session-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: session-db\n  template:\n    metadata:\n      labels:\n        name: session-db\n      annotations:\n        prometheus.io.scrape: \"false\"\n    spec:\n      containers:\n      - name: session-db\n        image: redis:alpine\n        ports:\n        - name: redis\n          containerPort: 6379\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/21-session-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'session-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'session-db' pod running.\n- The pods are selected based on the label 'name: session-db'.\n- Each pod runs a single container using the 'redis:alpine' image.\n- The container exposes port 6379, which is commonly used by Redis.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/22-session-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 6379\n    targetPort: 6379\n  selector:\n    name: session-db\n\n```\nSummary of sock-shop-2/manifests/22-session-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'session-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 6379.\n- It targets the same port (6379) on the selected pods.\n- The Service uses a selector to match pods with the label 'name: session-db'.\n\nK8s manifest: sock-shop-2/manifests/23-shipping-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: shipping\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: shipping\n  template:\n    metadata:\n      labels:\n        name: shipping\n    spec:\n      containers:\n      - name: shipping\n        image: weaveworksdemos/shipping:0.4.8\n        env:\n         - name: ZIPKIN\n           value: zipkin.jaeger.svc.cluster.local\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/23-shipping-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'shipping' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas of the 'shipping' application to be run.\n- The Deployment uses the Docker image 'weaveworksdemos/shipping:0.4.8'.\n- Environment variables are set for the application, including 'ZIPKIN' and 'JAVA_OPTS'.\n- Resource limits and requests are defined, with CPU limits at 300m and memory limits at 500Mi, and requests at 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with user ID 10001, and it drops all capabilities except 'NET_BIND_SERVICE'.\n- The root filesystem is set to be read-only.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/24-shipping-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: shipping\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: shipping\n\n\n```\nSummary of sock-shop-2/manifests/24-shipping-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'shipping'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: shipping'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: shipping' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/25-user-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user\n  template:\n    metadata:\n      labels:\n        name: user\n    spec:\n      containers:\n      - name: user\n        image: weaveworksdemos/user:0.4.7\n        resources:\n          limits:\n            cpu: 300m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        env:\n        - name: mongo\n          value: user-db:27017\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/25-user-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/user:0.4.7'.\n- Resource limits are set for the container: 300m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container listens on port 80.\n- An environment variable 'mongo' is set with the value 'user-db:27017'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- The container has a read-only root filesystem and drops all capabilities except 'NET_BIND_SERVICE'.\n- Liveness and readiness probes are configured to check the '/health' endpoint on port 80, with initial delays of 300 and 180 seconds, respectively.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/26-user-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: user\n\n\n```\nSummary of sock-shop-2/manifests/26-user-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: user'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It uses a selector to target pods with the label 'name: user'.\n\nK8s manifest: sock-shop-2/manifests/27-user-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user-db\n  template:\n    metadata:\n      labels:\n        name: user-db\n    spec:\n      containers:\n      - name: user-db\n        image: weaveworksdemos/user-db:0.3.0\n\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/27-user-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user-db' pod running.\n- The pods are labeled with 'name: user-db' for identification and selection.\n- Each pod runs a single container using the image 'weaveworksdemos/user-db:0.3.0'.\n- The container exposes port 27017, which is typically used by MongoDB.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/28-user-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: user-db\n\n\n```\nSummary of sock-shop-2/manifests/28-user-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: user-db'.\n\nThe resiliency issues/weaknesses in the system are as follows:\nIssue #0: Missing Port Configuration\n  - details: The service does not specify the port it should serve on, which can lead to connectivity issues.\n  - manifests having the issues: ['sock-shop-2/manifests/02-carts-svc.yaml', 'sock-shop-2/manifests/04-carts-db-svc.yaml', 'sock-shop-2/manifests/06-catalogue-svc.yaml', 'sock-shop-2/manifests/08-catalogue-db-svc.yaml', 'sock-shop-2/manifests/12-orders-svc.yaml', 'sock-shop-2/manifests/14-orders-db-svc.yaml', 'sock-shop-2/manifests/16-payment-svc.yaml', 'sock-shop-2/manifests/18-queue-master-svc.yaml', 'sock-shop-2/manifests/22-session-db-svc.yaml', 'sock-shop-2/manifests/24-shipping-svc.yaml', 'sock-shop-2/manifests/26-user-svc.yaml', 'sock-shop-2/manifests/28-user-db-svc.yaml']\n  - problematic config: The 'ports' field in the Service spec is missing the 'port' configuration.\n\nIssue #1: Single Replica Deployment\n  - details: Having a single replica for a deployment can lead to downtime if the pod fails.\n  - manifests having the issues: ['sock-shop-2/manifests/09-front-end-dep.yaml']\n  - problematic config: The 'replicas' field is set to 1.\n\nIssue #2: High Initial Delay for Liveness Probe\n  - details: A high initial delay for the liveness probe can delay the detection of a non-responsive application.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/09-front-end-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the liveness probe is set to 300.\n\nIssue #3: High Initial Delay for Readiness Probe\n  - details: A high initial delay for the readiness probe can delay the application from being marked as ready, affecting service availability.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the readiness probe is set to 180.\n\nThe expected type of application on the system (i.e., K8s manfests):\nSock Shop is an e-commerce application that simulates an online sock store. It offers users the ability to browse a catalogue of socks, add items to a cart, place orders, and manage user accounts. The application is composed of multiple microservices, each responsible for a specific function within the e-commerce workflow, such as handling orders, managing user sessions, and processing payments.; The manifests provided are part of a well-known microservices demo application called 'Sock Shop'. This application is designed to demonstrate the use of microservices architecture and Kubernetes orchestration. The file names, labels, and images used in the manifests (e.g., 'weaveworksdemos') are indicative of the Sock Shop application, which simulates an e-commerce website for selling socks. The application includes various services such as carts, catalogue, orders, payment, and user management, each with its own database and service components, reflecting a typical e-commerce platform's architecture.\n\nSteady states of my system:\n2 steady states are defined.\n1st steady states:\n- Name: CartsServiceEndpointsAvailable\n- Description: The first issue to address is the 'Missing Port Configuration' in the Service manifests. This issue is likely to cause connectivity problems, making it a critical aspect to verify. Among the manifests with this issue, 'sock-shop-2/manifests/02-carts-svc.yaml' is selected as it is the first in the list. The steady state will ensure that the Service is functioning correctly by checking the number of endpoints available for the 'carts' service, which should match the number of replicas in the corresponding Deployment.\n- Threshold for the steady state: At least 1 endpoint must be available for the 'carts' service 95% of the time during a 1-minute period, with a target of 2 endpoints available.; The steady state to be verified is the availability of endpoints for the 'carts' service, which should match the number of replicas specified in the corresponding Deployment. The Deployment for 'carts' specifies 2 replicas, and the current state shows that there are 2 endpoints available consistently over a period of 5 seconds. This indicates that the system is currently in a healthy state. To account for potential fluctuations and ensure the system remains resilient, a reasonable threshold should allow for a small tolerance. Given the redundancy with 2 replicas, the threshold can be set to require at least 1 endpoint to be available at all times, but ideally, both should be available. Additionally, the threshold should specify that this condition must be met for at least 95% of the time during the 1-minute chaos experiment, allowing for brief disruptions without failing the steady state check.\n- Whether the steady state meets the threshold is determined by the following Python script with K8s API:\n```\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\nfrom unittest_base import K8sAPIBase\n\nclass TestCartsServiceEndpoints(K8sAPIBase):\n    def __init__(self):\n        super().__init__()\n        self.apps_v1 = client.AppsV1Api()  # Initialize AppsV1Api\n        self.namespace = 'sock-shop'\n        self.service_name = 'carts'\n        self.deployment_name = 'carts'\n\n    def get_endpoints_count(self):\n        endpoints = self.v1.read_namespaced_endpoints(self.service_name, self.namespace)\n        return len(endpoints.subsets[0].addresses) if endpoints.subsets else 0\n\n    def get_replicas_count(self):\n        deployment = self.apps_v1.read_namespaced_deployment(self.deployment_name, self.namespace)  # Use AppsV1Api\n        return deployment.status.replicas\n\n    def test_endpoints_availability(self, duration):\n        success_count = 0\n        total_checks = duration\n\n        for _ in range(duration):\n            endpoints_count = self.get_endpoints_count()\n            replicas_count = self.get_replicas_count()\n            print(f'Endpoints available: {endpoints_count}, Expected replicas: {replicas_count}')\n\n            # Check if at least 1 endpoint is available\n            if endpoints_count >= 1:\n                success_count += 1\n\n            time.sleep(1)\n\n        # Calculate the success rate\n        success_rate = (success_count / total_checks) * 100\n        print(f'Success rate: {success_rate}%')\n\n        # Assert that the success rate is at least 95%\n        assert success_rate >= 95, f'Success rate {success_rate}% is below the threshold of 95%'\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Test Carts Service Endpoints Availability')\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the state in seconds')\n    args = parser.parse_args()\n\n    test = TestCartsServiceEndpoints()\n    test.test_endpoints_availability(args.duration)\n\n\nif __name__ == '__main__':\n    main()\n\n```2nd steady states:\n- Name: FrontEndLivenessProbeSuccess\n- Description: The next issue to address is the 'Single Replica Deployment' in the 'sock-shop-2/manifests/09-front-end-dep.yaml'. This issue is critical because having only one replica can lead to downtime if the pod fails. To ensure the system's resilience, we need to verify that the single replica of the 'front-end' deployment is always available. The steady state will check the availability of the 'front-end' pod by ensuring that the liveness probe is successful 95% of the time during a 1-minute period. This will help us confirm that the single replica is stable and responsive, even though it lacks redundancy.\n- Threshold for the steady state: The liveness probe for the 'front-end' pod must be successful at least 95% of the time during a 1-minute monitoring period.; The steady state to be verified is the availability of the 'front-end' pod, specifically ensuring that the liveness probe is successful 95% of the time during a 1-minute period. The current state shows a 100% success rate, which is above the required 95%. To account for fluctuations and ensure the system remains stable, we can set a threshold that allows for some tolerance. Given that the current success rate is 100%, setting the threshold at 95% is reasonable and ensures that the system is considered stable even if there are minor fluctuations. This threshold is also aligned with the requirement to complete the Chaos-Engineering experiment within 1 minute, as it allows for quick verification of the system's stability.\n- Whether the steady state meets the threshold is determined by the following Python script with K8s API:\n```\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\nfrom unittest_base import K8sAPIBase\n\nclass TestFrontEndLivenessProbe(K8sAPIBase):\n    def check_frontend_liveness(self, namespace, duration):\n        success_count = 0\n        total_checks = 0\n\n        for _ in range(duration):\n            # List pods with the label 'name=front-end' in the specified namespace\n            pods = self.v1.list_namespaced_pod(namespace=namespace, label_selector=\"name=front-end\").items\n            if pods:\n                pod = pods[0]\n                if pod.status.conditions:\n                    for condition in pod.status.conditions:\n                        if condition.type == \"Ready\" and condition.status == \"True\":\n                            success_count += 1\n                            break\n            total_checks += 1\n            time.sleep(1)\n\n        # Calculate the success rate of the liveness probe\n        success_rate = (success_count / total_checks) * 100\n        print(f\"Liveness Probe Success Rate: {success_rate}%\")\n        return success_rate\n\n    def test_liveness_probe_success_rate(self, namespace='sock-shop', duration=60):\n        # Check the liveness probe success rate\n        success_rate = self.check_frontend_liveness(namespace, duration)\n        # Assert that the success rate is at least 95%\n        assert success_rate >= 95, f\"Liveness probe success rate is below 95%: {success_rate}%\"\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Test Front-End Liveness Probe Success Rate')\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the liveness probe in seconds')\n    args = parser.parse_args()\n\n    # Create an instance of the test class\n    test_instance = TestFrontEndLivenessProbe()\n    # Run the test with the specified duration\n    test_instance.test_liveness_probe_success_rate(duration=args.duration)\n\n\nif __name__ == '__main__':\n    main()\n```\n\nA fault scenario that may occur in my system and may affect the steady states:\n\nAn assumed fault scenario is as follows:\n- Event: Black Friday Sale\n- Used Chaos Engineering tool: Chaos Mesh\n- Faults to simulate the event: [[{'name': 'StressChaos', 'name_id': 0, 'scope': {'namespace': 'sock-shop', 'label': 'name=carts'}}, {'name': 'StressChaos', 'name_id': 1, 'scope': {'namespace': 'sock-shop', 'label': 'name=front-end'}}], [{'name': 'NetworkChaos', 'name_id': 0, 'scope': {'namespace': 'sock-shop', 'label': 'name=front-end'}}], [{'name': 'PodChaos', 'name_id': 0, 'scope': {'namespace': 'sock-shop', 'label': 'name=front-end'}}]]\n- Description: During a Black Friday sale, the system is expected to handle a significant increase in traffic and load. This event will test the system's ability to maintain steady states under high demand. The 'CartsServiceEndpointsAvailable' steady state is crucial as it ensures the availability of the carts service, which is essential for users to add items to their cart. The 'FrontEndLivenessProbeSuccess' steady state is also critical as it ensures the front-end is responsive, allowing users to browse and make purchases. The system's weaknesses include missing port configurations, a single replica deployment for the front-end, and high initial delays for probes. To simulate the Black Friday event, we will first inject a 'StressChaos' fault to simulate high CPU usage on the 'carts' and 'front-end' pods, testing their ability to handle increased load. Next, we will inject a 'NetworkChaos' fault to simulate network latency, testing the system's resilience to network issues during high traffic. Finally, we will inject a 'PodChaos' fault to kill the single replica of the 'front-end' pod, testing the system's ability to recover from pod failures without redundancy.\n\nPlease follow the instructions below regarding Chaos Engineering as necessary:\n- The Chaos-Engineering experiment must be completed within 1 minute.\n\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\n  1. http://front-end.sock-shop.svc.cluster.local/\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\n  4. http://front-end.sock-shop.svc.cluster.local/category/\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html\n\nNow, please detail the parameters of the fault \"StressChaos({'namespace': 'sock-shop', 'label': 'name=front-end'})\".\nThe output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"mode\": {\"title\": \"Mode\", \"description\": \"Specifies the mode of the experiment. The mode options include 'one' (selecting a random Pod), 'all' (selecting all eligible Pods), 'fixed' (selecting a specified number of eligible Pods), 'fixed-percent' (selecting a specified percentage of Pods from the eligible Pods), and 'random-max-percent' (selecting the maximum percentage of Pods from the eligible Pods)\", \"example\": \"one\", \"enum\": [\"one\", \"all\", \"fixed\", \"fixed-percent\", \"random-max-percent\"], \"type\": \"string\"}, \"value\": {\"title\": \"Value\", \"description\": \"Provides parameters for the mode configuration, depending on mode.For example, when mode is set to fixed-percent, value specifies the percentage of Pods.\", \"example\": \"1\", \"type\": \"string\"}, \"stressors\": {\"title\": \"Stressors\", \"description\": \"Specifies the stress of CPU or memory\", \"dafault\": null, \"allOf\": [{\"$ref\": \"#/definitions/Stressors\"}]}, \"stressngStressors\": {\"title\": \"Stressngstressors\", \"description\": \"Specifies the stres-ng parameter to reach richer stress injection\", \"example\": \"--clone 2\", \"type\": \"string\"}, \"containerNames\": {\"title\": \"Containernames\", \"description\": \"Specifies the name of the container into which the fault is injected.\", \"example\": [\"nginx\"], \"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"selector\": {\"title\": \"Selector\", \"description\": \"Specifies the target Pod.\", \"allOf\": [{\"$ref\": \"#/definitions/Selectors\"}]}}, \"required\": [\"mode\", \"selector\"], \"definitions\": {\"MemoryStressor\": {\"title\": \"MemoryStressor\", \"type\": \"object\", \"properties\": {\"workers\": {\"title\": \"Workers\", \"description\": \"Specifies the number of threads that apply memory stress\", \"example\": 1, \"type\": \"integer\"}, \"size\": {\"title\": \"Size\", \"description\": \"Specifies the memory size to be occupied or a percentage of the total memory size. The final sum of the occupied memory size is size.\", \"example\": \"256MB\", \"type\": \"string\"}, \"oomScoreAdj\": {\"title\": \"Oomscoreadj\", \"description\": \"Specifies the oom_score_adj of the stress process.\", \"example\": -1000, \"type\": \"integer\"}}}, \"CPUStressor\": {\"title\": \"CPUStressor\", \"type\": \"object\", \"properties\": {\"workers\": {\"title\": \"Workers\", \"description\": \"Specifies the number of threads that apply CPU stress\", \"example\": 1, \"type\": \"integer\"}, \"load\": {\"title\": \"Load\", \"description\": \"Specifies the percentage of CPU occupied. 0 means that no additional CPU is added, and 100 refers to full load. The final sum of CPU load is workers * load.\", \"example\": 50, \"type\": \"integer\"}}}, \"Stressors\": {\"title\": \"Stressors\", \"type\": \"object\", \"properties\": {\"memory\": {\"title\": \"Memory\", \"description\": \"Specifies the memory stress\", \"allOf\": [{\"$ref\": \"#/definitions/MemoryStressor\"}]}, \"cpu\": {\"title\": \"Cpu\", \"description\": \"Specifies the CPU stress\", \"allOf\": [{\"$ref\": \"#/definitions/CPUStressor\"}]}}}, \"SetBasedRequirements\": {\"title\": \"SetBasedRequirements\", \"type\": \"object\", \"properties\": {\"key\": {\"title\": \"Key\", \"description\": \"Label key\", \"type\": \"string\"}, \"operator\": {\"title\": \"Operator\", \"description\": \"Select an operator.\", \"enum\": [\"In\", \"NotIn\", \"Exists\", \"DoesNotExist\"], \"type\": \"string\"}, \"values\": {\"title\": \"Values\", \"description\": \"Label values. The values set must be non-empty in the case of In and NotIn.\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"key\", \"operator\", \"values\"]}, \"Selectors\": {\"title\": \"Selectors\", \"type\": \"object\", \"properties\": {\"namespaces\": {\"title\": \"Namespaces\", \"description\": \"Specifies the namespace of the experiment's target Pod. If this selector is None, Chaos Mesh will set it to the namespace of the current Chaos experiment.\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"labelSelectors\": {\"title\": \"Labelselectors\", \"description\": \"Specifies the label-key/value pairs that the experiment's target Pod must have. If multiple labels are specified, the experiment target must have all the labels specified by this selector.\", \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"expressionSelectors\": {\"title\": \"Expressionselectors\", \"description\": \"Specifies a set of expressions that define the label's rules to specifiy the experiment's target Pod.\", \"example\": [{\"key\": \"tier\", \"operator\": \"In\", \"values\": [\"cache\"]}, {\"key\": \"environment\", \"operator\": \"NotIn\", \"values\": [\"dev\"]}], \"type\": \"array\", \"items\": {\"$ref\": \"#/definitions/SetBasedRequirements\"}}, \"annotationSelectors\": {\"title\": \"Annotationselectors\", \"description\": \"Specifies the annotation-key/value pairs that the experiment's target Pod must have. If multiple annotations are specified, the experiment target must have all annotations specified by this selector.\", \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"fieldSelectors\": {\"title\": \"Fieldselectors\", \"description\": \"Specifies the field-key/value pairs of the experiment's target Pod. If multiple fields are specified, the experiment target must have all fields set by this selector.\", \"example\": {\"metadata.name\": \"my-pod\", \"metadata.namespace\": \"dafault\"}, \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"podPhaseSelectors\": {\"title\": \"Podphaseselectors\", \"description\": \"Specifies the phase of the experiment's target Pod. If this selector is None, the target Pod's phase is not limited.\", \"type\": \"array\", \"items\": {\"enum\": [\"Pending\", \"Running\", \"Succeeded\", \"Failed\", \"Unknown\"], \"type\": \"string\"}}, \"nodeSelectors\": {\"title\": \"Nodeselectors\", \"description\": \"Specifies the node-label-key/value pairs to which the experiment's target Pod belongs.\", \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"nodes\": {\"title\": \"Nodes\", \"description\": \"Specifies the node to which the experiment's target Pod belongs. The target Pod can only belong to one node in the configured node list. If multiple node labels are specified, the node to which the experiment's target Pod belongs must have all labels specified by this selector.\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"pods\": {\"title\": \"Pods\", \"description\": \"Specifies the namespaces and list of the experiment's target Pods. If you have specified this selector, Chaos Mesh ignores other configured selectors.\", \"example\": {\"default\": [\"pod-0\", \"pod-2\"]}, \"type\": \"object\", \"additionalProperties\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}}}\n```\nAI: ```json\n{\"mode\":"
            ],
            "{\"mode\": \"all\", \"value\": \"\", \"stressors\": {\"cpu\": {\"workers\": 2, \"load\": 80}}, \"stressngStressors\": \"\", \"containerNames\": [\"front-end\"], \"selector\": {\"namespaces\": [\"sock-shop\"], \"labelSelectors\": {\"name\": \"front-end\"}}}",
            [
                "System: You are a helpful AI assistant for Chaos Engineering.\nGiven k8s manifests that defines a network system, its steady states, and a fault type that may affect the steady states in the system, please detail the parameters of the fault.\nAlways keep the following rules:\n- Pay attention to namespace specification. If the namespace is specified in the manifest, it is deployed with the namespace. If not, it is deployed with the 'default' namespace.\n- The parameters follow the format of Chaos Mesh.\nHuman: Here is the overview of my system:\nThe system consists of the following K8s manifest(s):K8s manifest: sock-shop-2/manifests/00-sock-shop-ns.yaml\n```yaml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: sock-shop\n\n```\nSummary of sock-shop-2/manifests/00-sock-shop-ns.yaml:\n- This manifest defines a Kubernetes Namespace.\n- The Namespace is named 'sock-shop'.\n- Namespaces are used to organize and manage resources in a Kubernetes cluster.\n\nK8s manifest: sock-shop-2/manifests/01-carts-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts\n  template:\n    metadata:\n      labels:\n        name: carts\n    spec:\n      containers:\n      - name: carts\n        image: weaveworksdemos/carts:0.4.8\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/01-carts-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/carts:0.4.8'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 300m CPU and 500Mi memory, and a minimum of 100m CPU and 200Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities.\n- The root filesystem is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/02-carts-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: carts\n\n```\nSummary of sock-shop-2/manifests/02-carts-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The Service is named 'carts'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: carts'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: carts' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/03-carts-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts-db\n  template:\n    metadata:\n      labels:\n        name: carts-db\n    spec:\n      containers:\n      - name: carts-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/03-carts-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts-db' pod running.\n- The pods are selected based on the label 'name: carts-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add only CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/04-carts-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: carts-db\n\n```\nSummary of sock-shop-2/manifests/04-carts-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'carts-db'.\n- It is labeled with 'name: carts-db'.\n- The Service is created in the 'sock-shop' namespace.\n- It exposes port 27017 and directs traffic to the same port on the target pods.\n- The Service selects pods with the label 'name: carts-db' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/05-catalogue-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue\n  template:\n    metadata:\n      labels:\n        name: catalogue\n    spec:\n      containers:\n      - name: catalogue\n        image: weaveworksdemos/catalogue:0.3.5\n        command: [\"/app\"]\n        args:\n        - -port=80\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/05-catalogue-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/catalogue:0.3.5'.\n- The application runs with the command '/app' and listens on port 80.\n- Resource limits are set to 200m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container runs as a non-root user with user ID 10001 and has a read-only root filesystem.\n- Security settings drop all capabilities except 'NET_BIND_SERVICE'.\n- A liveness probe checks the '/health' endpoint on port 80, starting after 300 seconds and repeating every 3 seconds.\n- A readiness probe also checks the '/health' endpoint on port 80, starting after 180 seconds and repeating every 3 seconds.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/06-catalogue-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: catalogue\n\n```\nSummary of sock-shop-2/manifests/06-catalogue-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'catalogue'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: catalogue'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: catalogue'.\n\nK8s manifest: sock-shop-2/manifests/07-catalogue-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue-db\n  template:\n    metadata:\n      labels:\n        name: catalogue-db\n    spec:\n      containers:\n      - name: catalogue-db\n        image: weaveworksdemos/catalogue-db:0.3.0\n        env:\n          - name: MYSQL_ROOT_PASSWORD\n            value: fake_password\n          - name: MYSQL_DATABASE\n            value: socksdb\n        ports:\n        - name: mysql\n          containerPort: 3306\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/07-catalogue-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue-db' pod running.\n- The pods are selected based on the label 'name: catalogue-db'.\n- Each pod runs a single container using the image 'weaveworksdemos/catalogue-db:0.3.0'.\n- The container is configured with environment variables for 'MYSQL_ROOT_PASSWORD' and 'MYSQL_DATABASE'.\n- The container exposes port 3306, which is typically used for MySQL databases.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/08-catalogue-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 3306\n    targetPort: 3306\n  selector:\n    name: catalogue-db\n\n```\nSummary of sock-shop-2/manifests/08-catalogue-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'catalogue-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 3306.\n- It targets the same port (3306) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: catalogue-db'.\n- This setup is typically used to provide a stable endpoint for accessing a database running in the cluster.\n\nK8s manifest: sock-shop-2/manifests/09-front-end-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: front-end\n  namespace: sock-shop\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: front-end\n  template:\n    metadata:\n      labels:\n        name: front-end\n    spec:\n      containers:\n      - name: front-end\n        image: weaveworksdemos/front-end:0.3.12\n        resources:\n          limits:\n            cpu: 300m\n            memory: 1000Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 8079\n        env:\n        - name: SESSION_REDIS\n          value: \"true\"\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 30\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n```\nSummary of sock-shop-2/manifests/09-front-end-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'front-end' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 1 replica of the front-end application running.\n- The Deployment uses a selector to match pods with the label 'name: front-end'.\n- The pod template includes a single container named 'front-end'.\n- The container uses the image 'weaveworksdemos/front-end:0.3.12'.\n- Resource limits are set for the container: 300m CPU and 1000Mi memory.\n- Resource requests are set for the container: 100m CPU and 300Mi memory.\n- The container exposes port 8079.\n- An environment variable 'SESSION_REDIS' is set to 'true'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All Linux capabilities are dropped, and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/' path on port 8079, with an initial delay of 300 seconds and a period of 3 seconds.\n- A readiness probe is also configured to check the '/' path on port 8079, with an initial delay of 30 seconds and a period of 3 seconds.\n- The node selector ensures the pod runs on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/10-front-end-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: front-end\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: front-end\n  namespace: sock-shop\nspec:\n  type: NodePort\n  ports:\n  - port: 80\n    targetPort: 8079\n    nodePort: 30001\n  selector:\n    name: front-end\n\n```\nSummary of sock-shop-2/manifests/10-front-end-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'front-end'.\n- It is located in the 'sock-shop' namespace.\n- The Service type is 'NodePort', which exposes the service on each Node's IP at a static port.\n- It listens on port 80 and forwards traffic to target port 8079 on the pods.\n- The nodePort is set to 30001, which is the port on each node where the service can be accessed externally.\n- The Service is configured to be scraped by Prometheus for monitoring, as indicated by the annotation 'prometheus.io/scrape: true'.\n- It uses a selector to target pods with the label 'name: front-end'.\n\nK8s manifest: sock-shop-2/manifests/11-orders-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders\n  template:\n    metadata:\n      labels:\n        name: orders\n    spec:\n      containers:\n      - name: orders\n        image: weaveworksdemos/orders:0.4.7\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 500m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/11-orders-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/orders:0.4.7'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 500m CPU and 500Mi memory, and a minimum of 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities and a read-only root filesystem.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/12-orders-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: orders\n\n```\nSummary of sock-shop-2/manifests/12-orders-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: orders'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the target pods.\n- It uses a selector to match pods with the label 'name: orders'.\n\nK8s manifest: sock-shop-2/manifests/13-orders-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders-db\n  template:\n    metadata:\n      labels:\n        name: orders-db\n    spec:\n      containers:\n      - name: orders-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/13-orders-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders-db' pod running.\n- The pods are selected based on the label 'name: orders-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add specific ones like CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/14-orders-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: orders-db\n\n```\nSummary of sock-shop-2/manifests/14-orders-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods.\n- The Service selects pods with the label 'name: orders-db'.\n\nK8s manifest: sock-shop-2/manifests/15-payment-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: payment\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: payment\n  template:\n    metadata:\n      labels:\n        name: payment\n    spec:\n      containers:\n      - name: payment\n        image: weaveworksdemos/payment:0.4.3\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 99m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/15-payment-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'payment' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'payment' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/payment:0.4.3'.\n- Resource limits are set for the containers: 200m CPU and 200Mi memory.\n- Resource requests are set for the containers: 99m CPU and 100Mi memory.\n- The container exposes port 80.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All capabilities are dropped except 'NET_BIND_SERVICE', and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/health' endpoint on port 80, starting after 300 seconds and checking every 3 seconds.\n- A readiness probe is also configured to check the '/health' endpoint on port 80, starting after 180 seconds and checking every 3 seconds.\n- The Deployment is scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/16-payment-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: payment\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: payment\n\n```\nSummary of sock-shop-2/manifests/16-payment-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'payment'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: payment'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: payment'.\n\nK8s manifest: sock-shop-2/manifests/17-queue-master-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: queue-master\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: queue-master\n  template:\n    metadata:\n      labels:\n        name: queue-master\n    spec:\n      containers:\n      - name: queue-master\n        image: weaveworksdemos/queue-master:0.3.1\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/17-queue-master-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'queue-master' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'queue-master' pod running.\n- The pods are selected based on the label 'name: queue-master'.\n- Each pod runs a single container using the image 'weaveworksdemos/queue-master:0.3.1'.\n- The container is configured with specific Java options through environment variables.\n- Resource limits are set for the container, with a maximum of 300m CPU and 500Mi memory, and requests for 100m CPU and 300Mi memory.\n- The container exposes port 80.\n- The pods are scheduled on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/18-queue-master-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: queue-master\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: queue-master\n```\nSummary of sock-shop-2/manifests/18-queue-master-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'queue-master'.\n- It is annotated to enable Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: queue-master'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: queue-master' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/19-rabbitmq-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: rabbitmq\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: rabbitmq\n  template:\n    metadata:\n      labels:\n        name: rabbitmq\n      annotations:\n        prometheus.io/scrape: \"false\"\n    spec:\n      containers:\n      - name: rabbitmq\n        image: rabbitmq:3.6.8-management\n        ports:\n        - containerPort: 15672\n          name: management\n        - containerPort: 5672\n          name: rabbitmq\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n              - DAC_OVERRIDE\n          readOnlyRootFilesystem: true\n      - name: rabbitmq-exporter\n        image: kbudde/rabbitmq-exporter\n        ports:\n        - containerPort: 9090\n          name: exporter\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/19-rabbitmq-dep.yaml:\n- This manifest defines a Deployment for RabbitMQ in Kubernetes.\n- The Deployment is named 'rabbitmq' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas, meaning there will be 2 instances of RabbitMQ running.\n- The Deployment uses a label 'name: rabbitmq' to manage its pods.\n- The RabbitMQ container uses the image 'rabbitmq:3.6.8-management'.\n- It exposes two ports: 15672 for management and 5672 for RabbitMQ communication.\n- Security settings drop all capabilities but add CHOWN, SETGID, SETUID, and DAC_OVERRIDE, and the root filesystem is set to read-only.\n- An additional container, 'rabbitmq-exporter', is included for monitoring purposes, using the 'kbudde/rabbitmq-exporter' image and exposing port 9090.\n- The Deployment is configured to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/20-rabbitmq-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: rabbitmq\n  annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 5672\n    name: rabbitmq\n    targetPort: 5672\n  - port: 9090\n    name: exporter\n    targetPort: exporter\n    protocol: TCP\n  selector:\n    name: rabbitmq\n\n```\nSummary of sock-shop-2/manifests/20-rabbitmq-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'rabbitmq'.\n- It is annotated for Prometheus scraping on port 9090.\n- The Service is located in the 'sock-shop' namespace.\n- It exposes two ports: 5672 for RabbitMQ and 9090 for an exporter.\n- The Service uses TCP protocol for communication.\n- It selects pods with the label 'name: rabbitmq' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/21-session-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: session-db\n  template:\n    metadata:\n      labels:\n        name: session-db\n      annotations:\n        prometheus.io.scrape: \"false\"\n    spec:\n      containers:\n      - name: session-db\n        image: redis:alpine\n        ports:\n        - name: redis\n          containerPort: 6379\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/21-session-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'session-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'session-db' pod running.\n- The pods are selected based on the label 'name: session-db'.\n- Each pod runs a single container using the 'redis:alpine' image.\n- The container exposes port 6379, which is commonly used by Redis.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/22-session-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 6379\n    targetPort: 6379\n  selector:\n    name: session-db\n\n```\nSummary of sock-shop-2/manifests/22-session-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'session-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 6379.\n- It targets the same port (6379) on the selected pods.\n- The Service uses a selector to match pods with the label 'name: session-db'.\n\nK8s manifest: sock-shop-2/manifests/23-shipping-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: shipping\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: shipping\n  template:\n    metadata:\n      labels:\n        name: shipping\n    spec:\n      containers:\n      - name: shipping\n        image: weaveworksdemos/shipping:0.4.8\n        env:\n         - name: ZIPKIN\n           value: zipkin.jaeger.svc.cluster.local\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/23-shipping-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'shipping' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas of the 'shipping' application to be run.\n- The Deployment uses the Docker image 'weaveworksdemos/shipping:0.4.8'.\n- Environment variables are set for the application, including 'ZIPKIN' and 'JAVA_OPTS'.\n- Resource limits and requests are defined, with CPU limits at 300m and memory limits at 500Mi, and requests at 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with user ID 10001, and it drops all capabilities except 'NET_BIND_SERVICE'.\n- The root filesystem is set to be read-only.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/24-shipping-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: shipping\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: shipping\n\n\n```\nSummary of sock-shop-2/manifests/24-shipping-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'shipping'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: shipping'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: shipping' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/25-user-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user\n  template:\n    metadata:\n      labels:\n        name: user\n    spec:\n      containers:\n      - name: user\n        image: weaveworksdemos/user:0.4.7\n        resources:\n          limits:\n            cpu: 300m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        env:\n        - name: mongo\n          value: user-db:27017\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/25-user-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/user:0.4.7'.\n- Resource limits are set for the container: 300m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container listens on port 80.\n- An environment variable 'mongo' is set with the value 'user-db:27017'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- The container has a read-only root filesystem and drops all capabilities except 'NET_BIND_SERVICE'.\n- Liveness and readiness probes are configured to check the '/health' endpoint on port 80, with initial delays of 300 and 180 seconds, respectively.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/26-user-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: user\n\n\n```\nSummary of sock-shop-2/manifests/26-user-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: user'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It uses a selector to target pods with the label 'name: user'.\n\nK8s manifest: sock-shop-2/manifests/27-user-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user-db\n  template:\n    metadata:\n      labels:\n        name: user-db\n    spec:\n      containers:\n      - name: user-db\n        image: weaveworksdemos/user-db:0.3.0\n\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/27-user-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user-db' pod running.\n- The pods are labeled with 'name: user-db' for identification and selection.\n- Each pod runs a single container using the image 'weaveworksdemos/user-db:0.3.0'.\n- The container exposes port 27017, which is typically used by MongoDB.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/28-user-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: user-db\n\n\n```\nSummary of sock-shop-2/manifests/28-user-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: user-db'.\n\nThe resiliency issues/weaknesses in the system are as follows:\nIssue #0: Missing Port Configuration\n  - details: The service does not specify the port it should serve on, which can lead to connectivity issues.\n  - manifests having the issues: ['sock-shop-2/manifests/02-carts-svc.yaml', 'sock-shop-2/manifests/04-carts-db-svc.yaml', 'sock-shop-2/manifests/06-catalogue-svc.yaml', 'sock-shop-2/manifests/08-catalogue-db-svc.yaml', 'sock-shop-2/manifests/12-orders-svc.yaml', 'sock-shop-2/manifests/14-orders-db-svc.yaml', 'sock-shop-2/manifests/16-payment-svc.yaml', 'sock-shop-2/manifests/18-queue-master-svc.yaml', 'sock-shop-2/manifests/22-session-db-svc.yaml', 'sock-shop-2/manifests/24-shipping-svc.yaml', 'sock-shop-2/manifests/26-user-svc.yaml', 'sock-shop-2/manifests/28-user-db-svc.yaml']\n  - problematic config: The 'ports' field in the Service spec is missing the 'port' configuration.\n\nIssue #1: Single Replica Deployment\n  - details: Having a single replica for a deployment can lead to downtime if the pod fails.\n  - manifests having the issues: ['sock-shop-2/manifests/09-front-end-dep.yaml']\n  - problematic config: The 'replicas' field is set to 1.\n\nIssue #2: High Initial Delay for Liveness Probe\n  - details: A high initial delay for the liveness probe can delay the detection of a non-responsive application.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/09-front-end-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the liveness probe is set to 300.\n\nIssue #3: High Initial Delay for Readiness Probe\n  - details: A high initial delay for the readiness probe can delay the application from being marked as ready, affecting service availability.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the readiness probe is set to 180.\n\nThe expected type of application on the system (i.e., K8s manfests):\nSock Shop is an e-commerce application that simulates an online sock store. It offers users the ability to browse a catalogue of socks, add items to a cart, place orders, and manage user accounts. The application is composed of multiple microservices, each responsible for a specific function within the e-commerce workflow, such as handling orders, managing user sessions, and processing payments.; The manifests provided are part of a well-known microservices demo application called 'Sock Shop'. This application is designed to demonstrate the use of microservices architecture and Kubernetes orchestration. The file names, labels, and images used in the manifests (e.g., 'weaveworksdemos') are indicative of the Sock Shop application, which simulates an e-commerce website for selling socks. The application includes various services such as carts, catalogue, orders, payment, and user management, each with its own database and service components, reflecting a typical e-commerce platform's architecture.\n\nSteady states of my system:\n2 steady states are defined.\n1st steady states:\n- Name: CartsServiceEndpointsAvailable\n- Description: The first issue to address is the 'Missing Port Configuration' in the Service manifests. This issue is likely to cause connectivity problems, making it a critical aspect to verify. Among the manifests with this issue, 'sock-shop-2/manifests/02-carts-svc.yaml' is selected as it is the first in the list. The steady state will ensure that the Service is functioning correctly by checking the number of endpoints available for the 'carts' service, which should match the number of replicas in the corresponding Deployment.\n- Threshold for the steady state: At least 1 endpoint must be available for the 'carts' service 95% of the time during a 1-minute period, with a target of 2 endpoints available.; The steady state to be verified is the availability of endpoints for the 'carts' service, which should match the number of replicas specified in the corresponding Deployment. The Deployment for 'carts' specifies 2 replicas, and the current state shows that there are 2 endpoints available consistently over a period of 5 seconds. This indicates that the system is currently in a healthy state. To account for potential fluctuations and ensure the system remains resilient, a reasonable threshold should allow for a small tolerance. Given the redundancy with 2 replicas, the threshold can be set to require at least 1 endpoint to be available at all times, but ideally, both should be available. Additionally, the threshold should specify that this condition must be met for at least 95% of the time during the 1-minute chaos experiment, allowing for brief disruptions without failing the steady state check.\n- Whether the steady state meets the threshold is determined by the following Python script with K8s API:\n```\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\nfrom unittest_base import K8sAPIBase\n\nclass TestCartsServiceEndpoints(K8sAPIBase):\n    def __init__(self):\n        super().__init__()\n        self.apps_v1 = client.AppsV1Api()  # Initialize AppsV1Api\n        self.namespace = 'sock-shop'\n        self.service_name = 'carts'\n        self.deployment_name = 'carts'\n\n    def get_endpoints_count(self):\n        endpoints = self.v1.read_namespaced_endpoints(self.service_name, self.namespace)\n        return len(endpoints.subsets[0].addresses) if endpoints.subsets else 0\n\n    def get_replicas_count(self):\n        deployment = self.apps_v1.read_namespaced_deployment(self.deployment_name, self.namespace)  # Use AppsV1Api\n        return deployment.status.replicas\n\n    def test_endpoints_availability(self, duration):\n        success_count = 0\n        total_checks = duration\n\n        for _ in range(duration):\n            endpoints_count = self.get_endpoints_count()\n            replicas_count = self.get_replicas_count()\n            print(f'Endpoints available: {endpoints_count}, Expected replicas: {replicas_count}')\n\n            # Check if at least 1 endpoint is available\n            if endpoints_count >= 1:\n                success_count += 1\n\n            time.sleep(1)\n\n        # Calculate the success rate\n        success_rate = (success_count / total_checks) * 100\n        print(f'Success rate: {success_rate}%')\n\n        # Assert that the success rate is at least 95%\n        assert success_rate >= 95, f'Success rate {success_rate}% is below the threshold of 95%'\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Test Carts Service Endpoints Availability')\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the state in seconds')\n    args = parser.parse_args()\n\n    test = TestCartsServiceEndpoints()\n    test.test_endpoints_availability(args.duration)\n\n\nif __name__ == '__main__':\n    main()\n\n```2nd steady states:\n- Name: FrontEndLivenessProbeSuccess\n- Description: The next issue to address is the 'Single Replica Deployment' in the 'sock-shop-2/manifests/09-front-end-dep.yaml'. This issue is critical because having only one replica can lead to downtime if the pod fails. To ensure the system's resilience, we need to verify that the single replica of the 'front-end' deployment is always available. The steady state will check the availability of the 'front-end' pod by ensuring that the liveness probe is successful 95% of the time during a 1-minute period. This will help us confirm that the single replica is stable and responsive, even though it lacks redundancy.\n- Threshold for the steady state: The liveness probe for the 'front-end' pod must be successful at least 95% of the time during a 1-minute monitoring period.; The steady state to be verified is the availability of the 'front-end' pod, specifically ensuring that the liveness probe is successful 95% of the time during a 1-minute period. The current state shows a 100% success rate, which is above the required 95%. To account for fluctuations and ensure the system remains stable, we can set a threshold that allows for some tolerance. Given that the current success rate is 100%, setting the threshold at 95% is reasonable and ensures that the system is considered stable even if there are minor fluctuations. This threshold is also aligned with the requirement to complete the Chaos-Engineering experiment within 1 minute, as it allows for quick verification of the system's stability.\n- Whether the steady state meets the threshold is determined by the following Python script with K8s API:\n```\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\nfrom unittest_base import K8sAPIBase\n\nclass TestFrontEndLivenessProbe(K8sAPIBase):\n    def check_frontend_liveness(self, namespace, duration):\n        success_count = 0\n        total_checks = 0\n\n        for _ in range(duration):\n            # List pods with the label 'name=front-end' in the specified namespace\n            pods = self.v1.list_namespaced_pod(namespace=namespace, label_selector=\"name=front-end\").items\n            if pods:\n                pod = pods[0]\n                if pod.status.conditions:\n                    for condition in pod.status.conditions:\n                        if condition.type == \"Ready\" and condition.status == \"True\":\n                            success_count += 1\n                            break\n            total_checks += 1\n            time.sleep(1)\n\n        # Calculate the success rate of the liveness probe\n        success_rate = (success_count / total_checks) * 100\n        print(f\"Liveness Probe Success Rate: {success_rate}%\")\n        return success_rate\n\n    def test_liveness_probe_success_rate(self, namespace='sock-shop', duration=60):\n        # Check the liveness probe success rate\n        success_rate = self.check_frontend_liveness(namespace, duration)\n        # Assert that the success rate is at least 95%\n        assert success_rate >= 95, f\"Liveness probe success rate is below 95%: {success_rate}%\"\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Test Front-End Liveness Probe Success Rate')\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the liveness probe in seconds')\n    args = parser.parse_args()\n\n    # Create an instance of the test class\n    test_instance = TestFrontEndLivenessProbe()\n    # Run the test with the specified duration\n    test_instance.test_liveness_probe_success_rate(duration=args.duration)\n\n\nif __name__ == '__main__':\n    main()\n```\n\nA fault scenario that may occur in my system and may affect the steady states:\n\nAn assumed fault scenario is as follows:\n- Event: Black Friday Sale\n- Used Chaos Engineering tool: Chaos Mesh\n- Faults to simulate the event: [[{'name': 'StressChaos', 'name_id': 0, 'scope': {'namespace': 'sock-shop', 'label': 'name=carts'}}, {'name': 'StressChaos', 'name_id': 1, 'scope': {'namespace': 'sock-shop', 'label': 'name=front-end'}}], [{'name': 'NetworkChaos', 'name_id': 0, 'scope': {'namespace': 'sock-shop', 'label': 'name=front-end'}}], [{'name': 'PodChaos', 'name_id': 0, 'scope': {'namespace': 'sock-shop', 'label': 'name=front-end'}}]]\n- Description: During a Black Friday sale, the system is expected to handle a significant increase in traffic and load. This event will test the system's ability to maintain steady states under high demand. The 'CartsServiceEndpointsAvailable' steady state is crucial as it ensures the availability of the carts service, which is essential for users to add items to their cart. The 'FrontEndLivenessProbeSuccess' steady state is also critical as it ensures the front-end is responsive, allowing users to browse and make purchases. The system's weaknesses include missing port configurations, a single replica deployment for the front-end, and high initial delays for probes. To simulate the Black Friday event, we will first inject a 'StressChaos' fault to simulate high CPU usage on the 'carts' and 'front-end' pods, testing their ability to handle increased load. Next, we will inject a 'NetworkChaos' fault to simulate network latency, testing the system's resilience to network issues during high traffic. Finally, we will inject a 'PodChaos' fault to kill the single replica of the 'front-end' pod, testing the system's ability to recover from pod failures without redundancy.\n\nPlease follow the instructions below regarding Chaos Engineering as necessary:\n- The Chaos-Engineering experiment must be completed within 1 minute.\n\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\n  1. http://front-end.sock-shop.svc.cluster.local/\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\n  4. http://front-end.sock-shop.svc.cluster.local/category/\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html\n\nNow, please detail the parameters of the fault \"NetworkChaos({'namespace': 'sock-shop', 'label': 'name=front-end'})\".\nThe output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"action\": {\"title\": \"Action\", \"description\": \"Indicates the specific fault type. Available types include: netem, delay (network delay), loss (packet loss), duplicate (packet duplicating), corrupt (packet corrupt), partition (network partition), and bandwidth (network bandwidth limit). After you specify action field, specify action-related fields for other necessary field configuration.\", \"example\": \"Partition\", \"enum\": [\"netem\", \"delay\", \"loss\", \"duplicate\", \"corrupt\", \"partition\", \"bandwidth\"], \"type\": \"string\"}, \"direction\": {\"title\": \"Direction\", \"description\": \"Indicates the direction of target packets. Available vaules include from (the packets from target), to (the packets to target), and both (the packets from or to target). This parameter makes Chaos only take effect for a specific direction of packets.\", \"default\": \"to\", \"example\": \"both\", \"enum\": [\"from\", \"to\", \"both\"], \"type\": \"string\"}, \"target\": {\"title\": \"Target\", \"description\": \"Used in combination with direction, making Chaos only effective for some packets. 'from' and 'both' direction cannot be used when targets is empty in netem action.\", \"allOf\": [{\"$ref\": \"#/definitions/Selector\"}]}, \"mode\": {\"title\": \"Mode\", \"description\": \"Specifies the mode of the experiment. The mode options include one (selecting a random Pod), all (selecting all eligible Pods), fixed (selecting a specified number of eligible Pods), fixed-percent (selecting a specified percentage of Pods from the eligible Pods), and random-max-percent (selecting the maximum percentage of Pods from the eligible Pods)\", \"example\": \"one\", \"enum\": [\"one\", \"all\", \"fixed\", \"fixed-percent\", \"random-max-percent\"], \"type\": \"string\"}, \"value\": {\"title\": \"Value\", \"description\": \"Provides parameters for the mode configuration, depending on mode. For example, when mode is set to fixed-percent, value specifies the percentage of Pods.\", \"example\": \"1\", \"type\": \"string\"}, \"selector\": {\"title\": \"Selector\", \"description\": \"Specifies the target Pod.\", \"allOf\": [{\"$ref\": \"#/definitions/Selectors\"}]}, \"externalTargets\": {\"title\": \"Externaltargets\", \"description\": \"Indicates the network targets except for Kubernetes, which can be IPv4 addresses or domains. This parameter only works with direction: to.\", \"example\": [\"1.1.1.1\", \"www.google.com\"], \"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"device\": {\"title\": \"Device\", \"description\": \"Specifies the affected network interface\", \"example\": \"eth0\", \"type\": \"string\"}, \"delay\": {\"title\": \"Delay\", \"description\": \"When setting action to delay means simulating network delay fault, you also need to configure this parameters.\", \"allOf\": [{\"$ref\": \"#/definitions/Deplay\"}]}, \"loss\": {\"title\": \"Loss\", \"description\": \"When setting action to loss means simulating packet loss fault, you can also configure this parameters.\", \"allOf\": [{\"$ref\": \"#/definitions/Loss\"}]}, \"duplicated\": {\"title\": \"Duplicated\", \"description\": \"When setting action to duplicate, meaning simulating package duplication, you can also set this parameters.\", \"allOf\": [{\"$ref\": \"#/definitions/Duplicate\"}]}, \"corrupt\": {\"title\": \"Corrupt\", \"description\": \"When setting action to corrupt means simulating package corruption fault, you can also configure the following parameters.\", \"allOf\": [{\"$ref\": \"#/definitions/Corrupt\"}]}, \"rate\": {\"title\": \"Rate\", \"description\": \"When setting action to rate means simulating bandwidth rate fault, you also need to configure this parameters. This action is similar to bandwidth/rate below, however, the key distinction is that this action can combine with other netem actions listed above. However, if you require more control over the bandwidth simulation such as limiting the buffer size, select the bandwidth action.\", \"allOf\": [{\"$ref\": \"#/definitions/Rate\"}]}, \"bandwidth\": {\"title\": \"Bandwidth\", \"description\": \"When setting 'action' to 'bandwidth' means simulating bandwidth limit fault, you also need to configure this parameters. This action is mutually exclusive with any netem action defined above. If you need to inject bandwidth rate along with other network failures such as corruption, use the rate action instead.\", \"allOf\": [{\"$ref\": \"#/definitions/Bandwidth\"}]}}, \"required\": [\"action\", \"mode\", \"selector\"], \"definitions\": {\"SetBasedRequirements\": {\"title\": \"SetBasedRequirements\", \"type\": \"object\", \"properties\": {\"key\": {\"title\": \"Key\", \"description\": \"Label key\", \"type\": \"string\"}, \"operator\": {\"title\": \"Operator\", \"description\": \"Select an operator.\", \"enum\": [\"In\", \"NotIn\", \"Exists\", \"DoesNotExist\"], \"type\": \"string\"}, \"values\": {\"title\": \"Values\", \"description\": \"Label values. The values set must be non-empty in the case of In and NotIn.\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"key\", \"operator\", \"values\"]}, \"Selectors\": {\"title\": \"Selectors\", \"type\": \"object\", \"properties\": {\"namespaces\": {\"title\": \"Namespaces\", \"description\": \"Specifies the namespace of the experiment's target Pod. If this selector is None, Chaos Mesh will set it to the namespace of the current Chaos experiment.\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"labelSelectors\": {\"title\": \"Labelselectors\", \"description\": \"Specifies the label-key/value pairs that the experiment's target Pod must have. If multiple labels are specified, the experiment target must have all the labels specified by this selector.\", \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"expressionSelectors\": {\"title\": \"Expressionselectors\", \"description\": \"Specifies a set of expressions that define the label's rules to specifiy the experiment's target Pod.\", \"example\": [{\"key\": \"tier\", \"operator\": \"In\", \"values\": [\"cache\"]}, {\"key\": \"environment\", \"operator\": \"NotIn\", \"values\": [\"dev\"]}], \"type\": \"array\", \"items\": {\"$ref\": \"#/definitions/SetBasedRequirements\"}}, \"annotationSelectors\": {\"title\": \"Annotationselectors\", \"description\": \"Specifies the annotation-key/value pairs that the experiment's target Pod must have. If multiple annotations are specified, the experiment target must have all annotations specified by this selector.\", \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"fieldSelectors\": {\"title\": \"Fieldselectors\", \"description\": \"Specifies the field-key/value pairs of the experiment's target Pod. If multiple fields are specified, the experiment target must have all fields set by this selector.\", \"example\": {\"metadata.name\": \"my-pod\", \"metadata.namespace\": \"dafault\"}, \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"podPhaseSelectors\": {\"title\": \"Podphaseselectors\", \"description\": \"Specifies the phase of the experiment's target Pod. If this selector is None, the target Pod's phase is not limited.\", \"type\": \"array\", \"items\": {\"enum\": [\"Pending\", \"Running\", \"Succeeded\", \"Failed\", \"Unknown\"], \"type\": \"string\"}}, \"nodeSelectors\": {\"title\": \"Nodeselectors\", \"description\": \"Specifies the node-label-key/value pairs to which the experiment's target Pod belongs.\", \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"nodes\": {\"title\": \"Nodes\", \"description\": \"Specifies the node to which the experiment's target Pod belongs. The target Pod can only belong to one node in the configured node list. If multiple node labels are specified, the node to which the experiment's target Pod belongs must have all labels specified by this selector.\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"pods\": {\"title\": \"Pods\", \"description\": \"Specifies the namespaces and list of the experiment's target Pods. If you have specified this selector, Chaos Mesh ignores other configured selectors.\", \"example\": {\"default\": [\"pod-0\", \"pod-2\"]}, \"type\": \"object\", \"additionalProperties\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}, \"Selector\": {\"title\": \"Selector\", \"type\": \"object\", \"properties\": {\"mode\": {\"title\": \"Mode\", \"description\": \"Specifies the mode of the experiment. The mode options include one (selecting a random Pod), all (selecting all eligible Pods), fixed (selecting a specified number of eligible Pods), fixed-percent (selecting a specified percentage of Pods from the eligible Pods), and random-max-percent (selecting the maximum percentage of Pods from the eligible Pods)\", \"example\": \"one\", \"enum\": [\"one\", \"all\", \"fixed\", \"fixed-percent\", \"random-max-percent\"], \"type\": \"string\"}, \"selector\": {\"title\": \"Selector\", \"description\": \"Specifies the target Pod.\", \"example\": null, \"allOf\": [{\"$ref\": \"#/definitions/Selectors\"}]}}, \"required\": [\"mode\", \"selector\"]}, \"Reorder\": {\"title\": \"Reorder\", \"type\": \"object\", \"properties\": {\"reorder\": {\"title\": \"Reorder\", \"description\": \"Indicates the probability to reorder\", \"default\": \"0\", \"example\": \"0.5\", \"type\": \"string\"}, \"correlation\": {\"title\": \"Correlation\", \"description\": \"Indicates the correlation between this time's length of delay time and the previous time's length of delay time. Range of value: [0, 100]\", \"default\": \"0\", \"example\": \"50\", \"type\": \"string\"}, \"gap\": {\"title\": \"Gap\", \"description\": \"Indicates the gap before and after packet reordering\", \"default\": 0, \"example\": 5, \"type\": \"integer\"}}}, \"Deplay\": {\"title\": \"Deplay\", \"type\": \"object\", \"properties\": {\"latency\": {\"title\": \"Latency\", \"description\": \"Indicates the network latency\", \"example\": \"2ms\", \"type\": \"string\"}, \"correlation\": {\"title\": \"Correlation\", \"description\": \"Indicates the correlation between the current latency and the previous one. Range of value: [0, 100]. Specify only the number. NEVER include any units.\", \"example\": \"50\", \"type\": \"string\"}, \"jitter\": {\"title\": \"Jitter\", \"description\": \"Indicates the range of the network latency\", \"example\": \"1ms\", \"type\": \"string\"}, \"reorder\": {\"title\": \"Reorder\", \"description\": \"Indicates the status of network packet reordering\", \"allOf\": [{\"$ref\": \"#/definitions/Reorder\"}]}}}, \"Loss\": {\"title\": \"Loss\", \"type\": \"object\", \"properties\": {\"loss\": {\"title\": \"Loss\", \"description\": \"Indicates the probability of packet loss. Range of value: [0, 100]. Specify only the number. NEVER include any units.\", \"default\": \"0\", \"example\": \"50\", \"type\": \"string\"}, \"correlation\": {\"title\": \"Correlation\", \"description\": \"Indicates the correlation between the probability of current packet loss and the previous time's packet loss. Range of value: [0, 100]. Specify only the number. NEVER include any units.\", \"default\": \"0\", \"example\": \"50\", \"type\": \"string\"}}}, \"Duplicate\": {\"title\": \"Duplicate\", \"type\": \"object\", \"properties\": {\"duplicate\": {\"title\": \"Duplicate\", \"description\": \"Indicates the probability of packet duplicating. Range of value: [0, 100]. Specify only the number. NEVER include any units.\", \"default\": \"0\", \"example\": \"50\", \"type\": \"string\"}, \"correlation\": {\"title\": \"Correlation\", \"description\": \"Indicates the correlation between the probability of current packet duplicating and the previous time's packet duplicating. Range of value: [0, 100]. Specify only the number. NEVER include any units.\", \"default\": \"0\", \"example\": \"50\", \"type\": \"string\"}}}, \"Corrupt\": {\"title\": \"Corrupt\", \"type\": \"object\", \"properties\": {\"corrupt\": {\"title\": \"Corrupt\", \"description\": \"Indicates the probability of packet corruption. Range of value: [0, 100]. Specify only the number. NEVER include any units.\", \"default\": \"0\", \"example\": \"50\", \"type\": \"string\"}, \"correlation\": {\"title\": \"Correlation\", \"description\": \"Indicates the correlation between the probability of current packet corruption and the previous time's packet corruption. Range of value: [0, 100]. Specify only the number. NEVER include any units.\", \"default\": \"0\", \"example\": \"50\", \"type\": \"string\"}}}, \"Rate\": {\"title\": \"Rate\", \"type\": \"object\", \"properties\": {\"rate\": {\"title\": \"Rate\", \"description\": \"Indicates the rate of bandwidth limit. Allows bit, kbit, mbit, gbit, tbit, bps, kbps, mbps, gbps, tbps unit. bps means bytes per second\", \"example\": \"1mbps\", \"type\": \"string\"}}}, \"Bandwidth\": {\"title\": \"Bandwidth\", \"type\": \"object\", \"properties\": {\"rate\": {\"title\": \"Rate\", \"description\": \"Indicates the rate of bandwidth limit. Allows bit, kbit, mbit, gbit, tbit, bps, kbps, mbps, gbps, tbps unit. bps means bytes per second\", \"example\": \"1mbps\", \"type\": \"string\"}, \"limit\": {\"title\": \"Limit\", \"description\": \"Indicates the number of bytes waiting in queue\", \"example\": 1, \"type\": \"integer\"}, \"buffer\": {\"title\": \"Buffer\", \"description\": \"Indicates the maximum number of bytes that can be sent instantaneously\", \"example\": 1, \"type\": \"integer\"}, \"peakrate\": {\"title\": \"Peakrate\", \"description\": \"Indicates the maximum consumption of bucket (usually not set)\", \"example\": 1, \"type\": \"integer\"}, \"minburst\": {\"title\": \"Minburst\", \"description\": \"Indicates the size of peakrate bucket (usually not set)\", \"example\": 1, \"type\": \"integer\"}}}}}\n```\nAI: ```json\n{\"action\":"
            ],
            "{\"action\": \"delay\", \"mode\": \"all\", \"selector\": {\"namespaces\": [\"sock-shop\"], \"labelSelectors\": {\"name\": \"front-end\"}}, \"direction\": \"to\", \"device\": \"eth0\", \"delay\": {\"latency\": \"100ms\", \"jitter\": \"10ms\", \"correlation\": \"50\"}}",
            [
                "System: You are a helpful AI assistant for Chaos Engineering.\nGiven k8s manifests that defines a network system, its steady states, and a fault type that may affect the steady states in the system, please detail the parameters of the fault.\nAlways keep the following rules:\n- Pay attention to namespace specification. If the namespace is specified in the manifest, it is deployed with the namespace. If not, it is deployed with the 'default' namespace.\n- The parameters follow the format of Chaos Mesh.\nHuman: Here is the overview of my system:\nThe system consists of the following K8s manifest(s):K8s manifest: sock-shop-2/manifests/00-sock-shop-ns.yaml\n```yaml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: sock-shop\n\n```\nSummary of sock-shop-2/manifests/00-sock-shop-ns.yaml:\n- This manifest defines a Kubernetes Namespace.\n- The Namespace is named 'sock-shop'.\n- Namespaces are used to organize and manage resources in a Kubernetes cluster.\n\nK8s manifest: sock-shop-2/manifests/01-carts-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts\n  template:\n    metadata:\n      labels:\n        name: carts\n    spec:\n      containers:\n      - name: carts\n        image: weaveworksdemos/carts:0.4.8\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/01-carts-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/carts:0.4.8'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 300m CPU and 500Mi memory, and a minimum of 100m CPU and 200Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities.\n- The root filesystem is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/02-carts-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: carts\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: carts\n\n```\nSummary of sock-shop-2/manifests/02-carts-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The Service is named 'carts'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: carts'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: carts' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/03-carts-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: carts-db\n  template:\n    metadata:\n      labels:\n        name: carts-db\n    spec:\n      containers:\n      - name: carts-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/03-carts-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'carts-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'carts-db' pod running.\n- The pods are selected based on the label 'name: carts-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add only CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/04-carts-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: carts-db\n  labels:\n    name: carts-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: carts-db\n\n```\nSummary of sock-shop-2/manifests/04-carts-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'carts-db'.\n- It is labeled with 'name: carts-db'.\n- The Service is created in the 'sock-shop' namespace.\n- It exposes port 27017 and directs traffic to the same port on the target pods.\n- The Service selects pods with the label 'name: carts-db' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/05-catalogue-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue\n  template:\n    metadata:\n      labels:\n        name: catalogue\n    spec:\n      containers:\n      - name: catalogue\n        image: weaveworksdemos/catalogue:0.3.5\n        command: [\"/app\"]\n        args:\n        - -port=80\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/05-catalogue-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/catalogue:0.3.5'.\n- The application runs with the command '/app' and listens on port 80.\n- Resource limits are set to 200m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container runs as a non-root user with user ID 10001 and has a read-only root filesystem.\n- Security settings drop all capabilities except 'NET_BIND_SERVICE'.\n- A liveness probe checks the '/health' endpoint on port 80, starting after 300 seconds and repeating every 3 seconds.\n- A readiness probe also checks the '/health' endpoint on port 80, starting after 180 seconds and repeating every 3 seconds.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/06-catalogue-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: catalogue\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: catalogue\n\n```\nSummary of sock-shop-2/manifests/06-catalogue-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'catalogue'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: catalogue'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: catalogue'.\n\nK8s manifest: sock-shop-2/manifests/07-catalogue-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: catalogue-db\n  template:\n    metadata:\n      labels:\n        name: catalogue-db\n    spec:\n      containers:\n      - name: catalogue-db\n        image: weaveworksdemos/catalogue-db:0.3.0\n        env:\n          - name: MYSQL_ROOT_PASSWORD\n            value: fake_password\n          - name: MYSQL_DATABASE\n            value: socksdb\n        ports:\n        - name: mysql\n          containerPort: 3306\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/07-catalogue-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'catalogue-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'catalogue-db' pod running.\n- The pods are selected based on the label 'name: catalogue-db'.\n- Each pod runs a single container using the image 'weaveworksdemos/catalogue-db:0.3.0'.\n- The container is configured with environment variables for 'MYSQL_ROOT_PASSWORD' and 'MYSQL_DATABASE'.\n- The container exposes port 3306, which is typically used for MySQL databases.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/08-catalogue-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 3306\n    targetPort: 3306\n  selector:\n    name: catalogue-db\n\n```\nSummary of sock-shop-2/manifests/08-catalogue-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'catalogue-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 3306.\n- It targets the same port (3306) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: catalogue-db'.\n- This setup is typically used to provide a stable endpoint for accessing a database running in the cluster.\n\nK8s manifest: sock-shop-2/manifests/09-front-end-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: front-end\n  namespace: sock-shop\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: front-end\n  template:\n    metadata:\n      labels:\n        name: front-end\n    spec:\n      containers:\n      - name: front-end\n        image: weaveworksdemos/front-end:0.3.12\n        resources:\n          limits:\n            cpu: 300m\n            memory: 1000Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 8079\n        env:\n        - name: SESSION_REDIS\n          value: \"true\"\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8079\n          initialDelaySeconds: 30\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n```\nSummary of sock-shop-2/manifests/09-front-end-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'front-end' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 1 replica of the front-end application running.\n- The Deployment uses a selector to match pods with the label 'name: front-end'.\n- The pod template includes a single container named 'front-end'.\n- The container uses the image 'weaveworksdemos/front-end:0.3.12'.\n- Resource limits are set for the container: 300m CPU and 1000Mi memory.\n- Resource requests are set for the container: 100m CPU and 300Mi memory.\n- The container exposes port 8079.\n- An environment variable 'SESSION_REDIS' is set to 'true'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All Linux capabilities are dropped, and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/' path on port 8079, with an initial delay of 300 seconds and a period of 3 seconds.\n- A readiness probe is also configured to check the '/' path on port 8079, with an initial delay of 30 seconds and a period of 3 seconds.\n- The node selector ensures the pod runs on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/10-front-end-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: front-end\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: front-end\n  namespace: sock-shop\nspec:\n  type: NodePort\n  ports:\n  - port: 80\n    targetPort: 8079\n    nodePort: 30001\n  selector:\n    name: front-end\n\n```\nSummary of sock-shop-2/manifests/10-front-end-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'front-end'.\n- It is located in the 'sock-shop' namespace.\n- The Service type is 'NodePort', which exposes the service on each Node's IP at a static port.\n- It listens on port 80 and forwards traffic to target port 8079 on the pods.\n- The nodePort is set to 30001, which is the port on each node where the service can be accessed externally.\n- The Service is configured to be scraped by Prometheus for monitoring, as indicated by the annotation 'prometheus.io/scrape: true'.\n- It uses a selector to target pods with the label 'name: front-end'.\n\nK8s manifest: sock-shop-2/manifests/11-orders-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders\n  template:\n    metadata:\n      labels:\n        name: orders\n    spec:\n      containers:\n      - name: orders\n        image: weaveworksdemos/orders:0.4.7\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 500m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/11-orders-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/orders:0.4.7'.\n- Environment variables are set for Java options to optimize memory usage and disable certain features.\n- Resource limits and requests are defined, with a maximum of 500m CPU and 500Mi memory, and a minimum of 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with specific capabilities and a read-only root filesystem.\n- A temporary volume is mounted at '/tmp' using an in-memory empty directory.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/12-orders-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: orders\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: orders\n\n```\nSummary of sock-shop-2/manifests/12-orders-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: orders'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the target pods.\n- It uses a selector to match pods with the label 'name: orders'.\n\nK8s manifest: sock-shop-2/manifests/13-orders-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: orders-db\n  template:\n    metadata:\n      labels:\n        name: orders-db\n    spec:\n      containers:\n      - name: orders-db\n        image: mongo\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/13-orders-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'orders-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'orders-db' pod running.\n- The pods are selected based on the label 'name: orders-db'.\n- Each pod runs a single container using the 'mongo' image.\n- The container exposes port 27017, which is the default port for MongoDB.\n- Security settings are applied to drop all capabilities and add specific ones like CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/14-orders-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: orders-db\n  labels:\n    name: orders-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: orders-db\n\n```\nSummary of sock-shop-2/manifests/14-orders-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'orders-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods.\n- The Service selects pods with the label 'name: orders-db'.\n\nK8s manifest: sock-shop-2/manifests/15-payment-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: payment\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: payment\n  template:\n    metadata:\n      labels:\n        name: payment\n    spec:\n      containers:\n      - name: payment\n        image: weaveworksdemos/payment:0.4.3\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 99m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/15-payment-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'payment' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'payment' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/payment:0.4.3'.\n- Resource limits are set for the containers: 200m CPU and 200Mi memory.\n- Resource requests are set for the containers: 99m CPU and 100Mi memory.\n- The container exposes port 80.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- All capabilities are dropped except 'NET_BIND_SERVICE', and the root filesystem is set to read-only.\n- A liveness probe is configured to check the '/health' endpoint on port 80, starting after 300 seconds and checking every 3 seconds.\n- A readiness probe is also configured to check the '/health' endpoint on port 80, starting after 180 seconds and checking every 3 seconds.\n- The Deployment is scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/16-payment-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: payment\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: payment\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: payment\n\n```\nSummary of sock-shop-2/manifests/16-payment-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'payment'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: payment'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: payment'.\n\nK8s manifest: sock-shop-2/manifests/17-queue-master-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: queue-master\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: queue-master\n  template:\n    metadata:\n      labels:\n        name: queue-master\n    spec:\n      containers:\n      - name: queue-master\n        image: weaveworksdemos/queue-master:0.3.1\n        env:\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/17-queue-master-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'queue-master' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'queue-master' pod running.\n- The pods are selected based on the label 'name: queue-master'.\n- Each pod runs a single container using the image 'weaveworksdemos/queue-master:0.3.1'.\n- The container is configured with specific Java options through environment variables.\n- Resource limits are set for the container, with a maximum of 300m CPU and 500Mi memory, and requests for 100m CPU and 300Mi memory.\n- The container exposes port 80.\n- The pods are scheduled on nodes with the operating system labeled as 'linux'.\n\nK8s manifest: sock-shop-2/manifests/18-queue-master-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: queue-master\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: queue-master\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: queue-master\n```\nSummary of sock-shop-2/manifests/18-queue-master-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'queue-master'.\n- It is annotated to enable Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: queue-master'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: queue-master' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/19-rabbitmq-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: rabbitmq\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: rabbitmq\n  template:\n    metadata:\n      labels:\n        name: rabbitmq\n      annotations:\n        prometheus.io/scrape: \"false\"\n    spec:\n      containers:\n      - name: rabbitmq\n        image: rabbitmq:3.6.8-management\n        ports:\n        - containerPort: 15672\n          name: management\n        - containerPort: 5672\n          name: rabbitmq\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n              - DAC_OVERRIDE\n          readOnlyRootFilesystem: true\n      - name: rabbitmq-exporter\n        image: kbudde/rabbitmq-exporter\n        ports:\n        - containerPort: 9090\n          name: exporter\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/19-rabbitmq-dep.yaml:\n- This manifest defines a Deployment for RabbitMQ in Kubernetes.\n- The Deployment is named 'rabbitmq' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas, meaning there will be 2 instances of RabbitMQ running.\n- The Deployment uses a label 'name: rabbitmq' to manage its pods.\n- The RabbitMQ container uses the image 'rabbitmq:3.6.8-management'.\n- It exposes two ports: 15672 for management and 5672 for RabbitMQ communication.\n- Security settings drop all capabilities but add CHOWN, SETGID, SETUID, and DAC_OVERRIDE, and the root filesystem is set to read-only.\n- An additional container, 'rabbitmq-exporter', is included for monitoring purposes, using the 'kbudde/rabbitmq-exporter' image and exposing port 9090.\n- The Deployment is configured to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/20-rabbitmq-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: rabbitmq\n  annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n  labels:\n    name: rabbitmq\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 5672\n    name: rabbitmq\n    targetPort: 5672\n  - port: 9090\n    name: exporter\n    targetPort: exporter\n    protocol: TCP\n  selector:\n    name: rabbitmq\n\n```\nSummary of sock-shop-2/manifests/20-rabbitmq-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'rabbitmq'.\n- It is annotated for Prometheus scraping on port 9090.\n- The Service is located in the 'sock-shop' namespace.\n- It exposes two ports: 5672 for RabbitMQ and 9090 for an exporter.\n- The Service uses TCP protocol for communication.\n- It selects pods with the label 'name: rabbitmq' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/21-session-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: session-db\n  template:\n    metadata:\n      labels:\n        name: session-db\n      annotations:\n        prometheus.io.scrape: \"false\"\n    spec:\n      containers:\n      - name: session-db\n        image: redis:alpine\n        ports:\n        - name: redis\n          containerPort: 6379\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/21-session-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'session-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'session-db' pod running.\n- The pods are selected based on the label 'name: session-db'.\n- Each pod runs a single container using the 'redis:alpine' image.\n- The container exposes port 6379, which is commonly used by Redis.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/22-session-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: session-db\n  labels:\n    name: session-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 6379\n    targetPort: 6379\n  selector:\n    name: session-db\n\n```\nSummary of sock-shop-2/manifests/22-session-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'session-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 6379.\n- It targets the same port (6379) on the selected pods.\n- The Service uses a selector to match pods with the label 'name: session-db'.\n\nK8s manifest: sock-shop-2/manifests/23-shipping-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: shipping\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: shipping\n  template:\n    metadata:\n      labels:\n        name: shipping\n    spec:\n      containers:\n      - name: shipping\n        image: weaveworksdemos/shipping:0.4.8\n        env:\n         - name: ZIPKIN\n           value: zipkin.jaeger.svc.cluster.local\n         - name: JAVA_OPTS\n           value: -Xms64m -Xmx128m -XX:+UseG1GC -Djava.security.egd=file:/dev/urandom -Dspring.zipkin.enabled=false\n        resources:\n          limits:\n            cpu: 300m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 300Mi\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/23-shipping-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'shipping' and is located in the 'sock-shop' namespace.\n- It specifies 2 replicas of the 'shipping' application to be run.\n- The Deployment uses the Docker image 'weaveworksdemos/shipping:0.4.8'.\n- Environment variables are set for the application, including 'ZIPKIN' and 'JAVA_OPTS'.\n- Resource limits and requests are defined, with CPU limits at 300m and memory limits at 500Mi, and requests at 100m CPU and 300Mi memory.\n- The application listens on port 80 within the container.\n- Security context is configured to run the container as a non-root user with user ID 10001, and it drops all capabilities except 'NET_BIND_SERVICE'.\n- The root filesystem is set to be read-only.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The Deployment is scheduled to run on nodes with the label 'beta.kubernetes.io/os: linux'.\n\nK8s manifest: sock-shop-2/manifests/24-shipping-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: shipping\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: shipping\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: shipping\n\n\n```\nSummary of sock-shop-2/manifests/24-shipping-svc.yaml:\n- This is a Kubernetes Service manifest.\n- The service is named 'shipping'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The service is labeled with 'name: shipping'.\n- It is deployed in the 'sock-shop' namespace.\n- The service exposes port 80 and directs traffic to the same port on the selected pods.\n- It selects pods with the label 'name: shipping' to route traffic to.\n\nK8s manifest: sock-shop-2/manifests/25-user-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user\n  template:\n    metadata:\n      labels:\n        name: user\n    spec:\n      containers:\n      - name: user\n        image: weaveworksdemos/user:0.4.7\n        resources:\n          limits:\n            cpu: 300m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 80\n        env:\n        - name: mongo\n          value: user-db:27017\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 10001\n          capabilities:\n            drop:\n              - all\n            add:\n              - NET_BIND_SERVICE\n          readOnlyRootFilesystem: true\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 300\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n          initialDelaySeconds: 180\n          periodSeconds: 3\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/25-user-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user' application running.\n- The Deployment uses the Docker image 'weaveworksdemos/user:0.4.7'.\n- Resource limits are set for the container: 300m CPU and 200Mi memory, with requests for 100m CPU and 100Mi memory.\n- The container listens on port 80.\n- An environment variable 'mongo' is set with the value 'user-db:27017'.\n- Security context is configured to run the container as a non-root user with user ID 10001.\n- The container has a read-only root filesystem and drops all capabilities except 'NET_BIND_SERVICE'.\n- Liveness and readiness probes are configured to check the '/health' endpoint on port 80, with initial delays of 300 and 180 seconds, respectively.\n- The Deployment is scheduled to run on nodes with the Linux operating system.\n\nK8s manifest: sock-shop-2/manifests/26-user-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user\n  annotations:\n        prometheus.io/scrape: 'true'\n  labels:\n    name: user\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 80\n    targetPort: 80\n  selector:\n    name: user\n\n\n```\nSummary of sock-shop-2/manifests/26-user-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user'.\n- It is annotated for Prometheus scraping with 'prometheus.io/scrape: true'.\n- The Service is labeled with 'name: user'.\n- It is deployed in the 'sock-shop' namespace.\n- The Service exposes port 80 and directs traffic to the same port on the selected pods.\n- It uses a selector to target pods with the label 'name: user'.\n\nK8s manifest: sock-shop-2/manifests/27-user-db-dep.yaml\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      name: user-db\n  template:\n    metadata:\n      labels:\n        name: user-db\n    spec:\n      containers:\n      - name: user-db\n        image: weaveworksdemos/user-db:0.3.0\n\n        ports:\n        - name: mongo\n          containerPort: 27017\n        securityContext:\n          capabilities:\n            drop:\n              - all\n            add:\n              - CHOWN\n              - SETGID\n              - SETUID\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n      volumes:\n        - name: tmp-volume\n          emptyDir:\n            medium: Memory\n      nodeSelector:\n        beta.kubernetes.io/os: linux\n\n```\nSummary of sock-shop-2/manifests/27-user-db-dep.yaml:\n- This manifest defines a Deployment in Kubernetes.\n- The Deployment is named 'user-db' and is located in the 'sock-shop' namespace.\n- It specifies that there should be 2 replicas of the 'user-db' pod running.\n- The pods are labeled with 'name: user-db' for identification and selection.\n- Each pod runs a single container using the image 'weaveworksdemos/user-db:0.3.0'.\n- The container exposes port 27017, which is typically used by MongoDB.\n- Security settings are applied to drop all capabilities and only add CHOWN, SETGID, and SETUID.\n- The root filesystem of the container is set to be read-only for security purposes.\n- A temporary volume is mounted at '/tmp' using an in-memory emptyDir volume.\n- The pods are scheduled to run on nodes with the operating system labeled as Linux.\n\nK8s manifest: sock-shop-2/manifests/28-user-db-svc.yaml\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: user-db\n  labels:\n    name: user-db\n  namespace: sock-shop\nspec:\n  ports:\n    # the port that this service should serve on\n  - port: 27017\n    targetPort: 27017\n  selector:\n    name: user-db\n\n\n```\nSummary of sock-shop-2/manifests/28-user-db-svc.yaml:\n- This manifest defines a Kubernetes Service.\n- The Service is named 'user-db'.\n- It is located in the 'sock-shop' namespace.\n- The Service is configured to expose port 27017.\n- It targets the same port (27017) on the pods it selects.\n- The Service uses a selector to match pods with the label 'name: user-db'.\n\nThe resiliency issues/weaknesses in the system are as follows:\nIssue #0: Missing Port Configuration\n  - details: The service does not specify the port it should serve on, which can lead to connectivity issues.\n  - manifests having the issues: ['sock-shop-2/manifests/02-carts-svc.yaml', 'sock-shop-2/manifests/04-carts-db-svc.yaml', 'sock-shop-2/manifests/06-catalogue-svc.yaml', 'sock-shop-2/manifests/08-catalogue-db-svc.yaml', 'sock-shop-2/manifests/12-orders-svc.yaml', 'sock-shop-2/manifests/14-orders-db-svc.yaml', 'sock-shop-2/manifests/16-payment-svc.yaml', 'sock-shop-2/manifests/18-queue-master-svc.yaml', 'sock-shop-2/manifests/22-session-db-svc.yaml', 'sock-shop-2/manifests/24-shipping-svc.yaml', 'sock-shop-2/manifests/26-user-svc.yaml', 'sock-shop-2/manifests/28-user-db-svc.yaml']\n  - problematic config: The 'ports' field in the Service spec is missing the 'port' configuration.\n\nIssue #1: Single Replica Deployment\n  - details: Having a single replica for a deployment can lead to downtime if the pod fails.\n  - manifests having the issues: ['sock-shop-2/manifests/09-front-end-dep.yaml']\n  - problematic config: The 'replicas' field is set to 1.\n\nIssue #2: High Initial Delay for Liveness Probe\n  - details: A high initial delay for the liveness probe can delay the detection of a non-responsive application.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/09-front-end-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the liveness probe is set to 300.\n\nIssue #3: High Initial Delay for Readiness Probe\n  - details: A high initial delay for the readiness probe can delay the application from being marked as ready, affecting service availability.\n  - manifests having the issues: ['sock-shop-2/manifests/05-catalogue-dep.yaml', 'sock-shop-2/manifests/15-payment-dep.yaml', 'sock-shop-2/manifests/25-user-dep.yaml']\n  - problematic config: The 'initialDelaySeconds' for the readiness probe is set to 180.\n\nThe expected type of application on the system (i.e., K8s manfests):\nSock Shop is an e-commerce application that simulates an online sock store. It offers users the ability to browse a catalogue of socks, add items to a cart, place orders, and manage user accounts. The application is composed of multiple microservices, each responsible for a specific function within the e-commerce workflow, such as handling orders, managing user sessions, and processing payments.; The manifests provided are part of a well-known microservices demo application called 'Sock Shop'. This application is designed to demonstrate the use of microservices architecture and Kubernetes orchestration. The file names, labels, and images used in the manifests (e.g., 'weaveworksdemos') are indicative of the Sock Shop application, which simulates an e-commerce website for selling socks. The application includes various services such as carts, catalogue, orders, payment, and user management, each with its own database and service components, reflecting a typical e-commerce platform's architecture.\n\nSteady states of my system:\n2 steady states are defined.\n1st steady states:\n- Name: CartsServiceEndpointsAvailable\n- Description: The first issue to address is the 'Missing Port Configuration' in the Service manifests. This issue is likely to cause connectivity problems, making it a critical aspect to verify. Among the manifests with this issue, 'sock-shop-2/manifests/02-carts-svc.yaml' is selected as it is the first in the list. The steady state will ensure that the Service is functioning correctly by checking the number of endpoints available for the 'carts' service, which should match the number of replicas in the corresponding Deployment.\n- Threshold for the steady state: At least 1 endpoint must be available for the 'carts' service 95% of the time during a 1-minute period, with a target of 2 endpoints available.; The steady state to be verified is the availability of endpoints for the 'carts' service, which should match the number of replicas specified in the corresponding Deployment. The Deployment for 'carts' specifies 2 replicas, and the current state shows that there are 2 endpoints available consistently over a period of 5 seconds. This indicates that the system is currently in a healthy state. To account for potential fluctuations and ensure the system remains resilient, a reasonable threshold should allow for a small tolerance. Given the redundancy with 2 replicas, the threshold can be set to require at least 1 endpoint to be available at all times, but ideally, both should be available. Additionally, the threshold should specify that this condition must be met for at least 95% of the time during the 1-minute chaos experiment, allowing for brief disruptions without failing the steady state check.\n- Whether the steady state meets the threshold is determined by the following Python script with K8s API:\n```\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\nfrom unittest_base import K8sAPIBase\n\nclass TestCartsServiceEndpoints(K8sAPIBase):\n    def __init__(self):\n        super().__init__()\n        self.apps_v1 = client.AppsV1Api()  # Initialize AppsV1Api\n        self.namespace = 'sock-shop'\n        self.service_name = 'carts'\n        self.deployment_name = 'carts'\n\n    def get_endpoints_count(self):\n        endpoints = self.v1.read_namespaced_endpoints(self.service_name, self.namespace)\n        return len(endpoints.subsets[0].addresses) if endpoints.subsets else 0\n\n    def get_replicas_count(self):\n        deployment = self.apps_v1.read_namespaced_deployment(self.deployment_name, self.namespace)  # Use AppsV1Api\n        return deployment.status.replicas\n\n    def test_endpoints_availability(self, duration):\n        success_count = 0\n        total_checks = duration\n\n        for _ in range(duration):\n            endpoints_count = self.get_endpoints_count()\n            replicas_count = self.get_replicas_count()\n            print(f'Endpoints available: {endpoints_count}, Expected replicas: {replicas_count}')\n\n            # Check if at least 1 endpoint is available\n            if endpoints_count >= 1:\n                success_count += 1\n\n            time.sleep(1)\n\n        # Calculate the success rate\n        success_rate = (success_count / total_checks) * 100\n        print(f'Success rate: {success_rate}%')\n\n        # Assert that the success rate is at least 95%\n        assert success_rate >= 95, f'Success rate {success_rate}% is below the threshold of 95%'\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Test Carts Service Endpoints Availability')\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the state in seconds')\n    args = parser.parse_args()\n\n    test = TestCartsServiceEndpoints()\n    test.test_endpoints_availability(args.duration)\n\n\nif __name__ == '__main__':\n    main()\n\n```2nd steady states:\n- Name: FrontEndLivenessProbeSuccess\n- Description: The next issue to address is the 'Single Replica Deployment' in the 'sock-shop-2/manifests/09-front-end-dep.yaml'. This issue is critical because having only one replica can lead to downtime if the pod fails. To ensure the system's resilience, we need to verify that the single replica of the 'front-end' deployment is always available. The steady state will check the availability of the 'front-end' pod by ensuring that the liveness probe is successful 95% of the time during a 1-minute period. This will help us confirm that the single replica is stable and responsive, even though it lacks redundancy.\n- Threshold for the steady state: The liveness probe for the 'front-end' pod must be successful at least 95% of the time during a 1-minute monitoring period.; The steady state to be verified is the availability of the 'front-end' pod, specifically ensuring that the liveness probe is successful 95% of the time during a 1-minute period. The current state shows a 100% success rate, which is above the required 95%. To account for fluctuations and ensure the system remains stable, we can set a threshold that allows for some tolerance. Given that the current success rate is 100%, setting the threshold at 95% is reasonable and ensures that the system is considered stable even if there are minor fluctuations. This threshold is also aligned with the requirement to complete the Chaos-Engineering experiment within 1 minute, as it allows for quick verification of the system's stability.\n- Whether the steady state meets the threshold is determined by the following Python script with K8s API:\n```\nimport os\nimport time\nimport argparse\nfrom kubernetes import client, config\nfrom unittest_base import K8sAPIBase\n\nclass TestFrontEndLivenessProbe(K8sAPIBase):\n    def check_frontend_liveness(self, namespace, duration):\n        success_count = 0\n        total_checks = 0\n\n        for _ in range(duration):\n            # List pods with the label 'name=front-end' in the specified namespace\n            pods = self.v1.list_namespaced_pod(namespace=namespace, label_selector=\"name=front-end\").items\n            if pods:\n                pod = pods[0]\n                if pod.status.conditions:\n                    for condition in pod.status.conditions:\n                        if condition.type == \"Ready\" and condition.status == \"True\":\n                            success_count += 1\n                            break\n            total_checks += 1\n            time.sleep(1)\n\n        # Calculate the success rate of the liveness probe\n        success_rate = (success_count / total_checks) * 100\n        print(f\"Liveness Probe Success Rate: {success_rate}%\")\n        return success_rate\n\n    def test_liveness_probe_success_rate(self, namespace='sock-shop', duration=60):\n        # Check the liveness probe success rate\n        success_rate = self.check_frontend_liveness(namespace, duration)\n        # Assert that the success rate is at least 95%\n        assert success_rate >= 95, f\"Liveness probe success rate is below 95%: {success_rate}%\"\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Test Front-End Liveness Probe Success Rate')\n    parser.add_argument('--duration', type=int, default=60, help='Duration to check the liveness probe in seconds')\n    args = parser.parse_args()\n\n    # Create an instance of the test class\n    test_instance = TestFrontEndLivenessProbe()\n    # Run the test with the specified duration\n    test_instance.test_liveness_probe_success_rate(duration=args.duration)\n\n\nif __name__ == '__main__':\n    main()\n```\n\nA fault scenario that may occur in my system and may affect the steady states:\n\nAn assumed fault scenario is as follows:\n- Event: Black Friday Sale\n- Used Chaos Engineering tool: Chaos Mesh\n- Faults to simulate the event: [[{'name': 'StressChaos', 'name_id': 0, 'scope': {'namespace': 'sock-shop', 'label': 'name=carts'}}, {'name': 'StressChaos', 'name_id': 1, 'scope': {'namespace': 'sock-shop', 'label': 'name=front-end'}}], [{'name': 'NetworkChaos', 'name_id': 0, 'scope': {'namespace': 'sock-shop', 'label': 'name=front-end'}}], [{'name': 'PodChaos', 'name_id': 0, 'scope': {'namespace': 'sock-shop', 'label': 'name=front-end'}}]]\n- Description: During a Black Friday sale, the system is expected to handle a significant increase in traffic and load. This event will test the system's ability to maintain steady states under high demand. The 'CartsServiceEndpointsAvailable' steady state is crucial as it ensures the availability of the carts service, which is essential for users to add items to their cart. The 'FrontEndLivenessProbeSuccess' steady state is also critical as it ensures the front-end is responsive, allowing users to browse and make purchases. The system's weaknesses include missing port configurations, a single replica deployment for the front-end, and high initial delays for probes. To simulate the Black Friday event, we will first inject a 'StressChaos' fault to simulate high CPU usage on the 'carts' and 'front-end' pods, testing their ability to handle increased load. Next, we will inject a 'NetworkChaos' fault to simulate network latency, testing the system's resilience to network issues during high traffic. Finally, we will inject a 'PodChaos' fault to kill the single replica of the 'front-end' pod, testing the system's ability to recover from pod failures without redundancy.\n\nPlease follow the instructions below regarding Chaos Engineering as necessary:\n- The Chaos-Engineering experiment must be completed within 1 minute.\n\n- When using k6 in steady-state definition, always select a request URL from the following options (other requests are invalid):\n  1. http://front-end.sock-shop.svc.cluster.local/\n  2. http://front-end.sock-shop.svc.cluster.local/catalogue?size=10\n  3. http://front-end.sock-shop.svc.cluster.local/detail.html?id=<ID>\n  Replace <ID> with an available ID: [`03fef6ac-1896-4ce8-bd69-b798f85c6e0b`, `3395a43e-2d88-40de-b95f-e00e1502085b`, `510a0d7e-8e83-4193-b483-e27e09ddc34d`, `808a2de1-1aaa-4c25-a9b9-6612e8f29a38`, `819e1fbf-8b7e-4f6d-811f-693534916a8b`, `837ab141-399e-4c1f-9abc-bace40296bac`, `a0a4f044-b040-410d-8ead-4de0446aec7e`, `d3588630-ad8e-49df-bbd7-3167f7efb246`, `zzz4f044-b040-410d-8ead-4de0446aec7e`]\n  4. http://front-end.sock-shop.svc.cluster.local/category/\n  5. http://front-end.sock-shop.svc.cluster.local/category?tags=<TAG>\n  Replace <TAG> with an available tag: [`magic`, `action`, `blue`, `brown`, `black`, `sport`, `formal`, `red`, `green`, `skin`, `geek`]\n  6. http://front-end.sock-shop.svc.cluster.local/basket.html\n\nNow, please detail the parameters of the fault \"PodChaos({'namespace': 'sock-shop', 'label': 'name=front-end'})\".\nThe output should be formatted as a JSON instance that conforms to the JSON schema below.\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"properties\": {\"action\": {\"title\": \"Action\", \"description\": \"Specifies the fault type from 'pod-kill', or 'container-kill'.\", \"example\": \"pod-kill\", \"enum\": [\"pod-kill\", \"container-kill\"], \"type\": \"string\"}, \"mode\": {\"title\": \"Mode\", \"description\": \"Specifies the mode of the experiment. The mode options include 'one' (selecting a random Pod), 'all' (selecting all eligible Pods), 'fixed' (selecting a specified number of eligible Pods), 'fixed-percent' (selecting a specified percentage of Pods from the eligible Pods), and 'random-max-percent' (selecting the maximum percentage of Pods from the eligible Pods)\", \"example\": \"one\", \"enum\": [\"one\", \"all\", \"fixed\", \"fixed-percent\", \"random-max-percent\"], \"type\": \"string\"}, \"value\": {\"title\": \"Value\", \"description\": \"Provides parameters for the mode configuration, depending on mode.For example, when mode is set to fixed-percent, value specifies the percentage of Pods.\", \"example\": \"1\", \"type\": \"string\"}, \"selector\": {\"title\": \"Selector\", \"description\": \"Specifies the target Pod.\", \"example\": null, \"allOf\": [{\"$ref\": \"#/definitions/Selectors\"}]}, \"containerNames\": {\"title\": \"Containernames\", \"description\": \"When you configure action to container-kill, this configuration is mandatory to specify the target container name for injecting faults.\", \"example\": [\"prometheus\"], \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"action\", \"mode\", \"selector\"], \"definitions\": {\"SetBasedRequirements\": {\"title\": \"SetBasedRequirements\", \"type\": \"object\", \"properties\": {\"key\": {\"title\": \"Key\", \"description\": \"Label key\", \"type\": \"string\"}, \"operator\": {\"title\": \"Operator\", \"description\": \"Select an operator.\", \"enum\": [\"In\", \"NotIn\", \"Exists\", \"DoesNotExist\"], \"type\": \"string\"}, \"values\": {\"title\": \"Values\", \"description\": \"Label values. The values set must be non-empty in the case of In and NotIn.\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"key\", \"operator\", \"values\"]}, \"Selectors\": {\"title\": \"Selectors\", \"type\": \"object\", \"properties\": {\"namespaces\": {\"title\": \"Namespaces\", \"description\": \"Specifies the namespace of the experiment's target Pod. If this selector is None, Chaos Mesh will set it to the namespace of the current Chaos experiment.\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"labelSelectors\": {\"title\": \"Labelselectors\", \"description\": \"Specifies the label-key/value pairs that the experiment's target Pod must have. If multiple labels are specified, the experiment target must have all the labels specified by this selector.\", \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"expressionSelectors\": {\"title\": \"Expressionselectors\", \"description\": \"Specifies a set of expressions that define the label's rules to specifiy the experiment's target Pod.\", \"example\": [{\"key\": \"tier\", \"operator\": \"In\", \"values\": [\"cache\"]}, {\"key\": \"environment\", \"operator\": \"NotIn\", \"values\": [\"dev\"]}], \"type\": \"array\", \"items\": {\"$ref\": \"#/definitions/SetBasedRequirements\"}}, \"annotationSelectors\": {\"title\": \"Annotationselectors\", \"description\": \"Specifies the annotation-key/value pairs that the experiment's target Pod must have. If multiple annotations are specified, the experiment target must have all annotations specified by this selector.\", \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"fieldSelectors\": {\"title\": \"Fieldselectors\", \"description\": \"Specifies the field-key/value pairs of the experiment's target Pod. If multiple fields are specified, the experiment target must have all fields set by this selector.\", \"example\": {\"metadata.name\": \"my-pod\", \"metadata.namespace\": \"dafault\"}, \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"podPhaseSelectors\": {\"title\": \"Podphaseselectors\", \"description\": \"Specifies the phase of the experiment's target Pod. If this selector is None, the target Pod's phase is not limited.\", \"type\": \"array\", \"items\": {\"enum\": [\"Pending\", \"Running\", \"Succeeded\", \"Failed\", \"Unknown\"], \"type\": \"string\"}}, \"nodeSelectors\": {\"title\": \"Nodeselectors\", \"description\": \"Specifies the node-label-key/value pairs to which the experiment's target Pod belongs.\", \"type\": \"object\", \"additionalProperties\": {\"type\": \"string\"}}, \"nodes\": {\"title\": \"Nodes\", \"description\": \"Specifies the node to which the experiment's target Pod belongs. The target Pod can only belong to one node in the configured node list. If multiple node labels are specified, the node to which the experiment's target Pod belongs must have all labels specified by this selector.\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}, \"pods\": {\"title\": \"Pods\", \"description\": \"Specifies the namespaces and list of the experiment's target Pods. If you have specified this selector, Chaos Mesh ignores other configured selectors.\", \"example\": {\"default\": [\"pod-0\", \"pod-2\"]}, \"type\": \"object\", \"additionalProperties\": {\"type\": \"array\", \"items\": {\"type\": \"string\"}}}}}}}\n```\nAI: ```json\n{\"action\":"
            ],
            "{\"action\": \"pod-kill\", \"mode\": \"one\", \"selector\": {\"namespaces\": [\"sock-shop\"], \"labelSelectors\": {\"name\": \"front-end\"}}, \"value\": \"1\", \"containerNames\": []}"
        ]
    }
]